var qg=Object.defineProperty;var Zg=(t,e,n)=>e in t?qg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Gt=(t,e,n)=>Zg(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var it=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Kg(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var hf={exports:{}},z={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ki=Symbol.for("react.element"),Wg=Symbol.for("react.portal"),Gg=Symbol.for("react.fragment"),Jg=Symbol.for("react.strict_mode"),Qg=Symbol.for("react.profiler"),Xg=Symbol.for("react.provider"),Yg=Symbol.for("react.context"),ey=Symbol.for("react.forward_ref"),ty=Symbol.for("react.suspense"),ny=Symbol.for("react.memo"),ry=Symbol.for("react.lazy"),dd=Symbol.iterator;function iy(t){return t===null||typeof t!="object"?null:(t=dd&&t[dd]||t["@@iterator"],typeof t=="function"?t:null)}var ff={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pf=Object.assign,mf={};function zr(t,e,n){this.props=t,this.context=e,this.refs=mf,this.updater=n||ff}zr.prototype.isReactComponent={};zr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};zr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gf(){}gf.prototype=zr.prototype;function Hu(t,e,n){this.props=t,this.context=e,this.refs=mf,this.updater=n||ff}var qu=Hu.prototype=new gf;qu.constructor=Hu;pf(qu,zr.prototype);qu.isPureReactComponent=!0;var hd=Array.isArray,yf=Object.prototype.hasOwnProperty,Zu={current:null},vf={key:!0,ref:!0,__self:!0,__source:!0};function _f(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)yf.call(e,r)&&!vf.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:Ki,type:t,key:s,ref:a,props:i,_owner:Zu.current}}function sy(t,e){return{$$typeof:Ki,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ku(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ki}function ay(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var fd=/\/+/g;function No(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ay(""+t.key):e.toString(36)}function js(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ki:case Wg:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+No(a,0):r,hd(i)?(n="",t!=null&&(n=t.replace(fd,"$&/")+"/"),js(i,e,n,"",function(u){return u})):i!=null&&(Ku(i)&&(i=sy(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(fd,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",hd(t))for(var o=0;o<t.length;o++){s=t[o];var l=r+No(s,o);a+=js(s,e,n,l,i)}else if(l=iy(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=r+No(s,o++),a+=js(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function os(t,e,n){if(t==null)return t;var r=[],i=0;return js(t,r,"","",function(s){return e.call(n,s,i++)}),r}function oy(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ie={current:null},$s={transition:null},ly={ReactCurrentDispatcher:Ie,ReactCurrentBatchConfig:$s,ReactCurrentOwner:Zu};function wf(){throw Error("act(...) is not supported in production builds of React.")}z.Children={map:os,forEach:function(t,e,n){os(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return os(t,function(){e++}),e},toArray:function(t){return os(t,function(e){return e})||[]},only:function(t){if(!Ku(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};z.Component=zr;z.Fragment=Gg;z.Profiler=Qg;z.PureComponent=Hu;z.StrictMode=Jg;z.Suspense=ty;z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ly;z.act=wf;z.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=pf({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Zu.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)yf.call(e,l)&&!vf.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:Ki,type:t.type,key:i,ref:s,props:r,_owner:a}};z.createContext=function(t){return t={$$typeof:Yg,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Xg,_context:t},t.Consumer=t};z.createElement=_f;z.createFactory=function(t){var e=_f.bind(null,t);return e.type=t,e};z.createRef=function(){return{current:null}};z.forwardRef=function(t){return{$$typeof:ey,render:t}};z.isValidElement=Ku;z.lazy=function(t){return{$$typeof:ry,_payload:{_status:-1,_result:t},_init:oy}};z.memo=function(t,e){return{$$typeof:ny,type:t,compare:e===void 0?null:e}};z.startTransition=function(t){var e=$s.transition;$s.transition={};try{t()}finally{$s.transition=e}};z.unstable_act=wf;z.useCallback=function(t,e){return Ie.current.useCallback(t,e)};z.useContext=function(t){return Ie.current.useContext(t)};z.useDebugValue=function(){};z.useDeferredValue=function(t){return Ie.current.useDeferredValue(t)};z.useEffect=function(t,e){return Ie.current.useEffect(t,e)};z.useId=function(){return Ie.current.useId()};z.useImperativeHandle=function(t,e,n){return Ie.current.useImperativeHandle(t,e,n)};z.useInsertionEffect=function(t,e){return Ie.current.useInsertionEffect(t,e)};z.useLayoutEffect=function(t,e){return Ie.current.useLayoutEffect(t,e)};z.useMemo=function(t,e){return Ie.current.useMemo(t,e)};z.useReducer=function(t,e,n){return Ie.current.useReducer(t,e,n)};z.useRef=function(t){return Ie.current.useRef(t)};z.useState=function(t){return Ie.current.useState(t)};z.useSyncExternalStore=function(t,e,n){return Ie.current.useSyncExternalStore(t,e,n)};z.useTransition=function(){return Ie.current.useTransition()};z.version="18.3.1";hf.exports=z;var bf=hf.exports;const ft=eo(bf);var Ol={},kf={exports:{}},Ke={},Sf={exports:{}},Ef={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(A,N){var L=A.length;A.push(N);e:for(;0<L;){var ae=L-1>>>1,de=A[ae];if(0<i(de,N))A[ae]=N,A[L]=de,L=ae;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var N=A[0],L=A.pop();if(L!==N){A[0]=L;e:for(var ae=0,de=A.length,ss=de>>>1;ae<ss;){var Pn=2*(ae+1)-1,$o=A[Pn],Tn=Pn+1,as=A[Tn];if(0>i($o,L))Tn<de&&0>i(as,$o)?(A[ae]=as,A[Tn]=L,ae=Tn):(A[ae]=$o,A[Pn]=L,ae=Pn);else if(Tn<de&&0>i(as,L))A[ae]=as,A[Tn]=L,ae=Tn;else break e}}return N}function i(A,N){var L=A.sortIndex-N.sortIndex;return L!==0?L:A.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,d=null,h=3,p=!1,y=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(A){for(var N=n(u);N!==null;){if(N.callback===null)r(u);else if(N.startTime<=A)r(u),N.sortIndex=N.expirationTime,e(l,N);else break;N=n(u)}}function w(A){if(v=!1,m(A),!y)if(n(l)!==null)y=!0,Ro(E);else{var N=n(u);N!==null&&jo(w,N.startTime-A)}}function E(A,N){y=!1,v&&(v=!1,g(R),R=-1),p=!0;var L=h;try{for(m(N),d=n(l);d!==null&&(!(d.expirationTime>N)||A&&!lt());){var ae=d.callback;if(typeof ae=="function"){d.callback=null,h=d.priorityLevel;var de=ae(d.expirationTime<=N);N=t.unstable_now(),typeof de=="function"?d.callback=de:d===n(l)&&r(l),m(N)}else r(l);d=n(l)}if(d!==null)var ss=!0;else{var Pn=n(u);Pn!==null&&jo(w,Pn.startTime-N),ss=!1}return ss}finally{d=null,h=L,p=!1}}var O=!1,C=null,R=-1,se=5,M=-1;function lt(){return!(t.unstable_now()-M<se)}function Hr(){if(C!==null){var A=t.unstable_now();M=A;var N=!0;try{N=C(!0,A)}finally{N?qr():(O=!1,C=null)}}else O=!1}var qr;if(typeof f=="function")qr=function(){f(Hr)};else if(typeof MessageChannel<"u"){var cd=new MessageChannel,Hg=cd.port2;cd.port1.onmessage=Hr,qr=function(){Hg.postMessage(null)}}else qr=function(){_(Hr,0)};function Ro(A){C=A,O||(O=!0,qr())}function jo(A,N){R=_(function(){A(t.unstable_now())},N)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){y||p||(y=!0,Ro(E))},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(A){switch(h){case 1:case 2:case 3:var N=3;break;default:N=h}var L=h;h=N;try{return A()}finally{h=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(A,N){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var L=h;h=A;try{return N()}finally{h=L}},t.unstable_scheduleCallback=function(A,N,L){var ae=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?ae+L:ae):L=ae,A){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=L+de,A={id:c++,callback:N,priorityLevel:A,startTime:L,expirationTime:de,sortIndex:-1},L>ae?(A.sortIndex=L,e(u,A),n(l)===null&&A===n(u)&&(v?(g(R),R=-1):v=!0,jo(w,L-ae))):(A.sortIndex=de,e(l,A),y||p||(y=!0,Ro(E))),A},t.unstable_shouldYield=lt,t.unstable_wrapCallback=function(A){var N=h;return function(){var L=h;h=N;try{return A.apply(this,arguments)}finally{h=L}}}})(Ef);Sf.exports=Ef;var uy=Sf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy=bf,Ze=uy;function b(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xf=new Set,Ei={};function Qn(t,e){Tr(t,e),Tr(t+"Capture",e)}function Tr(t,e){for(Ei[t]=e,t=0;t<e.length;t++)xf.add(e[t])}var Ft=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Il=Object.prototype.hasOwnProperty,dy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pd={},md={};function hy(t){return Il.call(md,t)?!0:Il.call(pd,t)?!1:dy.test(t)?md[t]=!0:(pd[t]=!0,!1)}function fy(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function py(t,e,n,r){if(e===null||typeof e>"u"||fy(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Re(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var we={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){we[t]=new Re(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];we[e]=new Re(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){we[t]=new Re(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){we[t]=new Re(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){we[t]=new Re(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){we[t]=new Re(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){we[t]=new Re(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){we[t]=new Re(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){we[t]=new Re(t,5,!1,t.toLowerCase(),null,!1,!1)});var Wu=/[\-:]([a-z])/g;function Gu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Wu,Gu);we[e]=new Re(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Wu,Gu);we[e]=new Re(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Wu,Gu);we[e]=new Re(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){we[t]=new Re(t,1,!1,t.toLowerCase(),null,!1,!1)});we.xlinkHref=new Re("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){we[t]=new Re(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ju(t,e,n,r){var i=we.hasOwnProperty(e)?we[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(py(e,n,i,r)&&(n=null),r||i===null?hy(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Wt=cy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ls=Symbol.for("react.element"),or=Symbol.for("react.portal"),lr=Symbol.for("react.fragment"),Qu=Symbol.for("react.strict_mode"),Rl=Symbol.for("react.profiler"),Pf=Symbol.for("react.provider"),Tf=Symbol.for("react.context"),Xu=Symbol.for("react.forward_ref"),jl=Symbol.for("react.suspense"),$l=Symbol.for("react.suspense_list"),Yu=Symbol.for("react.memo"),en=Symbol.for("react.lazy"),Af=Symbol.for("react.offscreen"),gd=Symbol.iterator;function Zr(t){return t===null||typeof t!="object"?null:(t=gd&&t[gd]||t["@@iterator"],typeof t=="function"?t:null)}var te=Object.assign,Lo;function ni(t){if(Lo===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Lo=e&&e[1]||""}return`
`+Lo+t}var Do=!1;function Uo(t,e){if(!t||Do)return"";Do=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Do=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ni(t):""}function my(t){switch(t.tag){case 5:return ni(t.type);case 16:return ni("Lazy");case 13:return ni("Suspense");case 19:return ni("SuspenseList");case 0:case 2:case 15:return t=Uo(t.type,!1),t;case 11:return t=Uo(t.type.render,!1),t;case 1:return t=Uo(t.type,!0),t;default:return""}}function Nl(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case lr:return"Fragment";case or:return"Portal";case Rl:return"Profiler";case Qu:return"StrictMode";case jl:return"Suspense";case $l:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Tf:return(t.displayName||"Context")+".Consumer";case Pf:return(t._context.displayName||"Context")+".Provider";case Xu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Yu:return e=t.displayName||null,e!==null?e:Nl(t.type)||"Memo";case en:e=t._payload,t=t._init;try{return Nl(t(e))}catch{}}return null}function gy(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nl(e);case 8:return e===Qu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _n(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Cf(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yy(t){var e=Cf(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function us(t){t._valueTracker||(t._valueTracker=yy(t))}function Of(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Cf(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function qs(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ll(t,e){var n=e.checked;return te({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function yd(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=_n(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function If(t,e){e=e.checked,e!=null&&Ju(t,"checked",e,!1)}function Dl(t,e){If(t,e);var n=_n(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ul(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ul(t,e.type,_n(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function vd(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ul(t,e,n){(e!=="number"||qs(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ri=Array.isArray;function _r(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+_n(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function zl(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(b(91));return te({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _d(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(b(92));if(ri(n)){if(1<n.length)throw Error(b(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:_n(n)}}function Rf(t,e){var n=_n(e.value),r=_n(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function jf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ml(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?jf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var cs,$f=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(cs=cs||document.createElement("div"),cs.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=cs.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xi(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ci={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vy=["Webkit","ms","Moz","O"];Object.keys(ci).forEach(function(t){vy.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ci[e]=ci[t]})});function Nf(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ci.hasOwnProperty(t)&&ci[t]?(""+e).trim():e+"px"}function Lf(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Nf(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var _y=te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bl(t,e){if(e){if(_y[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(b(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(b(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(b(61))}if(e.style!=null&&typeof e.style!="object")throw Error(b(62))}}function Fl(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vl=null;function ec(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hl=null,wr=null,br=null;function bd(t){if(t=Ji(t)){if(typeof Hl!="function")throw Error(b(280));var e=t.stateNode;e&&(e=so(e),Hl(t.stateNode,t.type,e))}}function Df(t){wr?br?br.push(t):br=[t]:wr=t}function Uf(){if(wr){var t=wr,e=br;if(br=wr=null,bd(t),e)for(t=0;t<e.length;t++)bd(e[t])}}function zf(t,e){return t(e)}function Mf(){}var zo=!1;function Bf(t,e,n){if(zo)return t(e,n);zo=!0;try{return zf(t,e,n)}finally{zo=!1,(wr!==null||br!==null)&&(Mf(),Uf())}}function Pi(t,e){var n=t.stateNode;if(n===null)return null;var r=so(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(b(231,e,typeof n));return n}var ql=!1;if(Ft)try{var Kr={};Object.defineProperty(Kr,"passive",{get:function(){ql=!0}}),window.addEventListener("test",Kr,Kr),window.removeEventListener("test",Kr,Kr)}catch{ql=!1}function wy(t,e,n,r,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var di=!1,Zs=null,Ks=!1,Zl=null,by={onError:function(t){di=!0,Zs=t}};function ky(t,e,n,r,i,s,a,o,l){di=!1,Zs=null,wy.apply(by,arguments)}function Sy(t,e,n,r,i,s,a,o,l){if(ky.apply(this,arguments),di){if(di){var u=Zs;di=!1,Zs=null}else throw Error(b(198));Ks||(Ks=!0,Zl=u)}}function Xn(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ff(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function kd(t){if(Xn(t)!==t)throw Error(b(188))}function Ey(t){var e=t.alternate;if(!e){if(e=Xn(t),e===null)throw Error(b(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return kd(i),t;if(s===r)return kd(i),e;s=s.sibling}throw Error(b(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,r=s;break}if(o===r){a=!0,r=i,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,r=i;break}if(o===r){a=!0,r=s,n=i;break}o=o.sibling}if(!a)throw Error(b(189))}}if(n.alternate!==r)throw Error(b(190))}if(n.tag!==3)throw Error(b(188));return n.stateNode.current===n?t:e}function Vf(t){return t=Ey(t),t!==null?Hf(t):null}function Hf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Hf(t);if(e!==null)return e;t=t.sibling}return null}var qf=Ze.unstable_scheduleCallback,Sd=Ze.unstable_cancelCallback,xy=Ze.unstable_shouldYield,Py=Ze.unstable_requestPaint,oe=Ze.unstable_now,Ty=Ze.unstable_getCurrentPriorityLevel,tc=Ze.unstable_ImmediatePriority,Zf=Ze.unstable_UserBlockingPriority,Ws=Ze.unstable_NormalPriority,Ay=Ze.unstable_LowPriority,Kf=Ze.unstable_IdlePriority,to=null,Pt=null;function Cy(t){if(Pt&&typeof Pt.onCommitFiberRoot=="function")try{Pt.onCommitFiberRoot(to,t,void 0,(t.current.flags&128)===128)}catch{}}var _t=Math.clz32?Math.clz32:Ry,Oy=Math.log,Iy=Math.LN2;function Ry(t){return t>>>=0,t===0?32:31-(Oy(t)/Iy|0)|0}var ds=64,hs=4194304;function ii(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gs(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~i;o!==0?r=ii(o):(s&=a,s!==0&&(r=ii(s)))}else a=n&~i,a!==0?r=ii(a):s!==0&&(r=ii(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_t(e),i=1<<n,r|=t[n],e&=~i;return r}function jy(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $y(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-_t(s),o=1<<a,l=i[a];l===-1?(!(o&n)||o&r)&&(i[a]=jy(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Kl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Wf(){var t=ds;return ds<<=1,!(ds&4194240)&&(ds=64),t}function Mo(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wi(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_t(e),t[e]=n}function Ny(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-_t(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function nc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_t(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Z=0;function Gf(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Jf,rc,Qf,Xf,Yf,Wl=!1,fs=[],dn=null,hn=null,fn=null,Ti=new Map,Ai=new Map,rn=[],Ly="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ed(t,e){switch(t){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":hn=null;break;case"mouseover":case"mouseout":fn=null;break;case"pointerover":case"pointerout":Ti.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ai.delete(e.pointerId)}}function Wr(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ji(e),e!==null&&rc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Dy(t,e,n,r,i){switch(e){case"focusin":return dn=Wr(dn,t,e,n,r,i),!0;case"dragenter":return hn=Wr(hn,t,e,n,r,i),!0;case"mouseover":return fn=Wr(fn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ti.set(s,Wr(Ti.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ai.set(s,Wr(Ai.get(s)||null,t,e,n,r,i)),!0}return!1}function ep(t){var e=Dn(t.target);if(e!==null){var n=Xn(e);if(n!==null){if(e=n.tag,e===13){if(e=Ff(n),e!==null){t.blockedOn=e,Yf(t.priority,function(){Qf(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ns(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gl(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Vl=r,n.target.dispatchEvent(r),Vl=null}else return e=Ji(n),e!==null&&rc(e),t.blockedOn=n,!1;e.shift()}return!0}function xd(t,e,n){Ns(t)&&n.delete(e)}function Uy(){Wl=!1,dn!==null&&Ns(dn)&&(dn=null),hn!==null&&Ns(hn)&&(hn=null),fn!==null&&Ns(fn)&&(fn=null),Ti.forEach(xd),Ai.forEach(xd)}function Gr(t,e){t.blockedOn===e&&(t.blockedOn=null,Wl||(Wl=!0,Ze.unstable_scheduleCallback(Ze.unstable_NormalPriority,Uy)))}function Ci(t){function e(i){return Gr(i,t)}if(0<fs.length){Gr(fs[0],t);for(var n=1;n<fs.length;n++){var r=fs[n];r.blockedOn===t&&(r.blockedOn=null)}}for(dn!==null&&Gr(dn,t),hn!==null&&Gr(hn,t),fn!==null&&Gr(fn,t),Ti.forEach(e),Ai.forEach(e),n=0;n<rn.length;n++)r=rn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<rn.length&&(n=rn[0],n.blockedOn===null);)ep(n),n.blockedOn===null&&rn.shift()}var kr=Wt.ReactCurrentBatchConfig,Js=!0;function zy(t,e,n,r){var i=Z,s=kr.transition;kr.transition=null;try{Z=1,ic(t,e,n,r)}finally{Z=i,kr.transition=s}}function My(t,e,n,r){var i=Z,s=kr.transition;kr.transition=null;try{Z=4,ic(t,e,n,r)}finally{Z=i,kr.transition=s}}function ic(t,e,n,r){if(Js){var i=Gl(t,e,n,r);if(i===null)Jo(t,e,r,Qs,n),Ed(t,r);else if(Dy(i,t,e,n,r))r.stopPropagation();else if(Ed(t,r),e&4&&-1<Ly.indexOf(t)){for(;i!==null;){var s=Ji(i);if(s!==null&&Jf(s),s=Gl(t,e,n,r),s===null&&Jo(t,e,r,Qs,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Jo(t,e,r,null,n)}}var Qs=null;function Gl(t,e,n,r){if(Qs=null,t=ec(r),t=Dn(t),t!==null)if(e=Xn(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ff(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qs=t,null}function tp(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ty()){case tc:return 1;case Zf:return 4;case Ws:case Ay:return 16;case Kf:return 536870912;default:return 16}default:return 16}}var on=null,sc=null,Ls=null;function np(){if(Ls)return Ls;var t,e=sc,n=e.length,r,i="value"in on?on.value:on.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Ls=i.slice(t,1<r?1-r:void 0)}function Ds(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ps(){return!0}function Pd(){return!1}function We(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ps:Pd,this.isPropagationStopped=Pd,this}return te(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ps)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ps)},persist:function(){},isPersistent:ps}),e}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ac=We(Mr),Gi=te({},Mr,{view:0,detail:0}),By=We(Gi),Bo,Fo,Jr,no=te({},Gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jr&&(Jr&&t.type==="mousemove"?(Bo=t.screenX-Jr.screenX,Fo=t.screenY-Jr.screenY):Fo=Bo=0,Jr=t),Bo)},movementY:function(t){return"movementY"in t?t.movementY:Fo}}),Td=We(no),Fy=te({},no,{dataTransfer:0}),Vy=We(Fy),Hy=te({},Gi,{relatedTarget:0}),Vo=We(Hy),qy=te({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),Zy=We(qy),Ky=te({},Mr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Wy=We(Ky),Gy=te({},Mr,{data:0}),Ad=We(Gy),Jy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yy(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Xy[t])?!!e[t]:!1}function oc(){return Yy}var ev=te({},Gi,{key:function(t){if(t.key){var e=Jy[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ds(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Qy[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oc,charCode:function(t){return t.type==="keypress"?Ds(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ds(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),tv=We(ev),nv=te({},no,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cd=We(nv),rv=te({},Gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oc}),iv=We(rv),sv=te({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),av=We(sv),ov=te({},no,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lv=We(ov),uv=[9,13,27,32],lc=Ft&&"CompositionEvent"in window,hi=null;Ft&&"documentMode"in document&&(hi=document.documentMode);var cv=Ft&&"TextEvent"in window&&!hi,rp=Ft&&(!lc||hi&&8<hi&&11>=hi),Od=" ",Id=!1;function ip(t,e){switch(t){case"keyup":return uv.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sp(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ur=!1;function dv(t,e){switch(t){case"compositionend":return sp(e);case"keypress":return e.which!==32?null:(Id=!0,Od);case"textInput":return t=e.data,t===Od&&Id?null:t;default:return null}}function hv(t,e){if(ur)return t==="compositionend"||!lc&&ip(t,e)?(t=np(),Ls=sc=on=null,ur=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rp&&e.locale!=="ko"?null:e.data;default:return null}}var fv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!fv[t.type]:e==="textarea"}function ap(t,e,n,r){Df(r),e=Xs(e,"onChange"),0<e.length&&(n=new ac("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var fi=null,Oi=null;function pv(t){yp(t,0)}function ro(t){var e=hr(t);if(Of(e))return t}function mv(t,e){if(t==="change")return e}var op=!1;if(Ft){var Ho;if(Ft){var qo="oninput"in document;if(!qo){var jd=document.createElement("div");jd.setAttribute("oninput","return;"),qo=typeof jd.oninput=="function"}Ho=qo}else Ho=!1;op=Ho&&(!document.documentMode||9<document.documentMode)}function $d(){fi&&(fi.detachEvent("onpropertychange",lp),Oi=fi=null)}function lp(t){if(t.propertyName==="value"&&ro(Oi)){var e=[];ap(e,Oi,t,ec(t)),Bf(pv,e)}}function gv(t,e,n){t==="focusin"?($d(),fi=e,Oi=n,fi.attachEvent("onpropertychange",lp)):t==="focusout"&&$d()}function yv(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ro(Oi)}function vv(t,e){if(t==="click")return ro(e)}function _v(t,e){if(t==="input"||t==="change")return ro(e)}function wv(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bt=typeof Object.is=="function"?Object.is:wv;function Ii(t,e){if(bt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Il.call(e,i)||!bt(t[i],e[i]))return!1}return!0}function Nd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ld(t,e){var n=Nd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Nd(n)}}function up(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?up(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function cp(){for(var t=window,e=qs();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=qs(t.document)}return e}function uc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function bv(t){var e=cp(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&up(n.ownerDocument.documentElement,n)){if(r!==null&&uc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Ld(n,s);var a=Ld(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kv=Ft&&"documentMode"in document&&11>=document.documentMode,cr=null,Jl=null,pi=null,Ql=!1;function Dd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ql||cr==null||cr!==qs(r)||(r=cr,"selectionStart"in r&&uc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),pi&&Ii(pi,r)||(pi=r,r=Xs(Jl,"onSelect"),0<r.length&&(e=new ac("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=cr)))}function ms(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var dr={animationend:ms("Animation","AnimationEnd"),animationiteration:ms("Animation","AnimationIteration"),animationstart:ms("Animation","AnimationStart"),transitionend:ms("Transition","TransitionEnd")},Zo={},dp={};Ft&&(dp=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);function io(t){if(Zo[t])return Zo[t];if(!dr[t])return t;var e=dr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in dp)return Zo[t]=e[n];return t}var hp=io("animationend"),fp=io("animationiteration"),pp=io("animationstart"),mp=io("transitionend"),gp=new Map,Ud="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sn(t,e){gp.set(t,e),Qn(e,[t])}for(var Ko=0;Ko<Ud.length;Ko++){var Wo=Ud[Ko],Sv=Wo.toLowerCase(),Ev=Wo[0].toUpperCase()+Wo.slice(1);Sn(Sv,"on"+Ev)}Sn(hp,"onAnimationEnd");Sn(fp,"onAnimationIteration");Sn(pp,"onAnimationStart");Sn("dblclick","onDoubleClick");Sn("focusin","onFocus");Sn("focusout","onBlur");Sn(mp,"onTransitionEnd");Tr("onMouseEnter",["mouseout","mouseover"]);Tr("onMouseLeave",["mouseout","mouseover"]);Tr("onPointerEnter",["pointerout","pointerover"]);Tr("onPointerLeave",["pointerout","pointerover"]);Qn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var si="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xv=new Set("cancel close invalid load scroll toggle".split(" ").concat(si));function zd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Sy(r,e,void 0,t),t.currentTarget=null}function yp(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;zd(i,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;zd(i,o,u),s=l}}}if(Ks)throw t=Zl,Ks=!1,Zl=null,t}function G(t,e){var n=e[nu];n===void 0&&(n=e[nu]=new Set);var r=t+"__bubble";n.has(r)||(vp(e,t,2,!1),n.add(r))}function Go(t,e,n){var r=0;e&&(r|=4),vp(n,t,r,e)}var gs="_reactListening"+Math.random().toString(36).slice(2);function Ri(t){if(!t[gs]){t[gs]=!0,xf.forEach(function(n){n!=="selectionchange"&&(xv.has(n)||Go(n,!1,t),Go(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[gs]||(e[gs]=!0,Go("selectionchange",!1,e))}}function vp(t,e,n,r){switch(tp(e)){case 1:var i=zy;break;case 4:i=My;break;default:i=ic}n=i.bind(null,e,n,t),i=void 0,!ql||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Jo(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Dn(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}Bf(function(){var u=s,c=ec(n),d=[];e:{var h=gp.get(t);if(h!==void 0){var p=ac,y=t;switch(t){case"keypress":if(Ds(n)===0)break e;case"keydown":case"keyup":p=tv;break;case"focusin":y="focus",p=Vo;break;case"focusout":y="blur",p=Vo;break;case"beforeblur":case"afterblur":p=Vo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Td;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Vy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=iv;break;case hp:case fp:case pp:p=Zy;break;case mp:p=av;break;case"scroll":p=By;break;case"wheel":p=lv;break;case"copy":case"cut":case"paste":p=Wy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Cd}var v=(e&4)!==0,_=!v&&t==="scroll",g=v?h!==null?h+"Capture":null:h;v=[];for(var f=u,m;f!==null;){m=f;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,g!==null&&(w=Pi(f,g),w!=null&&v.push(ji(f,w,m)))),_)break;f=f.return}0<v.length&&(h=new p(h,y,null,n,c),d.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==Vl&&(y=n.relatedTarget||n.fromElement)&&(Dn(y)||y[Vt]))break e;if((p||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,p?(y=n.relatedTarget||n.toElement,p=u,y=y?Dn(y):null,y!==null&&(_=Xn(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(v=Td,w="onMouseLeave",g="onMouseEnter",f="mouse",(t==="pointerout"||t==="pointerover")&&(v=Cd,w="onPointerLeave",g="onPointerEnter",f="pointer"),_=p==null?h:hr(p),m=y==null?h:hr(y),h=new v(w,f+"leave",p,n,c),h.target=_,h.relatedTarget=m,w=null,Dn(c)===u&&(v=new v(g,f+"enter",y,n,c),v.target=m,v.relatedTarget=_,w=v),_=w,p&&y)t:{for(v=p,g=y,f=0,m=v;m;m=er(m))f++;for(m=0,w=g;w;w=er(w))m++;for(;0<f-m;)v=er(v),f--;for(;0<m-f;)g=er(g),m--;for(;f--;){if(v===g||g!==null&&v===g.alternate)break t;v=er(v),g=er(g)}v=null}else v=null;p!==null&&Md(d,h,p,v,!1),y!==null&&_!==null&&Md(d,_,y,v,!0)}}e:{if(h=u?hr(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var E=mv;else if(Rd(h))if(op)E=_v;else{E=yv;var O=gv}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=vv);if(E&&(E=E(t,u))){ap(d,E,n,c);break e}O&&O(t,h,u),t==="focusout"&&(O=h._wrapperState)&&O.controlled&&h.type==="number"&&Ul(h,"number",h.value)}switch(O=u?hr(u):window,t){case"focusin":(Rd(O)||O.contentEditable==="true")&&(cr=O,Jl=u,pi=null);break;case"focusout":pi=Jl=cr=null;break;case"mousedown":Ql=!0;break;case"contextmenu":case"mouseup":case"dragend":Ql=!1,Dd(d,n,c);break;case"selectionchange":if(kv)break;case"keydown":case"keyup":Dd(d,n,c)}var C;if(lc)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else ur?ip(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(rp&&n.locale!=="ko"&&(ur||R!=="onCompositionStart"?R==="onCompositionEnd"&&ur&&(C=np()):(on=c,sc="value"in on?on.value:on.textContent,ur=!0)),O=Xs(u,R),0<O.length&&(R=new Ad(R,t,null,n,c),d.push({event:R,listeners:O}),C?R.data=C:(C=sp(n),C!==null&&(R.data=C)))),(C=cv?dv(t,n):hv(t,n))&&(u=Xs(u,"onBeforeInput"),0<u.length&&(c=new Ad("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=C))}yp(d,e)})}function ji(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xs(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Pi(t,n),s!=null&&r.unshift(ji(t,s,i)),s=Pi(t,e),s!=null&&r.push(ji(t,s,i))),t=t.return}return r}function er(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Md(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=Pi(n,s),l!=null&&a.unshift(ji(n,l,o))):i||(l=Pi(n,s),l!=null&&a.push(ji(n,l,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var Pv=/\r\n?/g,Tv=/\u0000|\uFFFD/g;function Bd(t){return(typeof t=="string"?t:""+t).replace(Pv,`
`).replace(Tv,"")}function ys(t,e,n){if(e=Bd(e),Bd(t)!==e&&n)throw Error(b(425))}function Ys(){}var Xl=null,Yl=null;function eu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tu=typeof setTimeout=="function"?setTimeout:void 0,Av=typeof clearTimeout=="function"?clearTimeout:void 0,Fd=typeof Promise=="function"?Promise:void 0,Cv=typeof queueMicrotask=="function"?queueMicrotask:typeof Fd<"u"?function(t){return Fd.resolve(null).then(t).catch(Ov)}:tu;function Ov(t){setTimeout(function(){throw t})}function Qo(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ci(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ci(e)}function pn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Vd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Br=Math.random().toString(36).slice(2),Et="__reactFiber$"+Br,$i="__reactProps$"+Br,Vt="__reactContainer$"+Br,nu="__reactEvents$"+Br,Iv="__reactListeners$"+Br,Rv="__reactHandles$"+Br;function Dn(t){var e=t[Et];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Vt]||n[Et]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Vd(t);t!==null;){if(n=t[Et])return n;t=Vd(t)}return e}t=n,n=t.parentNode}return null}function Ji(t){return t=t[Et]||t[Vt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function hr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(b(33))}function so(t){return t[$i]||null}var ru=[],fr=-1;function En(t){return{current:t}}function J(t){0>fr||(t.current=ru[fr],ru[fr]=null,fr--)}function W(t,e){fr++,ru[fr]=t.current,t.current=e}var wn={},Pe=En(wn),De=En(!1),Hn=wn;function Ar(t,e){var n=t.type.contextTypes;if(!n)return wn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ue(t){return t=t.childContextTypes,t!=null}function ea(){J(De),J(Pe)}function Hd(t,e,n){if(Pe.current!==wn)throw Error(b(168));W(Pe,e),W(De,n)}function _p(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(b(108,gy(t)||"Unknown",i));return te({},n,r)}function ta(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||wn,Hn=Pe.current,W(Pe,t),W(De,De.current),!0}function qd(t,e,n){var r=t.stateNode;if(!r)throw Error(b(169));n?(t=_p(t,e,Hn),r.__reactInternalMemoizedMergedChildContext=t,J(De),J(Pe),W(Pe,t)):J(De),W(De,n)}var $t=null,ao=!1,Xo=!1;function wp(t){$t===null?$t=[t]:$t.push(t)}function jv(t){ao=!0,wp(t)}function xn(){if(!Xo&&$t!==null){Xo=!0;var t=0,e=Z;try{var n=$t;for(Z=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$t=null,ao=!1}catch(i){throw $t!==null&&($t=$t.slice(t+1)),qf(tc,xn),i}finally{Z=e,Xo=!1}}return null}var pr=[],mr=0,na=null,ra=0,Xe=[],Ye=0,qn=null,Lt=1,Dt="";function In(t,e){pr[mr++]=ra,pr[mr++]=na,na=t,ra=e}function bp(t,e,n){Xe[Ye++]=Lt,Xe[Ye++]=Dt,Xe[Ye++]=qn,qn=t;var r=Lt;t=Dt;var i=32-_t(r)-1;r&=~(1<<i),n+=1;var s=32-_t(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Lt=1<<32-_t(e)+i|n<<i|r,Dt=s+t}else Lt=1<<s|n<<i|r,Dt=t}function cc(t){t.return!==null&&(In(t,1),bp(t,1,0))}function dc(t){for(;t===na;)na=pr[--mr],pr[mr]=null,ra=pr[--mr],pr[mr]=null;for(;t===qn;)qn=Xe[--Ye],Xe[Ye]=null,Dt=Xe[--Ye],Xe[Ye]=null,Lt=Xe[--Ye],Xe[Ye]=null}var He=null,Ve=null,Q=!1,vt=null;function kp(t,e){var n=tt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Zd(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,He=t,Ve=pn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,He=t,Ve=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qn!==null?{id:Lt,overflow:Dt}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=tt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,He=t,Ve=null,!0):!1;default:return!1}}function iu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function su(t){if(Q){var e=Ve;if(e){var n=e;if(!Zd(t,e)){if(iu(t))throw Error(b(418));e=pn(n.nextSibling);var r=He;e&&Zd(t,e)?kp(r,n):(t.flags=t.flags&-4097|2,Q=!1,He=t)}}else{if(iu(t))throw Error(b(418));t.flags=t.flags&-4097|2,Q=!1,He=t}}}function Kd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;He=t}function vs(t){if(t!==He)return!1;if(!Q)return Kd(t),Q=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!eu(t.type,t.memoizedProps)),e&&(e=Ve)){if(iu(t))throw Sp(),Error(b(418));for(;e;)kp(t,e),e=pn(e.nextSibling)}if(Kd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(b(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ve=pn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ve=null}}else Ve=He?pn(t.stateNode.nextSibling):null;return!0}function Sp(){for(var t=Ve;t;)t=pn(t.nextSibling)}function Cr(){Ve=He=null,Q=!1}function hc(t){vt===null?vt=[t]:vt.push(t)}var $v=Wt.ReactCurrentBatchConfig;function Qr(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(b(309));var r=n.stateNode}if(!r)throw Error(b(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(b(284));if(!n._owner)throw Error(b(290,t))}return t}function _s(t,e){throw t=Object.prototype.toString.call(e),Error(b(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Wd(t){var e=t._init;return e(t._payload)}function Ep(t){function e(g,f){if(t){var m=g.deletions;m===null?(g.deletions=[f],g.flags|=16):m.push(f)}}function n(g,f){if(!t)return null;for(;f!==null;)e(g,f),f=f.sibling;return null}function r(g,f){for(g=new Map;f!==null;)f.key!==null?g.set(f.key,f):g.set(f.index,f),f=f.sibling;return g}function i(g,f){return g=vn(g,f),g.index=0,g.sibling=null,g}function s(g,f,m){return g.index=m,t?(m=g.alternate,m!==null?(m=m.index,m<f?(g.flags|=2,f):m):(g.flags|=2,f)):(g.flags|=1048576,f)}function a(g){return t&&g.alternate===null&&(g.flags|=2),g}function o(g,f,m,w){return f===null||f.tag!==6?(f=sl(m,g.mode,w),f.return=g,f):(f=i(f,m),f.return=g,f)}function l(g,f,m,w){var E=m.type;return E===lr?c(g,f,m.props.children,w,m.key):f!==null&&(f.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===en&&Wd(E)===f.type)?(w=i(f,m.props),w.ref=Qr(g,f,m),w.return=g,w):(w=Hs(m.type,m.key,m.props,null,g.mode,w),w.ref=Qr(g,f,m),w.return=g,w)}function u(g,f,m,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=al(m,g.mode,w),f.return=g,f):(f=i(f,m.children||[]),f.return=g,f)}function c(g,f,m,w,E){return f===null||f.tag!==7?(f=Fn(m,g.mode,w,E),f.return=g,f):(f=i(f,m),f.return=g,f)}function d(g,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=sl(""+f,g.mode,m),f.return=g,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case ls:return m=Hs(f.type,f.key,f.props,null,g.mode,m),m.ref=Qr(g,null,f),m.return=g,m;case or:return f=al(f,g.mode,m),f.return=g,f;case en:var w=f._init;return d(g,w(f._payload),m)}if(ri(f)||Zr(f))return f=Fn(f,g.mode,m,null),f.return=g,f;_s(g,f)}return null}function h(g,f,m,w){var E=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return E!==null?null:o(g,f,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ls:return m.key===E?l(g,f,m,w):null;case or:return m.key===E?u(g,f,m,w):null;case en:return E=m._init,h(g,f,E(m._payload),w)}if(ri(m)||Zr(m))return E!==null?null:c(g,f,m,w,null);_s(g,m)}return null}function p(g,f,m,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(m)||null,o(f,g,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ls:return g=g.get(w.key===null?m:w.key)||null,l(f,g,w,E);case or:return g=g.get(w.key===null?m:w.key)||null,u(f,g,w,E);case en:var O=w._init;return p(g,f,m,O(w._payload),E)}if(ri(w)||Zr(w))return g=g.get(m)||null,c(f,g,w,E,null);_s(f,w)}return null}function y(g,f,m,w){for(var E=null,O=null,C=f,R=f=0,se=null;C!==null&&R<m.length;R++){C.index>R?(se=C,C=null):se=C.sibling;var M=h(g,C,m[R],w);if(M===null){C===null&&(C=se);break}t&&C&&M.alternate===null&&e(g,C),f=s(M,f,R),O===null?E=M:O.sibling=M,O=M,C=se}if(R===m.length)return n(g,C),Q&&In(g,R),E;if(C===null){for(;R<m.length;R++)C=d(g,m[R],w),C!==null&&(f=s(C,f,R),O===null?E=C:O.sibling=C,O=C);return Q&&In(g,R),E}for(C=r(g,C);R<m.length;R++)se=p(C,g,R,m[R],w),se!==null&&(t&&se.alternate!==null&&C.delete(se.key===null?R:se.key),f=s(se,f,R),O===null?E=se:O.sibling=se,O=se);return t&&C.forEach(function(lt){return e(g,lt)}),Q&&In(g,R),E}function v(g,f,m,w){var E=Zr(m);if(typeof E!="function")throw Error(b(150));if(m=E.call(m),m==null)throw Error(b(151));for(var O=E=null,C=f,R=f=0,se=null,M=m.next();C!==null&&!M.done;R++,M=m.next()){C.index>R?(se=C,C=null):se=C.sibling;var lt=h(g,C,M.value,w);if(lt===null){C===null&&(C=se);break}t&&C&&lt.alternate===null&&e(g,C),f=s(lt,f,R),O===null?E=lt:O.sibling=lt,O=lt,C=se}if(M.done)return n(g,C),Q&&In(g,R),E;if(C===null){for(;!M.done;R++,M=m.next())M=d(g,M.value,w),M!==null&&(f=s(M,f,R),O===null?E=M:O.sibling=M,O=M);return Q&&In(g,R),E}for(C=r(g,C);!M.done;R++,M=m.next())M=p(C,g,R,M.value,w),M!==null&&(t&&M.alternate!==null&&C.delete(M.key===null?R:M.key),f=s(M,f,R),O===null?E=M:O.sibling=M,O=M);return t&&C.forEach(function(Hr){return e(g,Hr)}),Q&&In(g,R),E}function _(g,f,m,w){if(typeof m=="object"&&m!==null&&m.type===lr&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case ls:e:{for(var E=m.key,O=f;O!==null;){if(O.key===E){if(E=m.type,E===lr){if(O.tag===7){n(g,O.sibling),f=i(O,m.props.children),f.return=g,g=f;break e}}else if(O.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===en&&Wd(E)===O.type){n(g,O.sibling),f=i(O,m.props),f.ref=Qr(g,O,m),f.return=g,g=f;break e}n(g,O);break}else e(g,O);O=O.sibling}m.type===lr?(f=Fn(m.props.children,g.mode,w,m.key),f.return=g,g=f):(w=Hs(m.type,m.key,m.props,null,g.mode,w),w.ref=Qr(g,f,m),w.return=g,g=w)}return a(g);case or:e:{for(O=m.key;f!==null;){if(f.key===O)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){n(g,f.sibling),f=i(f,m.children||[]),f.return=g,g=f;break e}else{n(g,f);break}else e(g,f);f=f.sibling}f=al(m,g.mode,w),f.return=g,g=f}return a(g);case en:return O=m._init,_(g,f,O(m._payload),w)}if(ri(m))return y(g,f,m,w);if(Zr(m))return v(g,f,m,w);_s(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(n(g,f.sibling),f=i(f,m),f.return=g,g=f):(n(g,f),f=sl(m,g.mode,w),f.return=g,g=f),a(g)):n(g,f)}return _}var Or=Ep(!0),xp=Ep(!1),ia=En(null),sa=null,gr=null,fc=null;function pc(){fc=gr=sa=null}function mc(t){var e=ia.current;J(ia),t._currentValue=e}function au(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Sr(t,e){sa=t,fc=gr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Le=!0),t.firstContext=null)}function st(t){var e=t._currentValue;if(fc!==t)if(t={context:t,memoizedValue:e,next:null},gr===null){if(sa===null)throw Error(b(308));gr=t,sa.dependencies={lanes:0,firstContext:t}}else gr=gr.next=t;return e}var Un=null;function gc(t){Un===null?Un=[t]:Un.push(t)}function Pp(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,gc(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ht(t,r)}function Ht(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var tn=!1;function yc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tp(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function mn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,V&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ht(t,n)}return i=r.interleaved,i===null?(e.next=e,gc(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ht(t,n)}function Us(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,nc(t,n)}}function Gd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function aa(t,e,n,r){var i=t.updateQueue;tn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,c=u=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,v=o;switch(h=e,p=n,v.tag){case 1:if(y=v.payload,typeof y=="function"){d=y.call(p,d,h);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,h=typeof y=="function"?y.call(p,d,h):y,h==null)break e;d=te({},d,h);break e;case 2:tn=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=p,l=d):c=c.next=p,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Kn|=a,t.lanes=a,t.memoizedState=d}}function Jd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(b(191,i));i.call(r)}}}var Qi={},Tt=En(Qi),Ni=En(Qi),Li=En(Qi);function zn(t){if(t===Qi)throw Error(b(174));return t}function vc(t,e){switch(W(Li,e),W(Ni,t),W(Tt,Qi),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ml(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ml(e,t)}J(Tt),W(Tt,e)}function Ir(){J(Tt),J(Ni),J(Li)}function Ap(t){zn(Li.current);var e=zn(Tt.current),n=Ml(e,t.type);e!==n&&(W(Ni,t),W(Tt,n))}function _c(t){Ni.current===t&&(J(Tt),J(Ni))}var X=En(0);function oa(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yo=[];function wc(){for(var t=0;t<Yo.length;t++)Yo[t]._workInProgressVersionPrimary=null;Yo.length=0}var zs=Wt.ReactCurrentDispatcher,el=Wt.ReactCurrentBatchConfig,Zn=0,ee=null,ue=null,he=null,la=!1,mi=!1,Di=0,Nv=0;function be(){throw Error(b(321))}function bc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!bt(t[n],e[n]))return!1;return!0}function kc(t,e,n,r,i,s){if(Zn=s,ee=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zs.current=t===null||t.memoizedState===null?zv:Mv,t=n(r,i),mi){s=0;do{if(mi=!1,Di=0,25<=s)throw Error(b(301));s+=1,he=ue=null,e.updateQueue=null,zs.current=Bv,t=n(r,i)}while(mi)}if(zs.current=ua,e=ue!==null&&ue.next!==null,Zn=0,he=ue=ee=null,la=!1,e)throw Error(b(300));return t}function Sc(){var t=Di!==0;return Di=0,t}function St(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return he===null?ee.memoizedState=he=t:he=he.next=t,he}function at(){if(ue===null){var t=ee.alternate;t=t!==null?t.memoizedState:null}else t=ue.next;var e=he===null?ee.memoizedState:he.next;if(e!==null)he=e,ue=t;else{if(t===null)throw Error(b(310));ue=t,t={memoizedState:ue.memoizedState,baseState:ue.baseState,baseQueue:ue.baseQueue,queue:ue.queue,next:null},he===null?ee.memoizedState=he=t:he=he.next=t}return he}function Ui(t,e){return typeof e=="function"?e(t):e}function tl(t){var e=at(),n=e.queue;if(n===null)throw Error(b(311));n.lastRenderedReducer=t;var r=ue,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((Zn&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,a=r):l=l.next=d,ee.lanes|=c,Kn|=c}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,bt(r,e.memoizedState)||(Le=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ee.lanes|=s,Kn|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nl(t){var e=at(),n=e.queue;if(n===null)throw Error(b(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);bt(s,e.memoizedState)||(Le=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Cp(){}function Op(t,e){var n=ee,r=at(),i=e(),s=!bt(r.memoizedState,i);if(s&&(r.memoizedState=i,Le=!0),r=r.queue,Ec(jp.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||he!==null&&he.memoizedState.tag&1){if(n.flags|=2048,zi(9,Rp.bind(null,n,r,i,e),void 0,null),fe===null)throw Error(b(349));Zn&30||Ip(n,e,i)}return i}function Ip(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ee.updateQueue,e===null?(e={lastEffect:null,stores:null},ee.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Rp(t,e,n,r){e.value=n,e.getSnapshot=r,$p(e)&&Np(t)}function jp(t,e,n){return n(function(){$p(e)&&Np(t)})}function $p(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!bt(t,n)}catch{return!0}}function Np(t){var e=Ht(t,1);e!==null&&wt(e,t,1,-1)}function Qd(t){var e=St();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ui,lastRenderedState:t},e.queue=t,t=t.dispatch=Uv.bind(null,ee,t),[e.memoizedState,t]}function zi(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ee.updateQueue,e===null?(e={lastEffect:null,stores:null},ee.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Lp(){return at().memoizedState}function Ms(t,e,n,r){var i=St();ee.flags|=t,i.memoizedState=zi(1|e,n,void 0,r===void 0?null:r)}function oo(t,e,n,r){var i=at();r=r===void 0?null:r;var s=void 0;if(ue!==null){var a=ue.memoizedState;if(s=a.destroy,r!==null&&bc(r,a.deps)){i.memoizedState=zi(e,n,s,r);return}}ee.flags|=t,i.memoizedState=zi(1|e,n,s,r)}function Xd(t,e){return Ms(8390656,8,t,e)}function Ec(t,e){return oo(2048,8,t,e)}function Dp(t,e){return oo(4,2,t,e)}function Up(t,e){return oo(4,4,t,e)}function zp(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Mp(t,e,n){return n=n!=null?n.concat([t]):null,oo(4,4,zp.bind(null,e,t),n)}function xc(){}function Bp(t,e){var n=at();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Fp(t,e){var n=at();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Vp(t,e,n){return Zn&21?(bt(n,e)||(n=Wf(),ee.lanes|=n,Kn|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Le=!0),t.memoizedState=n)}function Lv(t,e){var n=Z;Z=n!==0&&4>n?n:4,t(!0);var r=el.transition;el.transition={};try{t(!1),e()}finally{Z=n,el.transition=r}}function Hp(){return at().memoizedState}function Dv(t,e,n){var r=yn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qp(t))Zp(e,n);else if(n=Pp(t,e,n,r),n!==null){var i=Ce();wt(n,t,r,i),Kp(n,e,r)}}function Uv(t,e,n){var r=yn(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qp(t))Zp(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,bt(o,a)){var l=e.interleaved;l===null?(i.next=i,gc(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=Pp(t,e,i,r),n!==null&&(i=Ce(),wt(n,t,r,i),Kp(n,e,r))}}function qp(t){var e=t.alternate;return t===ee||e!==null&&e===ee}function Zp(t,e){mi=la=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Kp(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,nc(t,n)}}var ua={readContext:st,useCallback:be,useContext:be,useEffect:be,useImperativeHandle:be,useInsertionEffect:be,useLayoutEffect:be,useMemo:be,useReducer:be,useRef:be,useState:be,useDebugValue:be,useDeferredValue:be,useTransition:be,useMutableSource:be,useSyncExternalStore:be,useId:be,unstable_isNewReconciler:!1},zv={readContext:st,useCallback:function(t,e){return St().memoizedState=[t,e===void 0?null:e],t},useContext:st,useEffect:Xd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ms(4194308,4,zp.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ms(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ms(4,2,t,e)},useMemo:function(t,e){var n=St();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=St();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Dv.bind(null,ee,t),[r.memoizedState,t]},useRef:function(t){var e=St();return t={current:t},e.memoizedState=t},useState:Qd,useDebugValue:xc,useDeferredValue:function(t){return St().memoizedState=t},useTransition:function(){var t=Qd(!1),e=t[0];return t=Lv.bind(null,t[1]),St().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ee,i=St();if(Q){if(n===void 0)throw Error(b(407));n=n()}else{if(n=e(),fe===null)throw Error(b(349));Zn&30||Ip(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Xd(jp.bind(null,r,s,t),[t]),r.flags|=2048,zi(9,Rp.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=St(),e=fe.identifierPrefix;if(Q){var n=Dt,r=Lt;n=(r&~(1<<32-_t(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Di++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Nv++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Mv={readContext:st,useCallback:Bp,useContext:st,useEffect:Ec,useImperativeHandle:Mp,useInsertionEffect:Dp,useLayoutEffect:Up,useMemo:Fp,useReducer:tl,useRef:Lp,useState:function(){return tl(Ui)},useDebugValue:xc,useDeferredValue:function(t){var e=at();return Vp(e,ue.memoizedState,t)},useTransition:function(){var t=tl(Ui)[0],e=at().memoizedState;return[t,e]},useMutableSource:Cp,useSyncExternalStore:Op,useId:Hp,unstable_isNewReconciler:!1},Bv={readContext:st,useCallback:Bp,useContext:st,useEffect:Ec,useImperativeHandle:Mp,useInsertionEffect:Dp,useLayoutEffect:Up,useMemo:Fp,useReducer:nl,useRef:Lp,useState:function(){return nl(Ui)},useDebugValue:xc,useDeferredValue:function(t){var e=at();return ue===null?e.memoizedState=t:Vp(e,ue.memoizedState,t)},useTransition:function(){var t=nl(Ui)[0],e=at().memoizedState;return[t,e]},useMutableSource:Cp,useSyncExternalStore:Op,useId:Hp,unstable_isNewReconciler:!1};function mt(t,e){if(t&&t.defaultProps){e=te({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ou(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:te({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var lo={isMounted:function(t){return(t=t._reactInternals)?Xn(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ce(),i=yn(t),s=zt(r,i);s.payload=e,n!=null&&(s.callback=n),e=mn(t,s,i),e!==null&&(wt(e,t,i,r),Us(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ce(),i=yn(t),s=zt(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=mn(t,s,i),e!==null&&(wt(e,t,i,r),Us(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ce(),r=yn(t),i=zt(n,r);i.tag=2,e!=null&&(i.callback=e),e=mn(t,i,r),e!==null&&(wt(e,t,r,n),Us(e,t,r))}};function Yd(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Ii(n,r)||!Ii(i,s):!0}function Wp(t,e,n){var r=!1,i=wn,s=e.contextType;return typeof s=="object"&&s!==null?s=st(s):(i=Ue(e)?Hn:Pe.current,r=e.contextTypes,s=(r=r!=null)?Ar(t,i):wn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=lo,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function eh(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&lo.enqueueReplaceState(e,e.state,null)}function lu(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},yc(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=st(s):(s=Ue(e)?Hn:Pe.current,i.context=Ar(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ou(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&lo.enqueueReplaceState(i,i.state,null),aa(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Rr(t,e){try{var n="",r=e;do n+=my(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function rl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function uu(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Fv=typeof WeakMap=="function"?WeakMap:Map;function Gp(t,e,n){n=zt(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){da||(da=!0,_u=r),uu(t,e)},n}function Jp(t,e,n){n=zt(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){uu(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){uu(t,e),typeof r!="function"&&(gn===null?gn=new Set([this]):gn.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function th(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Fv;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=n_.bind(null,t,e,n),e.then(t,t))}function nh(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rh(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zt(-1,1),e.tag=2,mn(n,e,1))),n.lanes|=1),t)}var Vv=Wt.ReactCurrentOwner,Le=!1;function Ae(t,e,n,r){e.child=t===null?xp(e,null,n,r):Or(e,t.child,n,r)}function ih(t,e,n,r,i){n=n.render;var s=e.ref;return Sr(e,i),r=kc(t,e,n,r,s,i),n=Sc(),t!==null&&!Le?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,qt(t,e,i)):(Q&&n&&cc(e),e.flags|=1,Ae(t,e,r,i),e.child)}function sh(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!jc(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Qp(t,e,s,r,i)):(t=Hs(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ii,n(a,r)&&t.ref===e.ref)return qt(t,e,i)}return e.flags|=1,t=vn(s,r),t.ref=e.ref,t.return=e,e.child=t}function Qp(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ii(s,r)&&t.ref===e.ref)if(Le=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Le=!0);else return e.lanes=t.lanes,qt(t,e,i)}return cu(t,e,n,r,i)}function Xp(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},W(vr,Fe),Fe|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,W(vr,Fe),Fe|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,W(vr,Fe),Fe|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,W(vr,Fe),Fe|=r;return Ae(t,e,i,n),e.child}function Yp(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function cu(t,e,n,r,i){var s=Ue(n)?Hn:Pe.current;return s=Ar(e,s),Sr(e,i),n=kc(t,e,n,r,s,i),r=Sc(),t!==null&&!Le?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,qt(t,e,i)):(Q&&r&&cc(e),e.flags|=1,Ae(t,e,n,i),e.child)}function ah(t,e,n,r,i){if(Ue(n)){var s=!0;ta(e)}else s=!1;if(Sr(e,i),e.stateNode===null)Bs(t,e),Wp(e,n,r),lu(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=st(u):(u=Ue(n)?Hn:Pe.current,u=Ar(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&eh(e,a,r,u),tn=!1;var h=e.memoizedState;a.state=h,aa(e,r,a,i),l=e.memoizedState,o!==r||h!==l||De.current||tn?(typeof c=="function"&&(ou(e,n,c,r),l=e.memoizedState),(o=tn||Yd(e,n,o,r,h,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Tp(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:mt(e.type,o),a.props=u,d=e.pendingProps,h=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=st(l):(l=Ue(n)?Hn:Pe.current,l=Ar(e,l));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||h!==l)&&eh(e,a,r,l),tn=!1,h=e.memoizedState,a.state=h,aa(e,r,a,i);var y=e.memoizedState;o!==d||h!==y||De.current||tn?(typeof p=="function"&&(ou(e,n,p,r),y=e.memoizedState),(u=tn||Yd(e,n,u,r,h,y,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),a.props=r,a.state=y,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return du(t,e,n,r,s,i)}function du(t,e,n,r,i,s){Yp(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&qd(e,n,!1),qt(t,e,s);r=e.stateNode,Vv.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Or(e,t.child,null,s),e.child=Or(e,null,o,s)):Ae(t,e,o,s),e.memoizedState=r.state,i&&qd(e,n,!0),e.child}function em(t){var e=t.stateNode;e.pendingContext?Hd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hd(t,e.context,!1),vc(t,e.containerInfo)}function oh(t,e,n,r,i){return Cr(),hc(i),e.flags|=256,Ae(t,e,n,r),e.child}var hu={dehydrated:null,treeContext:null,retryLane:0};function fu(t){return{baseLanes:t,cachePool:null,transitions:null}}function tm(t,e,n){var r=e.pendingProps,i=X.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),W(X,i&1),t===null)return su(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=ho(a,r,0,null),t=Fn(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=fu(n),e.memoizedState=hu,t):Pc(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Hv(t,e,a,r,o,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=vn(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=vn(o,s):(s=Fn(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?fu(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=hu,r}return s=t.child,t=s.sibling,r=vn(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Pc(t,e){return e=ho({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ws(t,e,n,r){return r!==null&&hc(r),Or(e,t.child,null,n),t=Pc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Hv(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=rl(Error(b(422))),ws(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ho({mode:"visible",children:r.children},i,0,null),s=Fn(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Or(e,t.child,null,a),e.child.memoizedState=fu(a),e.memoizedState=hu,s);if(!(e.mode&1))return ws(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(b(419)),r=rl(s,r,void 0),ws(t,e,a,r)}if(o=(a&t.childLanes)!==0,Le||o){if(r=fe,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ht(t,i),wt(r,t,i,-1))}return Rc(),r=rl(Error(b(421))),ws(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=r_.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ve=pn(i.nextSibling),He=e,Q=!0,vt=null,t!==null&&(Xe[Ye++]=Lt,Xe[Ye++]=Dt,Xe[Ye++]=qn,Lt=t.id,Dt=t.overflow,qn=e),e=Pc(e,r.children),e.flags|=4096,e)}function lh(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),au(t.return,e,n)}function il(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function nm(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Ae(t,e,r.children,n),r=X.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lh(t,n,e);else if(t.tag===19)lh(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(W(X,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&oa(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),il(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&oa(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}il(e,!0,n,null,s);break;case"together":il(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bs(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qt(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Kn|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(b(153));if(e.child!==null){for(t=e.child,n=vn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function qv(t,e,n){switch(e.tag){case 3:em(e),Cr();break;case 5:Ap(e);break;case 1:Ue(e.type)&&ta(e);break;case 4:vc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;W(ia,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(W(X,X.current&1),e.flags|=128,null):n&e.child.childLanes?tm(t,e,n):(W(X,X.current&1),t=qt(t,e,n),t!==null?t.sibling:null);W(X,X.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return nm(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),W(X,X.current),r)break;return null;case 22:case 23:return e.lanes=0,Xp(t,e,n)}return qt(t,e,n)}var rm,pu,im,sm;rm=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pu=function(){};im=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,zn(Tt.current);var s=null;switch(n){case"input":i=Ll(t,i),r=Ll(t,r),s=[];break;case"select":i=te({},i,{value:void 0}),r=te({},r,{value:void 0}),s=[];break;case"textarea":i=zl(t,i),r=zl(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ys)}Bl(n,r);var a;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ei.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ei.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&G("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};sm=function(t,e,n,r){n!==r&&(e.flags|=4)};function Xr(t,e){if(!Q)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ke(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Zv(t,e,n){var r=e.pendingProps;switch(dc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ke(e),null;case 1:return Ue(e.type)&&ea(),ke(e),null;case 3:return r=e.stateNode,Ir(),J(De),J(Pe),wc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(vs(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vt!==null&&(ku(vt),vt=null))),pu(t,e),ke(e),null;case 5:_c(e);var i=zn(Li.current);if(n=e.type,t!==null&&e.stateNode!=null)im(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(b(166));return ke(e),null}if(t=zn(Tt.current),vs(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Et]=e,r[$i]=s,t=(e.mode&1)!==0,n){case"dialog":G("cancel",r),G("close",r);break;case"iframe":case"object":case"embed":G("load",r);break;case"video":case"audio":for(i=0;i<si.length;i++)G(si[i],r);break;case"source":G("error",r);break;case"img":case"image":case"link":G("error",r),G("load",r);break;case"details":G("toggle",r);break;case"input":yd(r,s),G("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},G("invalid",r);break;case"textarea":_d(r,s),G("invalid",r)}Bl(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&ys(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&ys(r.textContent,o,t),i=["children",""+o]):Ei.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&G("scroll",r)}switch(n){case"input":us(r),vd(r,s,!0);break;case"textarea":us(r),wd(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Ys)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=jf(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Et]=e,t[$i]=r,rm(t,e,!1,!1),e.stateNode=t;e:{switch(a=Fl(n,r),n){case"dialog":G("cancel",t),G("close",t),i=r;break;case"iframe":case"object":case"embed":G("load",t),i=r;break;case"video":case"audio":for(i=0;i<si.length;i++)G(si[i],t);i=r;break;case"source":G("error",t),i=r;break;case"img":case"image":case"link":G("error",t),G("load",t),i=r;break;case"details":G("toggle",t),i=r;break;case"input":yd(t,r),i=Ll(t,r),G("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=te({},r,{value:void 0}),G("invalid",t);break;case"textarea":_d(t,r),i=zl(t,r),G("invalid",t);break;default:i=r}Bl(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Lf(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&$f(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&xi(t,l):typeof l=="number"&&xi(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ei.hasOwnProperty(s)?l!=null&&s==="onScroll"&&G("scroll",t):l!=null&&Ju(t,s,l,a))}switch(n){case"input":us(t),vd(t,r,!1);break;case"textarea":us(t),wd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+_n(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?_r(t,!!r.multiple,s,!1):r.defaultValue!=null&&_r(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ys)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ke(e),null;case 6:if(t&&e.stateNode!=null)sm(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(b(166));if(n=zn(Li.current),zn(Tt.current),vs(e)){if(r=e.stateNode,n=e.memoizedProps,r[Et]=e,(s=r.nodeValue!==n)&&(t=He,t!==null))switch(t.tag){case 3:ys(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ys(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Et]=e,e.stateNode=r}return ke(e),null;case 13:if(J(X),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Q&&Ve!==null&&e.mode&1&&!(e.flags&128))Sp(),Cr(),e.flags|=98560,s=!1;else if(s=vs(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(b(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(b(317));s[Et]=e}else Cr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ke(e),s=!1}else vt!==null&&(ku(vt),vt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||X.current&1?ce===0&&(ce=3):Rc())),e.updateQueue!==null&&(e.flags|=4),ke(e),null);case 4:return Ir(),pu(t,e),t===null&&Ri(e.stateNode.containerInfo),ke(e),null;case 10:return mc(e.type._context),ke(e),null;case 17:return Ue(e.type)&&ea(),ke(e),null;case 19:if(J(X),s=e.memoizedState,s===null)return ke(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Xr(s,!1);else{if(ce!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=oa(t),a!==null){for(e.flags|=128,Xr(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return W(X,X.current&1|2),e.child}t=t.sibling}s.tail!==null&&oe()>jr&&(e.flags|=128,r=!0,Xr(s,!1),e.lanes=4194304)}else{if(!r)if(t=oa(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Xr(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Q)return ke(e),null}else 2*oe()-s.renderingStartTime>jr&&n!==1073741824&&(e.flags|=128,r=!0,Xr(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=oe(),e.sibling=null,n=X.current,W(X,r?n&1|2:n&1),e):(ke(e),null);case 22:case 23:return Ic(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Fe&1073741824&&(ke(e),e.subtreeFlags&6&&(e.flags|=8192)):ke(e),null;case 24:return null;case 25:return null}throw Error(b(156,e.tag))}function Kv(t,e){switch(dc(e),e.tag){case 1:return Ue(e.type)&&ea(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ir(),J(De),J(Pe),wc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _c(e),null;case 13:if(J(X),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(b(340));Cr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return J(X),null;case 4:return Ir(),null;case 10:return mc(e.type._context),null;case 22:case 23:return Ic(),null;case 24:return null;default:return null}}var bs=!1,Ee=!1,Wv=typeof WeakSet=="function"?WeakSet:Set,T=null;function yr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ie(t,e,r)}else n.current=null}function mu(t,e,n){try{n()}catch(r){ie(t,e,r)}}var uh=!1;function Gv(t,e){if(Xl=Js,t=cp(),uc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var p;d!==n||i!==0&&d.nodeType!==3||(o=a+i),d!==s||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++u===i&&(o=a),h===s&&++c===r&&(l=a),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yl={focusedElem:t,selectionRange:n},Js=!1,T=e;T!==null;)if(e=T,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,T=t;else for(;T!==null;){e=T;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,_=y.memoizedState,g=e.stateNode,f=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:mt(e.type,v),_);g.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(b(163))}}catch(w){ie(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,T=t;break}T=e.return}return y=uh,uh=!1,y}function gi(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&mu(e,n,s)}i=i.next}while(i!==r)}}function uo(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function am(t){var e=t.alternate;e!==null&&(t.alternate=null,am(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Et],delete e[$i],delete e[nu],delete e[Iv],delete e[Rv])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function om(t){return t.tag===5||t.tag===3||t.tag===4}function ch(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||om(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ys));else if(r!==4&&(t=t.child,t!==null))for(yu(t,e,n),t=t.sibling;t!==null;)yu(t,e,n),t=t.sibling}function vu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vu(t,e,n),t=t.sibling;t!==null;)vu(t,e,n),t=t.sibling}var ge=null,gt=!1;function Jt(t,e,n){for(n=n.child;n!==null;)lm(t,e,n),n=n.sibling}function lm(t,e,n){if(Pt&&typeof Pt.onCommitFiberUnmount=="function")try{Pt.onCommitFiberUnmount(to,n)}catch{}switch(n.tag){case 5:Ee||yr(n,e);case 6:var r=ge,i=gt;ge=null,Jt(t,e,n),ge=r,gt=i,ge!==null&&(gt?(t=ge,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ge.removeChild(n.stateNode));break;case 18:ge!==null&&(gt?(t=ge,n=n.stateNode,t.nodeType===8?Qo(t.parentNode,n):t.nodeType===1&&Qo(t,n),Ci(t)):Qo(ge,n.stateNode));break;case 4:r=ge,i=gt,ge=n.stateNode.containerInfo,gt=!0,Jt(t,e,n),ge=r,gt=i;break;case 0:case 11:case 14:case 15:if(!Ee&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&mu(n,e,a),i=i.next}while(i!==r)}Jt(t,e,n);break;case 1:if(!Ee&&(yr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){ie(n,e,o)}Jt(t,e,n);break;case 21:Jt(t,e,n);break;case 22:n.mode&1?(Ee=(r=Ee)||n.memoizedState!==null,Jt(t,e,n),Ee=r):Jt(t,e,n);break;default:Jt(t,e,n)}}function dh(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Wv),e.forEach(function(r){var i=i_.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ut(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:ge=o.stateNode,gt=!1;break e;case 3:ge=o.stateNode.containerInfo,gt=!0;break e;case 4:ge=o.stateNode.containerInfo,gt=!0;break e}o=o.return}if(ge===null)throw Error(b(160));lm(s,a,i),ge=null,gt=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){ie(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)um(e,t),e=e.sibling}function um(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ut(e,t),kt(t),r&4){try{gi(3,t,t.return),uo(3,t)}catch(v){ie(t,t.return,v)}try{gi(5,t,t.return)}catch(v){ie(t,t.return,v)}}break;case 1:ut(e,t),kt(t),r&512&&n!==null&&yr(n,n.return);break;case 5:if(ut(e,t),kt(t),r&512&&n!==null&&yr(n,n.return),t.flags&32){var i=t.stateNode;try{xi(i,"")}catch(v){ie(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&If(i,s),Fl(o,a);var u=Fl(o,s);for(a=0;a<l.length;a+=2){var c=l[a],d=l[a+1];c==="style"?Lf(i,d):c==="dangerouslySetInnerHTML"?$f(i,d):c==="children"?xi(i,d):Ju(i,c,d,u)}switch(o){case"input":Dl(i,s);break;case"textarea":Rf(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?_r(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?_r(i,!!s.multiple,s.defaultValue,!0):_r(i,!!s.multiple,s.multiple?[]:"",!1))}i[$i]=s}catch(v){ie(t,t.return,v)}}break;case 6:if(ut(e,t),kt(t),r&4){if(t.stateNode===null)throw Error(b(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){ie(t,t.return,v)}}break;case 3:if(ut(e,t),kt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ci(e.containerInfo)}catch(v){ie(t,t.return,v)}break;case 4:ut(e,t),kt(t);break;case 13:ut(e,t),kt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Cc=oe())),r&4&&dh(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Ee=(u=Ee)||c,ut(e,t),Ee=u):ut(e,t),kt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(T=t,c=t.child;c!==null;){for(d=T=c;T!==null;){switch(h=T,p=h.child,h.tag){case 0:case 11:case 14:case 15:gi(4,h,h.return);break;case 1:yr(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){ie(r,n,v)}}break;case 5:yr(h,h.return);break;case 22:if(h.memoizedState!==null){fh(d);continue}}p!==null?(p.return=h,T=p):fh(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Nf("display",a))}catch(v){ie(t,t.return,v)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){ie(t,t.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ut(e,t),kt(t),r&4&&dh(t);break;case 21:break;default:ut(e,t),kt(t)}}function kt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(om(n)){var r=n;break e}n=n.return}throw Error(b(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(xi(i,""),r.flags&=-33);var s=ch(t);vu(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=ch(t);yu(t,o,a);break;default:throw Error(b(161))}}catch(l){ie(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Jv(t,e,n){T=t,cm(t)}function cm(t,e,n){for(var r=(t.mode&1)!==0;T!==null;){var i=T,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||bs;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Ee;o=bs;var u=Ee;if(bs=a,(Ee=l)&&!u)for(T=i;T!==null;)a=T,l=a.child,a.tag===22&&a.memoizedState!==null?ph(i):l!==null?(l.return=a,T=l):ph(i);for(;s!==null;)T=s,cm(s),s=s.sibling;T=i,bs=o,Ee=u}hh(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,T=s):hh(t)}}function hh(t){for(;T!==null;){var e=T;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ee||uo(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ee)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:mt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Jd(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Jd(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Ci(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(b(163))}Ee||e.flags&512&&gu(e)}catch(h){ie(e,e.return,h)}}if(e===t){T=null;break}if(n=e.sibling,n!==null){n.return=e.return,T=n;break}T=e.return}}function fh(t){for(;T!==null;){var e=T;if(e===t){T=null;break}var n=e.sibling;if(n!==null){n.return=e.return,T=n;break}T=e.return}}function ph(t){for(;T!==null;){var e=T;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{uo(4,e)}catch(l){ie(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ie(e,i,l)}}var s=e.return;try{gu(e)}catch(l){ie(e,s,l)}break;case 5:var a=e.return;try{gu(e)}catch(l){ie(e,a,l)}}}catch(l){ie(e,e.return,l)}if(e===t){T=null;break}var o=e.sibling;if(o!==null){o.return=e.return,T=o;break}T=e.return}}var Qv=Math.ceil,ca=Wt.ReactCurrentDispatcher,Tc=Wt.ReactCurrentOwner,nt=Wt.ReactCurrentBatchConfig,V=0,fe=null,le=null,_e=0,Fe=0,vr=En(0),ce=0,Mi=null,Kn=0,co=0,Ac=0,yi=null,Ne=null,Cc=0,jr=1/0,jt=null,da=!1,_u=null,gn=null,ks=!1,ln=null,ha=0,vi=0,wu=null,Fs=-1,Vs=0;function Ce(){return V&6?oe():Fs!==-1?Fs:Fs=oe()}function yn(t){return t.mode&1?V&2&&_e!==0?_e&-_e:$v.transition!==null?(Vs===0&&(Vs=Wf()),Vs):(t=Z,t!==0||(t=window.event,t=t===void 0?16:tp(t.type)),t):1}function wt(t,e,n,r){if(50<vi)throw vi=0,wu=null,Error(b(185));Wi(t,n,r),(!(V&2)||t!==fe)&&(t===fe&&(!(V&2)&&(co|=n),ce===4&&sn(t,_e)),ze(t,r),n===1&&V===0&&!(e.mode&1)&&(jr=oe()+500,ao&&xn()))}function ze(t,e){var n=t.callbackNode;$y(t,e);var r=Gs(t,t===fe?_e:0);if(r===0)n!==null&&Sd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Sd(n),e===1)t.tag===0?jv(mh.bind(null,t)):wp(mh.bind(null,t)),Cv(function(){!(V&6)&&xn()}),n=null;else{switch(Gf(r)){case 1:n=tc;break;case 4:n=Zf;break;case 16:n=Ws;break;case 536870912:n=Kf;break;default:n=Ws}n=vm(n,dm.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function dm(t,e){if(Fs=-1,Vs=0,V&6)throw Error(b(327));var n=t.callbackNode;if(Er()&&t.callbackNode!==n)return null;var r=Gs(t,t===fe?_e:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=fa(t,r);else{e=r;var i=V;V|=2;var s=fm();(fe!==t||_e!==e)&&(jt=null,jr=oe()+500,Bn(t,e));do try{e_();break}catch(o){hm(t,o)}while(!0);pc(),ca.current=s,V=i,le!==null?e=0:(fe=null,_e=0,e=ce)}if(e!==0){if(e===2&&(i=Kl(t),i!==0&&(r=i,e=bu(t,i))),e===1)throw n=Mi,Bn(t,0),sn(t,r),ze(t,oe()),n;if(e===6)sn(t,r);else{if(i=t.current.alternate,!(r&30)&&!Xv(i)&&(e=fa(t,r),e===2&&(s=Kl(t),s!==0&&(r=s,e=bu(t,s))),e===1))throw n=Mi,Bn(t,0),sn(t,r),ze(t,oe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(b(345));case 2:Rn(t,Ne,jt);break;case 3:if(sn(t,r),(r&130023424)===r&&(e=Cc+500-oe(),10<e)){if(Gs(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ce(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=tu(Rn.bind(null,t,Ne,jt),e);break}Rn(t,Ne,jt);break;case 4:if(sn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-_t(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Qv(r/1960))-r,10<r){t.timeoutHandle=tu(Rn.bind(null,t,Ne,jt),r);break}Rn(t,Ne,jt);break;case 5:Rn(t,Ne,jt);break;default:throw Error(b(329))}}}return ze(t,oe()),t.callbackNode===n?dm.bind(null,t):null}function bu(t,e){var n=yi;return t.current.memoizedState.isDehydrated&&(Bn(t,e).flags|=256),t=fa(t,e),t!==2&&(e=Ne,Ne=n,e!==null&&ku(e)),t}function ku(t){Ne===null?Ne=t:Ne.push.apply(Ne,t)}function Xv(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!bt(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function sn(t,e){for(e&=~Ac,e&=~co,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_t(e),r=1<<n;t[n]=-1,e&=~r}}function mh(t){if(V&6)throw Error(b(327));Er();var e=Gs(t,0);if(!(e&1))return ze(t,oe()),null;var n=fa(t,e);if(t.tag!==0&&n===2){var r=Kl(t);r!==0&&(e=r,n=bu(t,r))}if(n===1)throw n=Mi,Bn(t,0),sn(t,e),ze(t,oe()),n;if(n===6)throw Error(b(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rn(t,Ne,jt),ze(t,oe()),null}function Oc(t,e){var n=V;V|=1;try{return t(e)}finally{V=n,V===0&&(jr=oe()+500,ao&&xn())}}function Wn(t){ln!==null&&ln.tag===0&&!(V&6)&&Er();var e=V;V|=1;var n=nt.transition,r=Z;try{if(nt.transition=null,Z=1,t)return t()}finally{Z=r,nt.transition=n,V=e,!(V&6)&&xn()}}function Ic(){Fe=vr.current,J(vr)}function Bn(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Av(n)),le!==null)for(n=le.return;n!==null;){var r=n;switch(dc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ea();break;case 3:Ir(),J(De),J(Pe),wc();break;case 5:_c(r);break;case 4:Ir();break;case 13:J(X);break;case 19:J(X);break;case 10:mc(r.type._context);break;case 22:case 23:Ic()}n=n.return}if(fe=t,le=t=vn(t.current,null),_e=Fe=e,ce=0,Mi=null,Ac=co=Kn=0,Ne=yi=null,Un!==null){for(e=0;e<Un.length;e++)if(n=Un[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}Un=null}return t}function hm(t,e){do{var n=le;try{if(pc(),zs.current=ua,la){for(var r=ee.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}la=!1}if(Zn=0,he=ue=ee=null,mi=!1,Di=0,Tc.current=null,n===null||n.return===null){ce=1,Mi=e,le=null;break}e:{var s=t,a=n.return,o=n,l=e;if(e=_e,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=nh(a);if(p!==null){p.flags&=-257,rh(p,a,o,s,e),p.mode&1&&th(s,u,e),e=p,l=u;var y=e.updateQueue;if(y===null){var v=new Set;v.add(l),e.updateQueue=v}else y.add(l);break e}else{if(!(e&1)){th(s,u,e),Rc();break e}l=Error(b(426))}}else if(Q&&o.mode&1){var _=nh(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),rh(_,a,o,s,e),hc(Rr(l,o));break e}}s=l=Rr(l,o),ce!==4&&(ce=2),yi===null?yi=[s]:yi.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=Gp(s,l,e);Gd(s,g);break e;case 1:o=l;var f=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(gn===null||!gn.has(m)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=Jp(s,o,e);Gd(s,w);break e}}s=s.return}while(s!==null)}mm(n)}catch(E){e=E,le===n&&n!==null&&(le=n=n.return);continue}break}while(!0)}function fm(){var t=ca.current;return ca.current=ua,t===null?ua:t}function Rc(){(ce===0||ce===3||ce===2)&&(ce=4),fe===null||!(Kn&268435455)&&!(co&268435455)||sn(fe,_e)}function fa(t,e){var n=V;V|=2;var r=fm();(fe!==t||_e!==e)&&(jt=null,Bn(t,e));do try{Yv();break}catch(i){hm(t,i)}while(!0);if(pc(),V=n,ca.current=r,le!==null)throw Error(b(261));return fe=null,_e=0,ce}function Yv(){for(;le!==null;)pm(le)}function e_(){for(;le!==null&&!xy();)pm(le)}function pm(t){var e=ym(t.alternate,t,Fe);t.memoizedProps=t.pendingProps,e===null?mm(t):le=e,Tc.current=null}function mm(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Kv(n,e),n!==null){n.flags&=32767,le=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ce=6,le=null;return}}else if(n=Zv(n,e,Fe),n!==null){le=n;return}if(e=e.sibling,e!==null){le=e;return}le=e=t}while(e!==null);ce===0&&(ce=5)}function Rn(t,e,n){var r=Z,i=nt.transition;try{nt.transition=null,Z=1,t_(t,e,n,r)}finally{nt.transition=i,Z=r}return null}function t_(t,e,n,r){do Er();while(ln!==null);if(V&6)throw Error(b(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(b(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Ny(t,s),t===fe&&(le=fe=null,_e=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ks||(ks=!0,vm(Ws,function(){return Er(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=nt.transition,nt.transition=null;var a=Z;Z=1;var o=V;V|=4,Tc.current=null,Gv(t,n),um(n,t),bv(Yl),Js=!!Xl,Yl=Xl=null,t.current=n,Jv(n),Py(),V=o,Z=a,nt.transition=s}else t.current=n;if(ks&&(ks=!1,ln=t,ha=i),s=t.pendingLanes,s===0&&(gn=null),Cy(n.stateNode),ze(t,oe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(da)throw da=!1,t=_u,_u=null,t;return ha&1&&t.tag!==0&&Er(),s=t.pendingLanes,s&1?t===wu?vi++:(vi=0,wu=t):vi=0,xn(),null}function Er(){if(ln!==null){var t=Gf(ha),e=nt.transition,n=Z;try{if(nt.transition=null,Z=16>t?16:t,ln===null)var r=!1;else{if(t=ln,ln=null,ha=0,V&6)throw Error(b(331));var i=V;for(V|=4,T=t.current;T!==null;){var s=T,a=s.child;if(T.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(T=u;T!==null;){var c=T;switch(c.tag){case 0:case 11:case 15:gi(8,c,s)}var d=c.child;if(d!==null)d.return=c,T=d;else for(;T!==null;){c=T;var h=c.sibling,p=c.return;if(am(c),c===u){T=null;break}if(h!==null){h.return=p,T=h;break}T=p}}}var y=s.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}T=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,T=a;else e:for(;T!==null;){if(s=T,s.flags&2048)switch(s.tag){case 0:case 11:case 15:gi(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,T=g;break e}T=s.return}}var f=t.current;for(T=f;T!==null;){a=T;var m=a.child;if(a.subtreeFlags&2064&&m!==null)m.return=a,T=m;else e:for(a=f;T!==null;){if(o=T,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:uo(9,o)}}catch(E){ie(o,o.return,E)}if(o===a){T=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,T=w;break e}T=o.return}}if(V=i,xn(),Pt&&typeof Pt.onPostCommitFiberRoot=="function")try{Pt.onPostCommitFiberRoot(to,t)}catch{}r=!0}return r}finally{Z=n,nt.transition=e}}return!1}function gh(t,e,n){e=Rr(n,e),e=Gp(t,e,1),t=mn(t,e,1),e=Ce(),t!==null&&(Wi(t,1,e),ze(t,e))}function ie(t,e,n){if(t.tag===3)gh(t,t,n);else for(;e!==null;){if(e.tag===3){gh(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gn===null||!gn.has(r))){t=Rr(n,t),t=Jp(e,t,1),e=mn(e,t,1),t=Ce(),e!==null&&(Wi(e,1,t),ze(e,t));break}}e=e.return}}function n_(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ce(),t.pingedLanes|=t.suspendedLanes&n,fe===t&&(_e&n)===n&&(ce===4||ce===3&&(_e&130023424)===_e&&500>oe()-Cc?Bn(t,0):Ac|=n),ze(t,e)}function gm(t,e){e===0&&(t.mode&1?(e=hs,hs<<=1,!(hs&130023424)&&(hs=4194304)):e=1);var n=Ce();t=Ht(t,e),t!==null&&(Wi(t,e,n),ze(t,n))}function r_(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),gm(t,n)}function i_(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(b(314))}r!==null&&r.delete(e),gm(t,n)}var ym;ym=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||De.current)Le=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Le=!1,qv(t,e,n);Le=!!(t.flags&131072)}else Le=!1,Q&&e.flags&1048576&&bp(e,ra,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bs(t,e),t=e.pendingProps;var i=Ar(e,Pe.current);Sr(e,n),i=kc(null,e,r,t,i,n);var s=Sc();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ue(r)?(s=!0,ta(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yc(e),i.updater=lo,e.stateNode=i,i._reactInternals=e,lu(e,r,t,n),e=du(null,e,r,!0,s,n)):(e.tag=0,Q&&s&&cc(e),Ae(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bs(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=a_(r),t=mt(r,t),i){case 0:e=cu(null,e,r,t,n);break e;case 1:e=ah(null,e,r,t,n);break e;case 11:e=ih(null,e,r,t,n);break e;case 14:e=sh(null,e,r,mt(r.type,t),n);break e}throw Error(b(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mt(r,i),cu(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mt(r,i),ah(t,e,r,i,n);case 3:e:{if(em(e),t===null)throw Error(b(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Tp(t,e),aa(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Rr(Error(b(423)),e),e=oh(t,e,r,n,i);break e}else if(r!==i){i=Rr(Error(b(424)),e),e=oh(t,e,r,n,i);break e}else for(Ve=pn(e.stateNode.containerInfo.firstChild),He=e,Q=!0,vt=null,n=xp(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Cr(),r===i){e=qt(t,e,n);break e}Ae(t,e,r,n)}e=e.child}return e;case 5:return Ap(e),t===null&&su(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,eu(r,i)?a=null:s!==null&&eu(r,s)&&(e.flags|=32),Yp(t,e),Ae(t,e,a,n),e.child;case 6:return t===null&&su(e),null;case 13:return tm(t,e,n);case 4:return vc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Or(e,null,r,n):Ae(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mt(r,i),ih(t,e,r,i,n);case 7:return Ae(t,e,e.pendingProps,n),e.child;case 8:return Ae(t,e,e.pendingProps.children,n),e.child;case 12:return Ae(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,W(ia,r._currentValue),r._currentValue=a,s!==null)if(bt(s.value,a)){if(s.children===i.children&&!De.current){e=qt(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=zt(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),au(s.return,n,e),o.lanes|=n;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(b(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),au(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Ae(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Sr(e,n),i=st(i),r=r(i),e.flags|=1,Ae(t,e,r,n),e.child;case 14:return r=e.type,i=mt(r,e.pendingProps),i=mt(r.type,i),sh(t,e,r,i,n);case 15:return Qp(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mt(r,i),Bs(t,e),e.tag=1,Ue(r)?(t=!0,ta(e)):t=!1,Sr(e,n),Wp(e,r,i),lu(e,r,i,n),du(null,e,r,!0,t,n);case 19:return nm(t,e,n);case 22:return Xp(t,e,n)}throw Error(b(156,e.tag))};function vm(t,e){return qf(t,e)}function s_(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tt(t,e,n,r){return new s_(t,e,n,r)}function jc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function a_(t){if(typeof t=="function")return jc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xu)return 11;if(t===Yu)return 14}return 2}function vn(t,e){var n=t.alternate;return n===null?(n=tt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Hs(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")jc(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case lr:return Fn(n.children,i,s,e);case Qu:a=8,i|=8;break;case Rl:return t=tt(12,n,e,i|2),t.elementType=Rl,t.lanes=s,t;case jl:return t=tt(13,n,e,i),t.elementType=jl,t.lanes=s,t;case $l:return t=tt(19,n,e,i),t.elementType=$l,t.lanes=s,t;case Af:return ho(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Pf:a=10;break e;case Tf:a=9;break e;case Xu:a=11;break e;case Yu:a=14;break e;case en:a=16,r=null;break e}throw Error(b(130,t==null?t:typeof t,""))}return e=tt(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Fn(t,e,n,r){return t=tt(7,t,r,e),t.lanes=n,t}function ho(t,e,n,r){return t=tt(22,t,r,e),t.elementType=Af,t.lanes=n,t.stateNode={isHidden:!1},t}function sl(t,e,n){return t=tt(6,t,null,e),t.lanes=n,t}function al(t,e,n){return e=tt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function o_(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mo(0),this.expirationTimes=Mo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mo(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $c(t,e,n,r,i,s,a,o,l){return t=new o_(t,e,n,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=tt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yc(s),t}function l_(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:or,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function _m(t){if(!t)return wn;t=t._reactInternals;e:{if(Xn(t)!==t||t.tag!==1)throw Error(b(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ue(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(b(171))}if(t.tag===1){var n=t.type;if(Ue(n))return _p(t,n,e)}return e}function wm(t,e,n,r,i,s,a,o,l){return t=$c(n,r,!0,t,i,s,a,o,l),t.context=_m(null),n=t.current,r=Ce(),i=yn(n),s=zt(r,i),s.callback=e??null,mn(n,s,i),t.current.lanes=i,Wi(t,i,r),ze(t,r),t}function fo(t,e,n,r){var i=e.current,s=Ce(),a=yn(i);return n=_m(n),e.context===null?e.context=n:e.pendingContext=n,e=zt(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=mn(i,e,a),t!==null&&(wt(t,i,a,s),Us(t,i,a)),a}function pa(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yh(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Nc(t,e){yh(t,e),(t=t.alternate)&&yh(t,e)}function u_(){return null}var bm=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lc(t){this._internalRoot=t}po.prototype.render=Lc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(b(409));fo(t,e,null,null)};po.prototype.unmount=Lc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Wn(function(){fo(null,t,null,null)}),e[Vt]=null}};function po(t){this._internalRoot=t}po.prototype.unstable_scheduleHydration=function(t){if(t){var e=Xf();t={blockedOn:null,target:t,priority:e};for(var n=0;n<rn.length&&e!==0&&e<rn[n].priority;n++);rn.splice(n,0,t),n===0&&ep(t)}};function Dc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function mo(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vh(){}function c_(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=pa(a);s.call(u)}}var a=wm(e,r,t,0,null,!1,!1,"",vh);return t._reactRootContainer=a,t[Vt]=a.current,Ri(t.nodeType===8?t.parentNode:t),Wn(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=pa(l);o.call(u)}}var l=$c(t,0,!1,null,null,!1,!1,"",vh);return t._reactRootContainer=l,t[Vt]=l.current,Ri(t.nodeType===8?t.parentNode:t),Wn(function(){fo(e,l,n,r)}),l}function go(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=pa(a);o.call(l)}}fo(e,a,t,i)}else a=c_(n,e,t,i,r);return pa(a)}Jf=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ii(e.pendingLanes);n!==0&&(nc(e,n|1),ze(e,oe()),!(V&6)&&(jr=oe()+500,xn()))}break;case 13:Wn(function(){var r=Ht(t,1);if(r!==null){var i=Ce();wt(r,t,1,i)}}),Nc(t,1)}};rc=function(t){if(t.tag===13){var e=Ht(t,134217728);if(e!==null){var n=Ce();wt(e,t,134217728,n)}Nc(t,134217728)}};Qf=function(t){if(t.tag===13){var e=yn(t),n=Ht(t,e);if(n!==null){var r=Ce();wt(n,t,e,r)}Nc(t,e)}};Xf=function(){return Z};Yf=function(t,e){var n=Z;try{return Z=t,e()}finally{Z=n}};Hl=function(t,e,n){switch(e){case"input":if(Dl(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=so(r);if(!i)throw Error(b(90));Of(r),Dl(r,i)}}}break;case"textarea":Rf(t,n);break;case"select":e=n.value,e!=null&&_r(t,!!n.multiple,e,!1)}};zf=Oc;Mf=Wn;var d_={usingClientEntryPoint:!1,Events:[Ji,hr,so,Df,Uf,Oc]},Yr={findFiberByHostInstance:Dn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},h_={bundleType:Yr.bundleType,version:Yr.version,rendererPackageName:Yr.rendererPackageName,rendererConfig:Yr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wt.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Vf(t),t===null?null:t.stateNode},findFiberByHostInstance:Yr.findFiberByHostInstance||u_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ss=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ss.isDisabled&&Ss.supportsFiber)try{to=Ss.inject(h_),Pt=Ss}catch{}}Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d_;Ke.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dc(e))throw Error(b(200));return l_(t,e,null,n)};Ke.createRoot=function(t,e){if(!Dc(t))throw Error(b(299));var n=!1,r="",i=bm;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=$c(t,1,!1,null,null,n,!1,r,i),t[Vt]=e.current,Ri(t.nodeType===8?t.parentNode:t),new Lc(e)};Ke.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(b(188)):(t=Object.keys(t).join(","),Error(b(268,t)));return t=Vf(e),t=t===null?null:t.stateNode,t};Ke.flushSync=function(t){return Wn(t)};Ke.hydrate=function(t,e,n){if(!mo(e))throw Error(b(200));return go(null,t,e,!0,n)};Ke.hydrateRoot=function(t,e,n){if(!Dc(t))throw Error(b(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=bm;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=wm(e,null,t,1,n??null,i,!1,s,a),t[Vt]=e.current,Ri(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new po(e)};Ke.render=function(t,e,n){if(!mo(e))throw Error(b(200));return go(null,t,e,!1,n)};Ke.unmountComponentAtNode=function(t){if(!mo(t))throw Error(b(40));return t._reactRootContainer?(Wn(function(){go(null,null,t,!1,function(){t._reactRootContainer=null,t[Vt]=null})}),!0):!1};Ke.unstable_batchedUpdates=Oc;Ke.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!mo(n))throw Error(b(200));if(t==null||t._reactInternals===void 0)throw Error(b(38));return go(t,e,n,!1,r)};Ke.version="18.3.1-next-f1338f8080-20240426";function km(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(km)}catch(t){console.error(t)}}km(),kf.exports=Ke;var f_=kf.exports,_h=f_;Ol.createRoot=_h.createRoot,Ol.hydrateRoot=_h.hydrateRoot;const p_="data:image/svg+xml,%3csvg%20width='27'%20height='33'%20viewBox='0%200%2027%2033'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.53248%2016.0788L2.0004%2030.7978L24.7891%2016.0788L2.00041%201.35974L4.53248%2016.0788ZM4.53248%2016.0788L14.6608%2016.0788'%20stroke='%23FEFEFE'%20stroke-width='2.53207'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function m_(){const t=()=>{window.location.href="http://localhost:3000"};return ft.createElement("main",null,ft.createElement("section",{className:"chatbot-container"},ft.createElement("div",{className:"chatbot-header"},ft.createElement("p",{className:"heading"},"EcoFind Personal Chatbot"),ft.createElement("button",{className:"home-btn",onClick:t},"Back")),ft.createElement("div",{className:"chatbot-conversation-container",id:"chatbot-conversation-container"}),ft.createElement("form",{id:"form",className:"chatbot-input-container"},ft.createElement("input",{name:"user-input",type:"text",id:"user-input",placeholder:"Type your message...",required:!0}),ft.createElement("button",{id:"submit-btn",className:"submit-btn"},ft.createElement("img",{src:p_,className:"send-btn-icon",alt:"Send"})))))}function g_(t){return t.map((e,n)=>n%2===0?`Human: ${e}`:`AI: ${e}`).join(`
`)}const sr="4.4.0";class y_{constructor(e,n){this.response=e,this.controller=n,this.decoder=new v_}async*iterMessages(){if(!this.response.body)throw this.controller.abort(),new Error("Attempted to iterate over a response with no body");const e=new $r,n=w_(this.response.body);for await(const r of n)for(const i of e.decode(r)){const s=this.decoder.decode(i);s&&(yield s)}for(const r of e.flush()){const i=this.decoder.decode(r);i&&(yield i)}}async*[Symbol.asyncIterator](){let e=!1;try{for await(const n of this.iterMessages())if(!e){if(n.data.startsWith("[DONE]")){e=!0;continue}if(n.event===null)try{yield JSON.parse(n.data)}catch(r){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),r}}e=!0}catch(n){if(n instanceof Error&&n.name==="AbortError")return;throw n}finally{e||this.controller.abort()}}}class v_{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=__(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}class $r{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=$r.NEWLINE_CHARS.has(n[n.length-1]||"");let i=n.split($r.NEWLINE_REGEXP);return i.length===1&&!r?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),r||(this.buffer=[i.pop()||""]),i)}decodeText(e){var n;if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Error(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return(n=this.textDecoder)!==null&&n!==void 0||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Error(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Error("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}$r.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","","\u2028","\u2029"]);$r.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function __(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function w_(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}let Ge=class Su extends Error{constructor(e,n,r,i){super(Su.makeMessage(n,r)),this.status=e,this.headers=i;const s=n;this.error=s,this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(e,n){return e!=null&&e.message?typeof e.message=="string"?e.message:JSON.stringify(e.message):e?JSON.stringify(e):n||"Unknown error occurred"}static generate(e,n,r,i){if(!e)return new Xi({cause:Cm(n)});const s=n==null?void 0:n.error;return e===400?new zc(e,s,r,i):e===401?new Mc(e,s,r,i):e===403?new Bc(e,s,r,i):e===404?new Fc(e,s,r,i):e===409?new Vc(e,s,r,i):e===422?new Hc(e,s,r,i):e===429?new qc(e,s,r,i):e>=500?new Zc(e,s,r,i):new Su(e,s,r,i)}},ma=class extends Ge{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}},Xi=class extends Ge{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}},Uc=class extends Xi{constructor(){super({message:"Request timed out."})}},zc=class extends Ge{constructor(){super(...arguments),this.status=400}},Mc=class extends Ge{constructor(){super(...arguments),this.status=401}},Bc=class extends Ge{constructor(){super(...arguments),this.status=403}},Fc=class extends Ge{constructor(){super(...arguments),this.status=404}},Vc=class extends Ge{constructor(){super(...arguments),this.status=409}},Hc=class extends Ge{constructor(){super(...arguments),this.status=422}},qc=class extends Ge{constructor(){super(...arguments),this.status=429}},Zc=class extends Ge{};const b_=Object.freeze(Object.defineProperty({__proto__:null,APIConnectionError:Xi,APIConnectionTimeoutError:Uc,APIError:Ge,APIUserAbortError:ma,AuthenticationError:Mc,BadRequestError:zc,ConflictError:Vc,InternalServerError:Zc,NotFoundError:Fc,PermissionDeniedError:Bc,RateLimitError:qc,UnprocessableEntityError:Hc},Symbol.toStringTag,{value:"Module"})),k_=t=>{},S_=fetch.bind(void 0),E_=!1,x_=FormData,wh=typeof File<"u"?File:class extends Blob{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'File' is not defined")}};async function P_(t,e){return{...e,body:new N_(t)}}async function T_(){throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")}function A_(t){return!1}const Sm=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",C_=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Em(t),Em=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",O_=t=>C_(t)||Sm(t)||A_();async function xm(t,e,n={}){var r,i,s;if(t=await t,Sm(t)){const o=await t.blob();return e||(e=(r=new URL(t.url).pathname.split(/[\\/]/).pop())!==null&&r!==void 0?r:"unknown_file"),new wh([o],e,n)}const a=await I_(t);if(e||(e=(i=j_(t))!==null&&i!==void 0?i:"unknown_file"),!n.type){const o=(s=a[0])===null||s===void 0?void 0:s.type;typeof o=="string"&&(n={...n,type:o})}return new wh(a,e,n)}async function I_(t){var e;let n=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)n.push(t);else if(Em(t))n.push(await t.arrayBuffer());else if($_(t))for await(const r of t)n.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(e=t==null?void 0:t.constructor)===null||e===void 0?void 0:e.name}; props: ${R_(t)}`);return n}function R_(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function j_(t){var e;return ol(t.name)||ol(t.filename)||((e=ol(t.path))===null||e===void 0?void 0:e.split(/[\\/]/).pop())}const ol=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},$_=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";class N_{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}const bh=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Bi=async t=>{const e=await L_(t.body);return P_(e,t)},L_=async t=>{const e=new x_;return await Promise.all(Object.entries(t||{}).map(([n,r])=>Eu(e,n,r))),e},Eu=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(O_(n)){const r=await xm(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>Eu(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,i])=>Eu(t,`${e}[${r}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Pm={},D_=function(t,e,n,r,i){if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n},U_=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Es;const z_=2;async function Tm(t){const{response:e}=t;if(t.options.stream)return new y_(e,t.controller);const n=e.headers.get("content-type");if(n!=null&&n.includes("application/json")){const i=await e.json();return ga("response",e.status,e.url,e.headers,i),i}const r=await e.text();return ga("response",e.status,e.url,e.headers,r),r}class yo extends Promise{constructor(e,n=Tm){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new yo(this.responsePromise,async n=>e(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class M_{constructor({baseURL:e,maxRetries:n,timeout:r=6e5,httpAgent:i,fetch:s}){this.baseURL=e,this.maxRetries=ll("maxRetries",n??z_),this.timeout=ll("timeout",r),this.httpAgent=i,this.fetch=s??S_}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Z_(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${X_()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(i=>({method:e,path:n,...i})))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}return null}buildRequest(e){var n,r,i,s,a,o;const{method:l,path:u,query:c,headers:d={}}=e,h=bh(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,p=this.calculateContentLength(h),y=this.buildURL(u,c);"timeout"in e&&ll("timeout",e.timeout);const v=(n=e.timeout)!==null&&n!==void 0?n:this.timeout,_=(i=(r=e.httpAgent)!==null&&r!==void 0?r:this.httpAgent)!==null&&i!==void 0?i:k_(),g=v+1e3;typeof((s=_==null?void 0:_.options)===null||s===void 0?void 0:s.timeout)=="number"&&g>((a=_.options.timeout)!==null&&a!==void 0?a:0)&&(_.options.timeout=g),this.idempotencyHeader&&l!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),d[this.idempotencyHeader]=e.idempotencyKey);const f={...p&&{"Content-Length":p},...this.defaultHeaders(e),...d};bh(e.body)&&!E_&&delete f["Content-Type"],Object.keys(f).forEach(w=>f[w]===null&&delete f[w]);const m={method:l,...h&&{body:h},headers:f,..._&&{agent:_},signal:(o=e.signal)!==null&&o!==void 0?o:null};return this.validateHeaders(f,d),{req:m,url:y,timeout:v}}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,i){return Ge.generate(e,n,r,i)}request(e,n=null){return new yo(this.makeRequest(e,n))}async makeRequest(e,n){var r,i,s;const a=await e;n==null&&(n=(r=a.maxRetries)!==null&&r!==void 0?r:this.maxRetries);const{req:o,url:l,timeout:u}=this.buildRequest(a);if(await this.prepareRequest(o,{url:l,options:a}),ga("request",l,a,o.headers),!((i=a.signal)===null||i===void 0)&&i.aborted)throw new ma;const c=new AbortController,d=await this.fetchWithTimeout(l,o,u,c).catch(Cm);if(d instanceof Error){if(!((s=a.signal)===null||s===void 0)&&s.aborted)throw new ma;if(n)return this.retryRequest(a,n);throw d.name==="AbortError"?new Uc:new Xi({cause:d})}const h=F_(d.headers);if(!d.ok){if(n&&this.shouldRetry(d))return this.retryRequest(a,n,h);const p=await d.text().catch(()=>"Unknown"),y=K_(p),v=y?void 0:p;throw ga("response",d.status,l,h,v),this.makeStatusError(d.status,y,v,h)}return{response:d,options:a,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new B_(this,r,e)}buildURL(e,n){const r=G_(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return Om(i)||(n={...i,...n}),n&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Error(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,i){const{signal:s,...a}=n||{};s&&s.addEventListener("abort",()=>i.abort());const o=setTimeout(()=>i.abort(),r);return this.getRequestClient().fetch(e,{signal:i.signal,...a}).finally(()=>{clearTimeout(o)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){var i;n-=1;const s=parseInt((r==null?void 0:r["retry-after"])||""),a=(i=e.maxRetries)!==null&&i!==void 0?i:this.maxRetries,o=this.calculateRetryTimeoutSeconds(n,s,a)*1e3;return await J_(o),this.makeRequest(e,n)}calculateRetryTimeoutSeconds(e,n,r){if(Number.isInteger(n)&&n<=60)return n;const a=r-e,o=Math.min(.5*Math.pow(a-1,2),2),l=Math.random()-.5;return o+l}getUserAgent(){return`${this.constructor.name}/JS ${sr}`}}class Am{constructor(e,n,r,i){Es.set(this,void 0),D_(this,Es,e),this.options=i,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Error("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e)n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[i,s]of r)e.url.searchParams.set(i,s);n.query=void 0,n.path=e.url.toString()}return await U_(this,Es,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Es=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class B_ extends yo{constructor(e,n,r){super(n,async i=>new r(e,i.response,await Tm(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const F_=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),V_={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0},kh=t=>typeof t=="object"&&t!==null&&!Om(t)&&Object.keys(t).every(e=>Q_(V_,e)),H_=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":sr,"X-Stainless-OS":Eh(Deno.build.os),"X-Stainless-Arch":Sh(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":sr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":sr,"X-Stainless-OS":Eh(process.platform),"X-Stainless-Arch":Sh(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=q_();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":sr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":sr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function q_(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,a=r[3]||0;return{browser:e,version:`${i}.${s}.${a}`}}}return null}const Sh=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Eh=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let xs;const Z_=()=>xs??(xs=H_()),K_=t=>{try{return JSON.parse(t)}catch{return}},W_=new RegExp("^(?:[a-z]+:)?//","i"),G_=t=>W_.test(t),J_=t=>new Promise(e=>setTimeout(e,t)),ll=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Error(`${t} must be an integer`);if(e<0)throw new Error(`${t} must be a positive integer`);return e},Cm=t=>t instanceof Error?t:new Error(t),xh=t=>{var e,n,r,i;if(typeof process<"u")return(n=(e=Pm)===null||e===void 0?void 0:e[t])!==null&&n!==void 0?n:void 0;if(typeof Deno<"u")return(i=(r=Deno.env)===null||r===void 0?void 0:r.get)===null||i===void 0?void 0:i.call(r,t)};function Om(t){if(!t)return!0;for(const e in t)return!1;return!0}function Q_(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ga(t,...e){typeof process<"u"&&Pm.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const X_=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),Y_=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class vo extends Am{constructor(e,n,r,i){super(e,n,r,i),this.object=r.object,this.data=r.data}getPaginatedItems(){return this.data}nextPageParams(){return null}nextPageInfo(){return null}}class Kc extends Am{constructor(e,n,r,i){super(e,n,r,i),this.data=r.data}getPaginatedItems(){return this.data}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var e,n;if(!(!((e=this.data)===null||e===void 0)&&e.length))return null;const r=(n=this.data[this.data.length-1])===null||n===void 0?void 0:n.id;return r?{params:{after:r}}:null}}class je{constructor(e){this.client=e,this.get=e.get.bind(e),this.post=e.post.bind(e),this.patch=e.patch.bind(e),this.put=e.put.bind(e),this.delete=e.delete.bind(e),this.getAPIList=e.getAPIList.bind(e)}}class ya extends je{create(e,n){return this.post("/audio/transcriptions",Bi({body:e,...n}))}}ya||(ya={});class va extends je{create(e,n){return this.post("/audio/translations",Bi({body:e,...n}))}}va||(va={});class _a extends je{constructor(){super(...arguments),this.transcriptions=new ya(this.client),this.translations=new va(this.client)}}(function(t){t.Transcriptions=ya,t.Translations=va})(_a||(_a={}));let wa=class extends je{create(e,n){var r;return this.post("/chat/completions",{body:e,...n,stream:(r=e.stream)!==null&&r!==void 0?r:!1})}};wa||(wa={});class ba extends je{constructor(){super(...arguments),this.completions=new wa(this.client)}}(function(t){t.Completions=wa})(ba||(ba={}));class ka extends je{create(e,n){var r;return this.post("/completions",{body:e,...n,stream:(r=e.stream)!==null&&r!==void 0?r:!1})}}ka||(ka={});let Sa=class extends je{create(e,n){return this.post("/embeddings",{body:e,...n})}};Sa||(Sa={});class Ea extends je{create(e,n){return this.post("/edits",{body:e,...n})}}Ea||(Ea={});class xa extends je{create(e,n){return this.post("/files",Bi({body:e,...n}))}retrieve(e,n){return this.get(`/files/${e}`,n)}list(e){return this.getAPIList("/files",Im,e)}del(e,n){return this.delete(`/files/${e}`,n)}retrieveContent(e,n){return this.get(`/files/${e}/content`,{...n,headers:{Accept:"application/json",...n==null?void 0:n.headers}})}}class Im extends vo{}xa||(xa={});class Pa extends je{create(e,n){return this.post("/fine-tunes",{body:e,...n})}retrieve(e,n){return this.get(`/fine-tunes/${e}`,n)}list(e){return this.getAPIList("/fine-tunes",Rm,e)}cancel(e,n){return this.post(`/fine-tunes/${e}/cancel`,n)}listEvents(e,n,r){var i;return this.get(`/fine-tunes/${e}/events`,{query:n,timeout:864e5,...r,stream:(i=n==null?void 0:n.stream)!==null&&i!==void 0?i:!1})}}class Rm extends vo{}Pa||(Pa={});class Ta extends je{create(e,n){return this.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return kh(e)?this.list({},e):this.getAPIList("/fine_tuning/jobs",jm,{query:e,...n})}cancel(e,n){return this.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return kh(n)?this.listEvents(e,{},n):this.getAPIList(`/fine_tuning/jobs/${e}/events`,$m,{query:n,...r})}}class jm extends Kc{}class $m extends Kc{}Ta||(Ta={});class Aa extends je{constructor(){super(...arguments),this.jobs=new Ta(this.client)}}(function(t){t.Jobs=Ta,t.FineTuningJobsPage=jm,t.FineTuningJobEventsPage=$m})(Aa||(Aa={}));class Ca extends je{createVariation(e,n){return this.post("/images/variations",Bi({body:e,...n}))}edit(e,n){return this.post("/images/edits",Bi({body:e,...n}))}generate(e,n){return this.post("/images/generations",{body:e,...n})}}Ca||(Ca={});class Oa extends je{retrieve(e,n){return this.get(`/models/${e}`,n)}list(e){return this.getAPIList("/models",Nm,e)}del(e,n){return this.delete(`/models/${e}`,n)}}class Nm extends vo{}Oa||(Oa={});class Ia extends je{create(e,n){return this.post("/moderations",{body:e,...n})}}Ia||(Ia={});var Lm;class pe extends M_{constructor(e){var n,r,{apiKey:i=xh("OPENAI_API_KEY"),organization:s=(n=xh("OPENAI_ORG_ID"))!==null&&n!==void 0?n:null,...a}=e===void 0?{}:e;if(i===void 0)throw new Error("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'my apiKey' }).");const o={apiKey:i,organization:s,baseURL:"https://api.openai.com/v1",...a};if(!o.dangerouslyAllowBrowser&&Y_())throw new Error(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:(r=o.timeout)!==null&&r!==void 0?r:6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new ka(this),this.chat=new ba(this),this.edits=new Ea(this),this.embeddings=new Sa(this),this.files=new xa(this),this.images=new Ca(this),this.audio=new _a(this),this.moderations=new Ia(this),this.models=new Oa(this),this.fineTuning=new Aa(this),this.fineTunes=new Pa(this),this._options=o,this.apiKey=i,this.organization=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Lm=pe;pe.OpenAI=Lm;pe.APIError=Ge;pe.APIConnectionError=Xi;pe.APIConnectionTimeoutError=Uc;pe.APIUserAbortError=ma;pe.NotFoundError=Fc;pe.ConflictError=Vc;pe.RateLimitError=qc;pe.BadRequestError=zc;pe.AuthenticationError=Mc;pe.InternalServerError=Zc;pe.PermissionDeniedError=Bc;pe.UnprocessableEntityError=Hc;const{APIError:IE,APIConnectionError:RE,APIConnectionTimeoutError:ew,APIUserAbortError:tw,NotFoundError:jE,ConflictError:$E,RateLimitError:NE,BadRequestError:LE,AuthenticationError:DE,InternalServerError:UE,PermissionDeniedError:zE,UnprocessableEntityError:ME}=b_;(function(t){t.toFile=xm,t.fileFromPath=T_,t.Page=vo,t.CursorPage=Kc,t.Completions=ka,t.Chat=ba,t.Edits=Ea,t.Embeddings=Sa,t.Files=xa,t.FileObjectsPage=Im,t.Images=Ca,t.Audio=_a,t.Moderations=Ia,t.Models=Oa,t.ModelsPage=Nm,t.FineTuning=Aa,t.FineTunes=Pa,t.FineTunesPage=Rm})(pe||(pe={}));var _o={};_o.byteLength=iw;_o.toByteArray=aw;_o.fromByteArray=uw;var xt=[],Qe=[],nw=typeof Uint8Array<"u"?Uint8Array:Array,ul="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var tr=0,rw=ul.length;tr<rw;++tr)xt[tr]=ul[tr],Qe[ul.charCodeAt(tr)]=tr;Qe[45]=62;Qe[95]=63;function Dm(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function iw(t){var e=Dm(t),n=e[0],r=e[1];return(n+r)*3/4-r}function sw(t,e,n){return(e+n)*3/4-n}function aw(t){var e,n=Dm(t),r=n[0],i=n[1],s=new nw(sw(t,r,i)),a=0,o=i>0?r-4:r,l;for(l=0;l<o;l+=4)e=Qe[t.charCodeAt(l)]<<18|Qe[t.charCodeAt(l+1)]<<12|Qe[t.charCodeAt(l+2)]<<6|Qe[t.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=Qe[t.charCodeAt(l)]<<2|Qe[t.charCodeAt(l+1)]>>4,s[a++]=e&255),i===1&&(e=Qe[t.charCodeAt(l)]<<10|Qe[t.charCodeAt(l+1)]<<4|Qe[t.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function ow(t){return xt[t>>18&63]+xt[t>>12&63]+xt[t>>6&63]+xt[t&63]}function lw(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(ow(r));return i.join("")}function uw(t){for(var e,n=t.length,r=n%3,i=[],s=16383,a=0,o=n-r;a<o;a+=s)i.push(lw(t,a,a+s>o?o:a+s));return r===1?(e=t[n-1],i.push(xt[e>>2]+xt[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(xt[e>>10]+xt[e>>4&63]+xt[e<<2&63]+"=")),i.join("")}var cw=Object.defineProperty,dw=(t,e,n)=>e in t?cw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hw=(t,e,n)=>(dw(t,e+"",n),n);function fw(t,e){let n=Array.from({length:t.length},(r,i)=>({start:i,end:i+1}));for(;n.length>1;){let r=null;for(let i=0;i<n.length-1;i++){const s=t.slice(n[i].start,n[i+1].end),a=e.get(s.join(","));a!=null&&(r==null||a<r[0])&&(r=[a,i])}if(r!=null){const i=r[1];n[i]={start:n[i].start,end:n[i+1].end},n.splice(i+1,1)}else break}return n}function pw(t,e){return t.length===1?[e.get(t.join(","))]:fw(t,e).map(n=>e.get(t.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function mw(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var xu=class{constructor(t,e){Gt(this,"specialTokens");Gt(this,"inverseSpecialTokens");Gt(this,"patStr");Gt(this,"textEncoder",new TextEncoder);Gt(this,"textDecoder",new TextDecoder("utf-8"));Gt(this,"rankMap",new Map);Gt(this,"textMap",new Map);this.patStr=t.pat_str;const n=t.bpe_ranks.split(`
`).filter(Boolean).reduce((r,i)=>{const[s,a,...o]=i.split(" "),l=Number.parseInt(a,10);return o.forEach((u,c)=>r[u]=l+c),r},{});for(const[r,i]of Object.entries(n)){const s=_o.toByteArray(r);this.rankMap.set(s.join(","),i),this.textMap.set(i,s)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[i,s])=>(r[s]=this.textEncoder.encode(i),r),{})}encode(t,e=[],n="all"){const r=new RegExp(this.patStr,"ug"),i=xu.specialTokenRegex(Object.keys(this.specialTokens)),s=[],a=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(n==="all"?Object.keys(this.specialTokens).filter(u=>!a.has(u)):n);if(o.size>0){const u=xu.specialTokenRegex([...o]),c=t.match(u);if(c!=null)throw new Error(`The text contains a special token that is not allowed: ${c[0]}`)}let l=0;for(;;){let u=null,c=l;for(;i.lastIndex=c,u=i.exec(t),!(u==null||a.has(u[0]));)c=u.index+1;const d=(u==null?void 0:u.index)??t.length;for(const p of t.substring(l,d).matchAll(r)){const y=this.textEncoder.encode(p[0]),v=this.rankMap.get(y.join(","));if(v!=null){s.push(v);continue}s.push(...pw(y,this.rankMap))}if(u==null)break;let h=this.specialTokens[u[0]];s.push(h),l=u.index+u[0].length}return s}decode(t){const e=[];let n=0;for(let s=0;s<t.length;++s){const a=t[s],o=this.textMap.get(a)??this.inverseSpecialTokens[a];o!=null&&(e.push(o),n+=o.length)}const r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.length;return this.textDecoder.decode(r)}},Um=xu;hw(Um,"specialTokenRegex",t=>new RegExp(t.map(e=>mw(e)).join("|"),"g"));function gw(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":return"o200k_base";default:throw new Error("Unknown model")}}var wo={exports:{}},zm={};function ot(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var yw=ot;ot.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};ot.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};ot.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},n),this._options.unref&&this._timer.unref(),!0};ot.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};ot.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};ot.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};ot.prototype.start=ot.prototype.try;ot.prototype.errors=function(){return this._errors};ot.prototype.attempts=function(){return this._attempts};ot.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,n=0,r=0;r<this._errors.length;r++){var i=this._errors[r],s=i.message,a=(t[s]||0)+1;t[s]=a,a>=n&&(e=i,n=a)}return e};(function(t){var e=yw;t.operation=function(n){var r=t.timeouts(n);return new e(r,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},t.timeouts=function(n){if(n instanceof Array)return[].concat(n);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in n)r[i]=n[i];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],a=0;a<r.retries;a++)s.push(this.createTimeout(a,r));return n&&n.forever&&!s.length&&s.push(this.createTimeout(a,r)),s.sort(function(o,l){return o-l}),s},t.createTimeout=function(n,r){var i=r.randomize?Math.random()+1:1,s=Math.round(i*Math.max(r.minTimeout,1)*Math.pow(r.factor,n));return s=Math.min(s,r.maxTimeout),s},t.wrap=function(n,r,i){if(r instanceof Array&&(i=r,r=null),!i){i=[];for(var s in n)typeof n[s]=="function"&&i.push(s)}for(var a=0;a<i.length;a++){var o=i[a],l=n[o];n[o]=(function(c){var d=t.operation(r),h=Array.prototype.slice.call(arguments,1),p=h.pop();h.push(function(y){d.retry(y)||(y&&(arguments[0]=d.mainError()),p.apply(this,arguments))}),d.attempt(function(){c.apply(n,h)})}).bind(n,l),n[o].options=r}}})(zm);var vw=zm;const _w=vw,ww=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class Mm extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const bw=(t,e,n)=>{const r=n.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=r,t},kw=t=>ww.includes(t),Bm=(t,e)=>new Promise((n,r)=>{e={onFailedAttempt:()=>{},retries:10,...e};const i=_w.operation(e);i.attempt(async s=>{try{n(await t(s))}catch(a){if(!(a instanceof Error)){r(new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`));return}if(a instanceof Mm)i.stop(),r(a.originalError);else if(a instanceof TypeError&&!kw(a.message))i.stop(),r(a);else{bw(a,s,e);try{await e.onFailedAttempt(a)}catch(o){r(o);return}i.retry(a)||r(i.mainError())}}})});wo.exports=Bm;wo.exports.default=Bm;wo.exports.AbortError=Mm;var Sw=wo.exports;const Ra=eo(Sw);var Fm={},Vm={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,d,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var p=new i(c,d||l,h),y=n?n+u:u;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],p]:l._events[y].push(p):(l._events[y]=p,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=n?n+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,y=new Array(p);h<p;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(u){var c=n?n+u:u,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,c,d,h,p,y){var v=n?n+u:u;if(!this._events[v])return!1;var _=this._events[v],g=arguments.length,f,m;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),g){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,d),!0;case 4:return _.fn.call(_.context,c,d,h),!0;case 5:return _.fn.call(_.context,c,d,h,p),!0;case 6:return _.fn.call(_.context,c,d,h,p,y),!0}for(m=1,f=new Array(g-1);m<g;m++)f[m-1]=arguments[m];_.fn.apply(_.context,f)}else{var w=_.length,E;for(m=0;m<w;m++)switch(_[m].once&&this.removeListener(u,_[m].fn,void 0,!0),g){case 1:_[m].fn.call(_[m].context);break;case 2:_[m].fn.call(_[m].context,c);break;case 3:_[m].fn.call(_[m].context,c,d);break;case 4:_[m].fn.call(_[m].context,c,d,h);break;default:if(!f)for(E=1,f=new Array(g-1);E<g;E++)f[E-1]=arguments[E];_[m].fn.apply(_[m].context,f)}}return!0},o.prototype.on=function(u,c,d){return s(this,u,c,d,!1)},o.prototype.once=function(u,c,d){return s(this,u,c,d,!0)},o.prototype.removeListener=function(u,c,d,h){var p=n?n+u:u;if(!this._events[p])return this;if(!c)return a(this,p),this;var y=this._events[p];if(y.fn)y.fn===c&&(!h||y.once)&&(!d||y.context===d)&&a(this,p);else{for(var v=0,_=[],g=y.length;v<g;v++)(y[v].fn!==c||h&&!y[v].once||d&&y[v].context!==d)&&_.push(y[v]);_.length?this._events[p]=_.length===1?_[0]:_:a(this,p)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=n?n+u:u,this._events[c]&&a(this,c)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(Vm);var Ew=Vm.exports,bo={exports:{}},xw=(t,e)=>(e=e||(()=>{}),t.then(n=>new Promise(r=>{r(e())}).then(()=>n),n=>new Promise(r=>{r(e())}).then(()=>{throw n})));const Pw=xw;class Hm extends Error{constructor(e){super(e),this.name="TimeoutError"}}const qm=(t,e,n)=>new Promise((r,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(t);return}const s=setTimeout(()=>{if(typeof n=="function"){try{r(n())}catch(l){i(l)}return}const a=typeof n=="string"?n:`Promise timed out after ${e} milliseconds`,o=n instanceof Error?n:new Hm(a);typeof t.cancel=="function"&&t.cancel(),i(o)},e);Pw(t.then(r,i),()=>{clearTimeout(s)})});bo.exports=qm;bo.exports.default=qm;bo.exports.TimeoutError=Hm;var Tw=bo.exports,Wc={},Gc={};Object.defineProperty(Gc,"__esModule",{value:!0});function Aw(t,e,n){let r=0,i=t.length;for(;i>0;){const s=i/2|0;let a=r+s;n(t[a],e)<=0?(r=++a,i-=s+1):i=s}return r}Gc.default=Aw;Object.defineProperty(Wc,"__esModule",{value:!0});const Cw=Gc;class Ow{constructor(){this._queue=[]}enqueue(e,n){n=Object.assign({priority:0},n);const r={priority:n.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=n.priority){this._queue.push(r);return}const i=Cw.default(this._queue,r,(s,a)=>a.priority-s.priority);this._queue.splice(i,0,r)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(n=>n.priority===e.priority).map(n=>n.run)}get size(){return this._queue.length}}Wc.default=Ow;Object.defineProperty(Fm,"__esModule",{value:!0});const Iw=Ew,Zm=Tw,Rw=Wc,Ps=()=>{},jw=new Zm.TimeoutError;class $w extends Iw{constructor(e){var n,r,i,s;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Ps,this._resolveIdle=Ps,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Rw.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(n=e.intervalCap)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Ps,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Ps,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const n=this._intervalEnd-e;if(n<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},n)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const n=this._queue.dequeue();return n?(this.emit("active"),n(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,n={}){return new Promise((r,i)=>{const s=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&n.timeout===void 0?e():Zm.default(Promise.resolve(e()),n.timeout===void 0?this._timeout:n.timeout,()=>{(n.throwOnTimeout===void 0?this._throwOnTimeout:n.throwOnTimeout)&&i(jw)});r(await a)}catch(a){i(a)}this._next()};this._queue.enqueue(s,n),this._tryToStartAnother(),this.emit("add")})}async addAll(e,n){return Promise.all(e.map(async r=>this.add(r,n)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const n=this._resolveEmpty;this._resolveEmpty=()=>{n(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const n=this._resolveIdle;this._resolveIdle=()=>{n(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var Mt=Fm.default=$w;const Nw=[400,401,402,403,404,405,406,407,408,409],Lw=t=>{var n,r;if(t.message.startsWith("Cancel")||t.message.startsWith("TimeoutError")||t.name==="TimeoutError"||t.message.startsWith("AbortError")||t.name==="AbortError"||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const e=((n=t==null?void 0:t.response)==null?void 0:n.status)??(t==null?void 0:t.status);if(e&&Nw.includes(+e))throw t;if(((r=t==null?void 0:t.error)==null?void 0:r.code)==="insufficient_quota"){const i=new Error(t==null?void 0:t.message);throw i.name="InsufficientQuotaError",i}};let ko=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??Lw;const n="default"in Mt?Mt.default:Mt;this.queue=new n({concurrency:this.maxConcurrency})}call(e,...n){return this.queue.add(()=>Ra(()=>e(...n).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((i,s)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>fetch(...e).then(n=>n.ok?n:Promise.reject(n)))}};const Ts={},Dw=new ko({});async function Uw(t,e){return t in Ts||(Ts[t]=Dw.fetch(`https://tiktoken.pages.dev/js/${t}.json`,{signal:e==null?void 0:e.signal}).then(n=>n.json()).catch(n=>{throw delete Ts[t],n})),new Um(await Ts[t],e==null?void 0:e.extendedSpecialTokens)}async function zw(t,e){return Uw(gw(t),e)}const Pu=t=>t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t;var Mw=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const Bw=eo(Mw);var Km={exports:{}};const Fw=/[\p{Lu}]/u,Vw=/[\p{Ll}]/u,Ph=/^[\p{Lu}](?![\p{Lu}])/gu,Wm=/([\p{Alpha}\p{N}_]|$)/u,Gm=/[_.\- ]+/,Hw=new RegExp("^"+Gm.source),Th=new RegExp(Gm.source+Wm.source,"gu"),Ah=new RegExp("\\d+"+Wm.source,"gu"),qw=(t,e,n)=>{let r=!1,i=!1,s=!1;for(let a=0;a<t.length;a++){const o=t[a];r&&Fw.test(o)?(t=t.slice(0,a)+"-"+t.slice(a),r=!1,s=i,i=!0,a++):i&&s&&Vw.test(o)?(t=t.slice(0,a-1)+"-"+t.slice(a-1),s=i,i=!1,r=!0):(r=e(o)===o&&n(o)!==o,s=i,i=n(o)===o&&e(o)!==o)}return t},Zw=(t,e)=>(Ph.lastIndex=0,t.replace(Ph,n=>e(n))),Kw=(t,e)=>(Th.lastIndex=0,Ah.lastIndex=0,t.replace(Th,(n,r)=>e(r)).replace(Ah,n=>e(n))),Jm=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(s=>s.trim()).filter(s=>s.length).join("-"):t=t.trim(),t.length===0)return"";const n=e.locale===!1?s=>s.toLowerCase():s=>s.toLocaleLowerCase(e.locale),r=e.locale===!1?s=>s.toUpperCase():s=>s.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?r(t):n(t):(t!==n(t)&&(t=qw(t,n,r)),t=t.replace(Hw,""),e.preserveConsecutiveUppercase?t=Zw(t,n):t=n(t),e.pascalCase&&(t=r(t.charAt(0))+t.slice(1)),Kw(t,r))};Km.exports=Jm;Km.exports.default=Jm;function Ww(t,e){return(e==null?void 0:e[t])||Bw(t)}function Gw(t,e,n){const r={};for(const i in t)Object.hasOwn(t,i)&&(r[e(i,n)]=t[i]);return r}function Ch(t){return Array.isArray(t)?[...t]:{...t}}function Jw(t,e){const n=Ch(t);for(const[r,i]of Object.entries(e)){const[s,...a]=r.split(".").reverse();let o=n;for(const l of a.reverse()){if(o[l]===void 0)break;o[l]=Ch(o[l]),o=o[l]}o[s]!==void 0&&(o[s]={lc:1,type:"secret",id:[i]})}return n}function Qm(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}class bn{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Qm(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...n){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof bn||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},n={},r=Object.keys(this.lc_kwargs).reduce((i,s)=>(i[s]=s in this?this[s]:this.lc_kwargs[s],i),{});for(let i=Object.getPrototypeOf(this);i;i=Object.getPrototypeOf(i))Object.assign(e,Reflect.get(i,"lc_aliases",this)),Object.assign(n,Reflect.get(i,"lc_secrets",this)),Object.assign(r,Reflect.get(i,"lc_attributes",this));return Object.keys(n).forEach(i=>{let s=this,a=r;const[o,...l]=i.split(".").reverse();for(const u of l.reverse()){if(!(u in s)||s[u]===void 0)return;(!(u in a)||a[u]===void 0)&&(typeof s[u]=="object"&&s[u]!=null?a[u]={}:Array.isArray(s[u])&&(a[u]=[])),s=s[u],a=a[u]}o in s&&s[o]!==void 0&&(a[o]=a[o]||s[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:Gw(Object.keys(n).length?Jw(r,n):r,Ww,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}const Qw="__run";class Jc{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new Jc({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class Yi extends bn{get text(){return this.content}constructor(e,n){typeof e=="string"&&(e={content:e,additional_kwargs:n}),e.additional_kwargs||(e.additional_kwargs={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}}class es extends Yi{static _mergeAdditionalKwargs(e,n){const r={...e};for(const[i,s]of Object.entries(n))if(r[i]===void 0)r[i]=s;else{if(typeof r[i]!=typeof s)throw new Error(`additional_kwargs[${i}] already exists in the message chunk, but with a different type.`);if(typeof r[i]=="string")r[i]=r[i]+s;else if(!Array.isArray(r[i])&&typeof r[i]=="object")r[i]=this._mergeAdditionalKwargs(r[i],s);else throw new Error(`additional_kwargs[${i}] already exists in this message chunk.`)}return r}}class Fi extends Yi{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class ja extends es{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new ja({content:this.content+e.content,additional_kwargs:ja._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs)})}}class Xm extends Yi{static lc_name(){return"AIMessage"}_getType(){return"ai"}}class $a extends es{static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}concat(e){return new $a({content:this.content+e.content,additional_kwargs:$a._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs)})}}class Ym extends Yi{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class Na extends es{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new Na({content:this.content+e.content,additional_kwargs:Na._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs)})}}class La extends es{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new La({content:this.content+e.content,additional_kwargs:La._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs),name:this.name??""})}}class eg extends Yi{static lc_name(){return"ChatMessage"}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}}function Xw(t){return typeof t._getType=="function"}function Tu(t){if(typeof t=="string")return new Fi(t);if(Xw(t))return t;const[e,n]=t;if(e==="human"||e==="user")return new Fi({content:n});if(e==="ai"||e==="assistant")return new Xm({content:n});if(e==="system")return new Ym({content:n});throw new Error("Unable to coerce message from array: only human, AI, or system message coercion is currently supported.")}class Da extends es{static lc_name(){return"ChatMessageChunk"}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Da({content:this.content+e.content,additional_kwargs:Da._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs),role:this.role})}}class Qc extends Jc{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new Qc({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}class tg extends bn{}const Yw=Symbol("Let zodToJsonSchema decide on which parser to use"),e0={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},t0=t=>({...e0,...t}),n0=t=>{const e=t0(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,i])=>[i._def,{def:i._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function ng(t,e,n,r){r!=null&&r.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function q(t,e,n,r,i){t[e]=n,ng(t,e,r,i)}var F;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(F||(F={}));var Oh;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Oh||(Oh={}));const P=F.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),$n=t=>{switch(typeof t){case"undefined":return P.undefined;case"string":return P.string;case"number":return isNaN(t)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(t)?P.array:t===null?P.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?P.promise:typeof Map<"u"&&t instanceof Map?P.map:typeof Set<"u"&&t instanceof Set?P.set:typeof Date<"u"&&t instanceof Date?P.date:P.object;default:return P.unknown}},k=F.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class rt extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const u=a.path[l];l===a.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(a))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return i(this),r}static assert(e){if(!(e instanceof rt))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,F.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}rt.create=t=>new rt(t);const Vi=(t,e)=>{let n;switch(t.code){case k.invalid_type:t.received===P.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case k.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,F.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:n=`Unrecognized key(s) in object: ${F.joinValues(t.keys,", ")}`;break;case k.invalid_union:n="Invalid input";break;case k.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${F.joinValues(t.options)}`;break;case k.invalid_enum_value:n=`Invalid enum value. Expected ${F.joinValues(t.options)}, received '${t.received}'`;break;case k.invalid_arguments:n="Invalid function arguments";break;case k.invalid_return_type:n="Invalid function return type";break;case k.invalid_date:n="Invalid date";break;case k.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:F.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case k.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case k.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case k.custom:n="Invalid input";break;case k.invalid_intersection_types:n="Intersection results could not be merged";break;case k.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case k.not_finite:n="Number must be finite";break;default:n=e.defaultError,F.assertNever(t)}return{message:n}};let r0=Vi;function Au(){return r0}const Cu=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,s=[...n,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(a,{data:e,defaultError:o}).message;return{...i,path:s,message:o}};function x(t,e){const n=Au(),r=Cu({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Vi?void 0:Vi].filter(i=>!!i)});t.common.issues.push(r)}class Oe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return j;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const s=await i.key,a=await i.value;r.push({key:s,value:a})}return Oe.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return j;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[s.value]=a.value)}return{status:e.value,value:r}}}const j=Object.freeze({status:"aborted"}),ai=t=>({status:"dirty",value:t}),Me=t=>({status:"valid",value:t}),Ih=t=>t.status==="aborted",Rh=t=>t.status==="dirty",Ua=t=>t.status==="valid",za=t=>typeof Promise<"u"&&t instanceof Promise;function Ma(t,e,n,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function rg(t,e,n,r,i){if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var I;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(I||(I={}));var oi,li;class Ot{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const jh=(t,e)=>{if(Ua(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new rt(t.common.issues);return this._error=n,this._error}}};function $(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{var l,u;const{message:c}=t;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??r)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??n)!==null&&u!==void 0?u:o.defaultError}},description:i}}class U{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return $n(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:$n(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Oe,ctx:{common:e.parent.common,data:e.data,parsedType:$n(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(za(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const i={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:$n(e)},s=this._parseSync({data:e,path:i.path,parent:i});return jh(i,s)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:$n(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(za(i)?i:Promise.resolve(i));return jh(r,s)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const a=e(i),o=()=>s.addIssue({code:k.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new Kt({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Bt.create(this,this._def)}nullable(){return Jn.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return At.create(this,this._def)}promise(){return qi.create(this,this._def)}or(e){return Va.create([this,e],this._def)}and(e){return Ha.create(this,e,this._def)}transform(e){return new Kt({...$(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Ga({...$(this._def),innerType:this,defaultValue:n,typeName:S.ZodDefault})}brand(){return new og({typeName:S.ZodBranded,type:this,...$(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Ja({...$(this._def),innerType:this,catchValue:n,typeName:S.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return So.create(this,e)}readonly(){return Qa.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const i0=/^c[^\s-]{8,}$/i,s0=/^[0-9a-z]+$/,a0=/^[0-9A-HJKMNP-TV-Z]{26}$/,o0=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,l0=/^[a-z0-9_-]{21}$/i,u0=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,c0=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,d0="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let cl;const h0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,f0=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,p0=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ig="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",m0=new RegExp(`^${ig}$`);function sg(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function g0(t){return new RegExp(`^${sg(t)}$`)}function y0(t){let e=`${ig}T${sg(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function v0(t,e){return!!((e==="v4"||!e)&&h0.test(t)||(e==="v6"||!e)&&f0.test(t))}class Ut extends U{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){const s=this._getOrReturnCtx(e);return x(s,{code:k.invalid_type,expected:P.string,received:s.parsedType}),j}const r=new Oe;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),x(i,{code:k.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),x(i,{code:k.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,o=e.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?x(i,{code:k.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&x(i,{code:k.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")c0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"email",code:k.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")cl||(cl=new RegExp(d0,"u")),cl.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"emoji",code:k.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")o0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"uuid",code:k.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")l0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"nanoid",code:k.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")i0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"cuid",code:k.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")s0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"cuid2",code:k.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")a0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"ulid",code:k.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),x(i,{validation:"url",code:k.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"regex",code:k.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),x(i,{code:k.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),x(i,{code:k.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),x(i,{code:k.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?y0(s).test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{code:k.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?m0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{code:k.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?g0(s).test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{code:k.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?u0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"duration",code:k.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?v0(e.data,s.version)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"ip",code:k.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?p0.test(e.data)||(i=this._getOrReturnCtx(e,i),x(i,{validation:"base64",code:k.invalid_string,message:s.message}),r.dirty()):F.assertNever(s);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(i=>e.test(i),{validation:n,code:k.invalid_string,...I.errToObj(r)})}_addCheck(e){return new Ut({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...I.errToObj(e)})}url(e){return this._addCheck({kind:"url",...I.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...I.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...I.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...I.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...I.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...I.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...I.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...I.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...I.errToObj(e)})}datetime(e){var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...I.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...I.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...I.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...I.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...I.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...I.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...I.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...I.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...I.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...I.errToObj(n)})}nonempty(e){return this.min(1,I.errToObj(e))}trim(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ut.create=t=>{var e;return new Ut({checks:[],typeName:S.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...$(t)})};function _0(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,s=parseInt(t.toFixed(i).replace(".","")),a=parseInt(e.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class Nr extends U{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){const s=this._getOrReturnCtx(e);return x(s,{code:k.invalid_type,expected:P.number,received:s.parsedType}),j}let r;const i=new Oe;for(const s of this._def.checks)s.kind==="int"?F.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),x(r,{code:k.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),x(r,{code:k.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),x(r,{code:k.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?_0(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),x(r,{code:k.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),x(r,{code:k.not_finite,message:s.message}),i.dirty()):F.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,I.toString(n))}gt(e,n){return this.setLimit("min",e,!1,I.toString(n))}lte(e,n){return this.setLimit("max",e,!0,I.toString(n))}lt(e,n){return this.setLimit("max",e,!1,I.toString(n))}setLimit(e,n,r,i){return new Nr({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:I.toString(i)}]})}_addCheck(e){return new Nr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:I.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:I.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:I.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:I.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:I.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:I.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:I.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:I.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:I.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&F.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Nr.create=t=>new Nr({checks:[],typeName:S.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...$(t)});class Lr extends U{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==P.bigint){const s=this._getOrReturnCtx(e);return x(s,{code:k.invalid_type,expected:P.bigint,received:s.parsedType}),j}let r;const i=new Oe;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),x(r,{code:k.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),x(r,{code:k.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),x(r,{code:k.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):F.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,I.toString(n))}gt(e,n){return this.setLimit("min",e,!1,I.toString(n))}lte(e,n){return this.setLimit("max",e,!0,I.toString(n))}lt(e,n){return this.setLimit("max",e,!1,I.toString(n))}setLimit(e,n,r,i){return new Lr({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:I.toString(i)}]})}_addCheck(e){return new Lr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:I.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:I.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:I.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:I.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:I.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Lr.create=t=>{var e;return new Lr({checks:[],typeName:S.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...$(t)})};class Ou extends U{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){const r=this._getOrReturnCtx(e);return x(r,{code:k.invalid_type,expected:P.boolean,received:r.parsedType}),j}return Me(e.data)}}Ou.create=t=>new Ou({typeName:S.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...$(t)});class Hi extends U{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){const s=this._getOrReturnCtx(e);return x(s,{code:k.invalid_type,expected:P.date,received:s.parsedType}),j}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return x(s,{code:k.invalid_date}),j}const r=new Oe;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),x(i,{code:k.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),x(i,{code:k.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):F.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Hi({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:I.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:I.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Hi.create=t=>new Hi({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:S.ZodDate,...$(t)});class Iu extends U{_parse(e){if(this._getType(e)!==P.symbol){const r=this._getOrReturnCtx(e);return x(r,{code:k.invalid_type,expected:P.symbol,received:r.parsedType}),j}return Me(e.data)}}Iu.create=t=>new Iu({typeName:S.ZodSymbol,...$(t)});class Ba extends U{_parse(e){if(this._getType(e)!==P.undefined){const r=this._getOrReturnCtx(e);return x(r,{code:k.invalid_type,expected:P.undefined,received:r.parsedType}),j}return Me(e.data)}}Ba.create=t=>new Ba({typeName:S.ZodUndefined,...$(t)});class Fa extends U{_parse(e){if(this._getType(e)!==P.null){const r=this._getOrReturnCtx(e);return x(r,{code:k.invalid_type,expected:P.null,received:r.parsedType}),j}return Me(e.data)}}Fa.create=t=>new Fa({typeName:S.ZodNull,...$(t)});class Ru extends U{constructor(){super(...arguments),this._any=!0}_parse(e){return Me(e.data)}}Ru.create=t=>new Ru({typeName:S.ZodAny,...$(t)});class xr extends U{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Me(e.data)}}xr.create=t=>new xr({typeName:S.ZodUnknown,...$(t)});class kn extends U{_parse(e){const n=this._getOrReturnCtx(e);return x(n,{code:k.invalid_type,expected:P.never,received:n.parsedType}),j}}kn.create=t=>new kn({typeName:S.ZodNever,...$(t)});class ju extends U{_parse(e){if(this._getType(e)!==P.undefined){const r=this._getOrReturnCtx(e);return x(r,{code:k.invalid_type,expected:P.void,received:r.parsedType}),j}return Me(e.data)}}ju.create=t=>new ju({typeName:S.ZodVoid,...$(t)});class At extends U{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==P.array)return x(n,{code:k.invalid_type,expected:P.array,received:n.parsedType}),j;if(i.exactLength!==null){const a=n.data.length>i.exactLength.value,o=n.data.length<i.exactLength.value;(a||o)&&(x(n,{code:a?k.too_big:k.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(x(n,{code:k.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(x(n,{code:k.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>i.type._parseAsync(new Ot(n,a,n.path,o)))).then(a=>Oe.mergeArray(r,a));const s=[...n.data].map((a,o)=>i.type._parseSync(new Ot(n,a,n.path,o)));return Oe.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new At({...this._def,minLength:{value:e,message:I.toString(n)}})}max(e,n){return new At({...this._def,maxLength:{value:e,message:I.toString(n)}})}length(e,n){return new At({...this._def,exactLength:{value:e,message:I.toString(n)}})}nonempty(e){return this.min(1,e)}}At.create=(t,e)=>new At({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...$(e)});function ar(t){if(t instanceof re){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Bt.create(ar(r))}return new re({...t._def,shape:()=>e})}else return t instanceof At?new At({...t._def,type:ar(t.element)}):t instanceof Bt?Bt.create(ar(t.unwrap())):t instanceof Jn?Jn.create(ar(t.unwrap())):t instanceof Zt?Zt.create(t.items.map(e=>ar(e))):t}class re extends U{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=F.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==P.object){const u=this._getOrReturnCtx(e);return x(u,{code:k.invalid_type,expected:P.object,received:u.parsedType}),j}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof kn&&this._def.unknownKeys==="strip"))for(const u in i.data)a.includes(u)||o.push(u);const l=[];for(const u of a){const c=s[u],d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Ot(i,d,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof kn){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(u==="strict")o.length>0&&(x(i,{code:k.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Ot(i,d,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key,h=await c.value;u.push({key:d,value:h,alwaysSet:c.alwaysSet})}return u}).then(u=>Oe.mergeObjectSync(r,u)):Oe.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return I.errToObj,new re({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,s,a,o;const l=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=I.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new re({...this._def,unknownKeys:"strip"})}passthrough(){return new re({...this._def,unknownKeys:"passthrough"})}extend(e){return new re({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new re({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:S.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new re({...this._def,catchall:e})}pick(e){const n={};return F.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new re({...this._def,shape:()=>n})}omit(e){const n={};return F.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new re({...this._def,shape:()=>n})}deepPartial(){return ar(this)}partial(e){const n={};return F.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}),new re({...this._def,shape:()=>n})}required(e){const n={};return F.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Bt;)s=s._def.innerType;n[r]=s}}),new re({...this._def,shape:()=>n})}keyof(){return ag(F.objectKeys(this.shape))}}re.create=(t,e)=>new re({shape:()=>t,unknownKeys:"strip",catchall:kn.create(),typeName:S.ZodObject,...$(e)});re.strictCreate=(t,e)=>new re({shape:()=>t,unknownKeys:"strict",catchall:kn.create(),typeName:S.ZodObject,...$(e)});re.lazycreate=(t,e)=>new re({shape:t,unknownKeys:"strip",catchall:kn.create(),typeName:S.ZodObject,...$(e)});class Va extends U{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new rt(o.ctx.common.issues));return x(n,{code:k.invalid_union,unionErrors:a}),j}if(n.common.async)return Promise.all(r.map(async s=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!s&&(s={result:c,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new rt(l));return x(n,{code:k.invalid_union,unionErrors:o}),j}}get options(){return this._def.options}}Va.create=(t,e)=>new Va({options:t,typeName:S.ZodUnion,...$(e)});const Rt=t=>t instanceof Za?Rt(t.schema):t instanceof Kt?Rt(t.innerType()):t instanceof Ka?[t.value]:t instanceof Gn?t.options:t instanceof Wa?F.objectValues(t.enum):t instanceof Ga?Rt(t._def.innerType):t instanceof Ba?[void 0]:t instanceof Fa?[null]:t instanceof Bt?[void 0,...Rt(t.unwrap())]:t instanceof Jn?[null,...Rt(t.unwrap())]:t instanceof og||t instanceof Qa?Rt(t.unwrap()):t instanceof Ja?Rt(t._def.innerType):[];class Xc extends U{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==P.object)return x(n,{code:k.invalid_type,expected:P.object,received:n.parsedType}),j;const r=this.discriminator,i=n.data[r],s=this.optionsMap.get(i);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(x(n,{code:k.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),j)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const i=new Map;for(const s of n){const a=Rt(s.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,s)}}return new Xc({typeName:S.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:i,...$(r)})}}function $u(t,e){const n=$n(t),r=$n(e);if(t===e)return{valid:!0,data:t};if(n===P.object&&r===P.object){const i=F.objectKeys(e),s=F.objectKeys(t).filter(o=>i.indexOf(o)!==-1),a={...t,...e};for(const o of s){const l=$u(t[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===P.array&&r===P.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const a=t[s],o=e[s],l=$u(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===P.date&&r===P.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Ha extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(s,a)=>{if(Ih(s)||Ih(a))return j;const o=$u(s.value,a.value);return o.valid?((Rh(s)||Rh(a))&&n.dirty(),{status:n.value,value:o.data}):(x(r,{code:k.invalid_intersection_types}),j)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Ha.create=(t,e,n)=>new Ha({left:t,right:e,typeName:S.ZodIntersection,...$(n)});class Zt extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==P.array)return x(r,{code:k.invalid_type,expected:P.array,received:r.parsedType}),j;if(r.data.length<this._def.items.length)return x(r,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),j;!this._def.rest&&r.data.length>this._def.items.length&&(x(r,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Ot(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(s).then(a=>Oe.mergeArray(n,a)):Oe.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new Zt({...this._def,rest:e})}}Zt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Zt({items:t,typeName:S.ZodTuple,rest:null,...$(e)})};class qa extends U{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==P.object)return x(r,{code:k.invalid_type,expected:P.object,received:r.parsedType}),j;const i=[],s=this._def.keyType,a=this._def.valueType;for(const o in r.data)i.push({key:s._parse(new Ot(r,o,r.path,o)),value:a._parse(new Ot(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Oe.mergeObjectAsync(n,i):Oe.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof U?new qa({keyType:e,valueType:n,typeName:S.ZodRecord,...$(r)}):new qa({keyType:Ut.create(),valueType:e,typeName:S.ZodRecord,...$(n)})}}class Nu extends U{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==P.map)return x(r,{code:k.invalid_type,expected:P.map,received:r.parsedType}),j;const i=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([o,l],u)=>({key:i._parse(new Ot(r,o,r.path,[u,"key"])),value:s._parse(new Ot(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return j;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return j;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}}}}Nu.create=(t,e,n)=>new Nu({valueType:e,keyType:t,typeName:S.ZodMap,...$(n)});class Dr extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==P.set)return x(r,{code:k.invalid_type,expected:P.set,received:r.parsedType}),j;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(x(r,{code:k.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(x(r,{code:k.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function a(l){const u=new Set;for(const c of l){if(c.status==="aborted")return j;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>s._parse(new Ot(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,n){return new Dr({...this._def,minSize:{value:e,message:I.toString(n)}})}max(e,n){return new Dr({...this._def,maxSize:{value:e,message:I.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Dr.create=(t,e)=>new Dr({valueType:t,minSize:null,maxSize:null,typeName:S.ZodSet,...$(e)});class _i extends U{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==P.function)return x(n,{code:k.invalid_type,expected:P.function,received:n.parsedType}),j;function r(o,l){return Cu({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Au(),Vi].filter(u=>!!u),issueData:{code:k.invalid_arguments,argumentsError:l}})}function i(o,l){return Cu({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Au(),Vi].filter(u=>!!u),issueData:{code:k.invalid_return_type,returnTypeError:l}})}const s={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof qi){const o=this;return Me(async function(...l){const u=new rt([]),c=await o._def.args.parseAsync(l,s).catch(p=>{throw u.addIssue(r(l,p)),u}),d=await Reflect.apply(a,this,c);return await o._def.returns._def.type.parseAsync(d,s).catch(p=>{throw u.addIssue(i(d,p)),u})})}else{const o=this;return Me(function(...l){const u=o._def.args.safeParse(l,s);if(!u.success)throw new rt([r(l,u.error)]);const c=Reflect.apply(a,this,u.data),d=o._def.returns.safeParse(c,s);if(!d.success)throw new rt([i(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new _i({...this._def,args:Zt.create(e).rest(xr.create())})}returns(e){return new _i({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new _i({args:e||Zt.create([]).rest(xr.create()),returns:n||xr.create(),typeName:S.ZodFunction,...$(r)})}}class Za extends U{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Za.create=(t,e)=>new Za({getter:t,typeName:S.ZodLazy,...$(e)});class Ka extends U{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return x(n,{received:n.data,code:k.invalid_literal,expected:this._def.value}),j}return{status:"valid",value:e.data}}get value(){return this._def.value}}Ka.create=(t,e)=>new Ka({value:t,typeName:S.ZodLiteral,...$(e)});function ag(t,e){return new Gn({values:t,typeName:S.ZodEnum,...$(e)})}class Gn extends U{constructor(){super(...arguments),oi.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return x(n,{expected:F.joinValues(r),received:n.parsedType,code:k.invalid_type}),j}if(Ma(this,oi)||rg(this,oi,new Set(this._def.values)),!Ma(this,oi).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return x(n,{received:n.data,code:k.invalid_enum_value,options:r}),j}return Me(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Gn.create(e,{...this._def,...n})}exclude(e,n=this._def){return Gn.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}oi=new WeakMap;Gn.create=ag;class Wa extends U{constructor(){super(...arguments),li.set(this,void 0)}_parse(e){const n=F.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==P.string&&r.parsedType!==P.number){const i=F.objectValues(n);return x(r,{expected:F.joinValues(i),received:r.parsedType,code:k.invalid_type}),j}if(Ma(this,li)||rg(this,li,new Set(F.getValidEnumValues(this._def.values))),!Ma(this,li).has(e.data)){const i=F.objectValues(n);return x(r,{received:r.data,code:k.invalid_enum_value,options:i}),j}return Me(e.data)}get enum(){return this._def.values}}li=new WeakMap;Wa.create=(t,e)=>new Wa({values:t,typeName:S.ZodNativeEnum,...$(e)});class qi extends U{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==P.promise&&n.common.async===!1)return x(n,{code:k.invalid_type,expected:P.promise,received:n.parsedType}),j;const r=n.parsedType===P.promise?n.data:Promise.resolve(n.data);return Me(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}qi.create=(t,e)=>new qi({type:t,typeName:S.ZodPromise,...$(e)});class Kt extends U{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===S.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{x(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(r.data,s);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return j;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?j:l.status==="dirty"||n.value==="dirty"?ai(l.value):l});{if(n.value==="aborted")return j;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?j:o.status==="dirty"||n.value==="dirty"?ai(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?j:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?j:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ua(a))return a;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Ua(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:n.value,value:o})):a);F.assertNever(i)}}Kt.create=(t,e,n)=>new Kt({schema:t,typeName:S.ZodEffects,effect:e,...$(n)});Kt.createWithPreprocess=(t,e,n)=>new Kt({schema:e,effect:{type:"preprocess",transform:t},typeName:S.ZodEffects,...$(n)});class Bt extends U{_parse(e){return this._getType(e)===P.undefined?Me(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Bt.create=(t,e)=>new Bt({innerType:t,typeName:S.ZodOptional,...$(e)});class Jn extends U{_parse(e){return this._getType(e)===P.null?Me(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Jn.create=(t,e)=>new Jn({innerType:t,typeName:S.ZodNullable,...$(e)});class Ga extends U{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===P.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Ga.create=(t,e)=>new Ga({innerType:t,typeName:S.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...$(e)});class Ja extends U{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return za(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new rt(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new rt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Ja.create=(t,e)=>new Ja({innerType:t,typeName:S.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...$(e)});class Lu extends U{_parse(e){if(this._getType(e)!==P.nan){const r=this._getOrReturnCtx(e);return x(r,{code:k.invalid_type,expected:P.nan,received:r.parsedType}),j}return{status:"valid",value:e.data}}}Lu.create=t=>new Lu({typeName:S.ZodNaN,...$(t)});class og extends U{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class So extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?j:s.status==="dirty"?(n.dirty(),ai(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?j:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new So({in:e,out:n,typeName:S.ZodPipeline})}}class Qa extends U{_parse(e){const n=this._def.innerType._parse(e),r=i=>(Ua(i)&&(i.value=Object.freeze(i.value)),i);return za(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}Qa.create=(t,e)=>new Qa({innerType:t,typeName:S.ZodReadonly,...$(e)});re.lazycreate;var S;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(S||(S={}));Ut.create;Nr.create;Lu.create;Lr.create;Ou.create;Hi.create;Iu.create;Ba.create;Fa.create;Ru.create;xr.create;kn.create;ju.create;At.create;re.create;re.strictCreate;Va.create;Xc.create;Ha.create;Zt.create;qa.create;Nu.create;Dr.create;_i.create;Za.create;Ka.create;Gn.create;Wa.create;qi.create;Kt.create;Bt.create;Jn.create;Kt.createWithPreprocess;So.create;function w0(){return{}}function b0(t,e){var r,i;const n={type:"array"};return((i=(r=t.type)==null?void 0:r._def)==null?void 0:i.typeName)!==S.ZodAny&&(n.items=H(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&q(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&q(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(q(n,"minItems",t.exactLength.value,t.exactLength.message,e),q(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function k0(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?q(n,"minimum",r.value,r.message,e):q(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),q(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?q(n,"maximum",r.value,r.message,e):q(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),q(n,"maximum",r.value,r.message,e));break;case"multipleOf":q(n,"multipleOf",r.value,r.message,e);break}return n}function S0(){return{type:"boolean"}}function E0(t,e){return H(t.type._def,e)}const x0=(t,e)=>H(t.innerType._def,e);function lg(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((i,s)=>lg(t,e,i))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return P0(t,e)}}const P0=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":q(n,"minimum",r.value,r.message,e);break;case"max":q(n,"maximum",r.value,r.message,e);break}return n};function T0(t,e){return{...H(t.innerType._def,e),default:t.defaultValue()}}function A0(t,e){return e.effectStrategy==="input"?H(t.schema._def,e):{}}function C0(t){return{type:"string",enum:t.values}}const O0=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function I0(t,e){const n=[H(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),H(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return n.forEach(s=>{if(O0(s))i.push(...s.allOf),s.unevaluatedProperties===void 0&&(r=void 0);else{let a=s;if("additionalProperties"in s&&s.additionalProperties===!1){const{additionalProperties:o,...l}=s;a=l}else r=void 0;i.push(a)}}),i.length?{allOf:i,...r}:void 0}function R0(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let dl;const An={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(dl===void 0&&(dl=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),dl),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function ug(t,e){const n={type:"string"};function r(i){return e.patternStrategy==="escape"?j0(i):i}if(t.checks)for(const i of t.checks)switch(i.kind){case"min":q(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,i.value):i.value,i.message,e);break;case"max":q(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,i.value):i.value,i.message,e);break;case"email":switch(e.emailStrategy){case"format:email":ct(n,"email",i.message,e);break;case"format:idn-email":ct(n,"idn-email",i.message,e);break;case"pattern:zod":dt(n,An.email,i.message,e);break}break;case"url":ct(n,"uri",i.message,e);break;case"uuid":ct(n,"uuid",i.message,e);break;case"regex":dt(n,i.regex,i.message,e);break;case"cuid":dt(n,An.cuid,i.message,e);break;case"cuid2":dt(n,An.cuid2,i.message,e);break;case"startsWith":dt(n,RegExp(`^${r(i.value)}`),i.message,e);break;case"endsWith":dt(n,RegExp(`${r(i.value)}$`),i.message,e);break;case"datetime":ct(n,"date-time",i.message,e);break;case"date":ct(n,"date",i.message,e);break;case"time":ct(n,"time",i.message,e);break;case"duration":ct(n,"duration",i.message,e);break;case"length":q(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,i.value):i.value,i.message,e),q(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,i.value):i.value,i.message,e);break;case"includes":{dt(n,RegExp(r(i.value)),i.message,e);break}case"ip":{i.version!=="v6"&&ct(n,"ipv4",i.message,e),i.version!=="v4"&&ct(n,"ipv6",i.message,e);break}case"emoji":dt(n,An.emoji,i.message,e);break;case"ulid":{dt(n,An.ulid,i.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{ct(n,"binary",i.message,e);break}case"contentEncoding:base64":{q(n,"contentEncoding","base64",i.message,e);break}case"pattern:zod":{dt(n,An.base64,i.message,e);break}}break}case"nanoid":dt(n,An.nanoid,i.message,e)}return n}const j0=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),ct=(t,e,n,r)=>{var i;t.format||(i=t.anyOf)!=null&&i.some(s=>s.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):q(t,"format",e,n,r)},dt=(t,e,n,r)=>{var i;t.pattern||(i=t.allOf)!=null&&i.some(s=>s.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:$h(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):q(t,"pattern",$h(e,r),n,r)},$h=(t,e)=>{var u;const n=typeof t=="function"?t():t;if(!e.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},i=r.i?n.source.toLowerCase():n.source;let s="",a=!1,o=!1,l=!1;for(let c=0;c<i.length;c++){if(a){s+=i[c],a=!1;continue}if(r.i){if(o){if(i[c].match(/[a-z]/)){l?(s+=i[c],s+=`${i[c-2]}-${i[c]}`.toUpperCase(),l=!1):i[c+1]==="-"&&((u=i[c+2])!=null&&u.match(/[a-z]/))?(s+=i[c],l=!0):s+=`${i[c]}${i[c].toUpperCase()}`;continue}}else if(i[c].match(/[a-z]/)){s+=`[${i[c]}${i[c].toUpperCase()}]`;continue}}if(r.m){if(i[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(i[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(r.s&&i[c]==="."){s+=o?`${i[c]}\r
`:`[${i[c]}\r
]`;continue}s+=i[c],i[c]==="\\"?a=!0:o&&i[c]==="]"?o=!1:!o&&i[c]==="["&&(o=!0)}try{const c=new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return s};function cg(t,e){var r,i,s,a;if(e.target==="openApi3"&&((r=t.keyType)==null?void 0:r._def.typeName)===S.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((o,l)=>({...o,[l]:H(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",l]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:H(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return n;if(((i=t.keyType)==null?void 0:i._def.typeName)===S.ZodString&&((s=t.keyType._def.checks)!=null&&s.length)){const o=Object.entries(ug(t.keyType._def,e)).reduce((l,[u,c])=>u==="type"?l:{...l,[u]:c},{});return{...n,propertyNames:o}}else if(((a=t.keyType)==null?void 0:a._def.typeName)===S.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};return n}function $0(t,e){if(e.mapStrategy==="record")return cg(t,e);const n=H(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=H(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function N0(t){const e=t.values,r=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),i=Array.from(new Set(r.map(s=>typeof s)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:r}}function L0(){return{not:{}}}function D0(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Xa={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function U0(t,e){if(e.target==="openApi3")return Nh(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in Xa&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((i,s)=>{const a=Xa[s._def.typeName];return a&&!i.includes(a)?[...i,a]:i},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((i,s)=>{const a=typeof s._def.value;switch(a){case"string":case"number":case"boolean":return[...i,a];case"bigint":return[...i,"integer"];case"object":if(s._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(r.length===n.length){const i=r.filter((s,a,o)=>o.indexOf(s)===a);return{type:i.length>1?i:i[0],enum:n.reduce((s,a)=>s.includes(a._def.value)?s:[...s,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,i)=>[...r,...i._def.values.filter(s=>!r.includes(s))],[])};return Nh(t,e)}const Nh=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,i)=>H(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function z0(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Xa[t.innerType._def.typeName],nullable:!0}:{type:[Xa[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=H(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=H(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function M0(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",ng(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?q(n,"minimum",r.value,r.message,e):q(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),q(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?q(n,"maximum",r.value,r.message,e):q(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),q(n,"maximum",r.value,r.message,e));break;case"multipleOf":q(n,"multipleOf",r.value,r.message,e);break}return n}function B0(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":H(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":H(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function F0(t,e){const n={type:"object",...Object.entries(t.shape()).reduce((r,[i,s])=>{if(s===void 0||s._def===void 0)return r;const a=H(s._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});return a===void 0?r:{properties:{...r.properties,[i]:a},required:s.isOptional()?r.required:[...r.required,i]}},{properties:{},required:[]}),additionalProperties:B0(t,e)};return n.required.length||delete n.required,n}const V0=(t,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return H(t.innerType._def,e);const n=H(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},H0=(t,e)=>{if(e.pipeStrategy==="input")return H(t.in._def,e);if(e.pipeStrategy==="output")return H(t.out._def,e);const n=H(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=H(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(i=>i!==void 0)}};function q0(t,e){return H(t.type._def,e)}function Z0(t,e){const r={type:"array",uniqueItems:!0,items:H(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&q(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&q(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function K0(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>H(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:H(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>H(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function W0(){return{not:{}}}function G0(){return{}}const J0=(t,e)=>H(t.innerType._def,e);function H(t,e,n=!1){var a;const r=e.seen.get(t);if(e.override){const o=(a=e.override)==null?void 0:a.call(e,t,e,r,n);if(o!==Yw)return o}if(r&&!n){const o=Q0(r,e);if(o!==void 0)return o}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const s=Y0(t,t.typeName,e);return s&&eb(t,e,s),i.jsonSchema=s,s}const Q0=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:X0(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},X0=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")},Y0=(t,e,n)=>{switch(e){case S.ZodString:return ug(t,n);case S.ZodNumber:return M0(t,n);case S.ZodObject:return F0(t,n);case S.ZodBigInt:return k0(t,n);case S.ZodBoolean:return S0();case S.ZodDate:return lg(t,n);case S.ZodUndefined:return W0();case S.ZodNull:return D0(n);case S.ZodArray:return b0(t,n);case S.ZodUnion:case S.ZodDiscriminatedUnion:return U0(t,n);case S.ZodIntersection:return I0(t,n);case S.ZodTuple:return K0(t,n);case S.ZodRecord:return cg(t,n);case S.ZodLiteral:return R0(t,n);case S.ZodEnum:return C0(t);case S.ZodNativeEnum:return N0(t);case S.ZodNullable:return z0(t,n);case S.ZodOptional:return V0(t,n);case S.ZodMap:return $0(t,n);case S.ZodSet:return Z0(t,n);case S.ZodLazy:return H(t.getter()._def,n);case S.ZodPromise:return q0(t,n);case S.ZodNaN:case S.ZodNever:return L0();case S.ZodEffects:return A0(t,n);case S.ZodAny:return w0();case S.ZodUnknown:return G0();case S.ZodDefault:return T0(t,n);case S.ZodBranded:return E0(t,n);case S.ZodReadonly:return J0(t,n);case S.ZodCatch:return x0(t,n);case S.ZodPipeline:return H0(t,n);case S.ZodFunction:case S.ZodVoid:case S.ZodSymbol:return;default:return(r=>{})()}},eb=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),tb=(t,e)=>{const n=n0(e),r=void 0,i=e==null?void 0:e.name,s=H(t._def,n,!1)??{},a=i===void 0?r?{...s,[n.definitionPath]:r}:s:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:{...r,[i]:s}};return n.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),a};function nb(t){return{name:t.name,description:t.description,parameters:tb(t.schema)}}function dg(t){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:i,baseURL:s}=t;if(r&&i&&e)return`${i}/${e}`;if(r){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${e}`}return s}var hl={};const rb=()=>typeof window<"u"&&typeof window.document<"u",ib=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",sb=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),hg=()=>typeof Deno<"u",ab=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!hg(),ob=()=>{let t;return rb()?t="browser":ab()?t="node":ib()?t="webworker":sb()?t="jsdom":hg()?t="deno":t="other",t};let fl;async function lb(){return fl===void 0&&(fl={library:"langchain-js",runtime:ob()}),fl}function Y(t){try{return typeof process<"u"?hl==null?void 0:hl[t]:void 0}catch{return}}const ub="modulepreload",cb=function(t){return"/"+t},Lh={},Ct=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.all(n.map(o=>{if(o=cb(o),o in Lh)return;Lh[o]=!0;const l=o.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${u}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":ub,l||(c.as="script",c.crossOrigin=""),c.href=o,a&&c.setAttribute("nonce",a),document.head.appendChild(c),l)return new Promise((d,h)=>{c.addEventListener("load",d),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})}))}return i.then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};let As;const db=new Uint8Array(16);function hb(){if(!As&&(As=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!As))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return As(db)}const fb=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function pb(t){return typeof t=="string"&&fb.test(t)}const me=[];for(let t=0;t<256;++t)me.push((t+256).toString(16).slice(1));function mb(t,e=0){return me[t[e+0]]+me[t[e+1]]+me[t[e+2]]+me[t[e+3]]+"-"+me[t[e+4]]+me[t[e+5]]+"-"+me[t[e+6]]+me[t[e+7]]+"-"+me[t[e+8]]+me[t[e+9]]+"-"+me[t[e+10]]+me[t[e+11]]+me[t[e+12]]+me[t[e+13]]+me[t[e+14]]+me[t[e+15]]}const gb=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Dh={randomUUID:gb};function Nt(t,e,n){if(Dh.randomUUID&&!e&&!t)return Dh.randomUUID();t=t||{};const r=t.random||(t.rng||hb)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,mb(r)}var pl={};class yb{}class ts extends yb{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Qm(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:typeof process<"u"?(pl==null?void 0:pl.LANGCHAIN_CALLBACKS_BACKGROUND)!=="true":!0}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever)}copy(){return new this.constructor(this)}toJSON(){return bn.prototype.toJSON.call(this)}toJSONNotImplemented(){return bn.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class n extends ts{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Nt()}),Object.assign(this,e)}}return new n}}var Yc={exports:{}};Yc.exports;(function(t){const n=(s=0)=>a=>`\x1B[${38+s};5;${a}m`,r=(s=0)=>(a,o,l)=>`\x1B[${38+s};2;${a};${o};${l}m`;function i(){const s=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,l]of Object.entries(a)){for(const[u,c]of Object.entries(l))a[u]={open:`\x1B[${c[0]}m`,close:`\x1B[${c[1]}m`},l[u]=a[u],s.set(c[0],c[1]);Object.defineProperty(a,o,{value:l,enumerable:!1})}return Object.defineProperty(a,"codes",{value:s,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=n(),a.color.ansi16m=r(),a.bgColor.ansi256=n(10),a.bgColor.ansi16m=r(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,l,u)=>o===l&&l===u?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(l/255*5)+Math.round(u/255*5),enumerable:!1},hexToRgb:{value:o=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!l)return[0,0,0];let{colorString:u}=l.groups;u.length===3&&(u=u.split("").map(d=>d+d).join(""));const c=Number.parseInt(u,16);return[c>>16&255,c>>8&255,c&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(t,"exports",{enumerable:!0,get:i})})(Yc);var vb=Yc.exports;const fg=eo(vb);function ml(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}class ed extends ts{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,n){e.child_runs.push(n)}_startTrace(e){if(e.parent_run_id!==void 0){const n=this.runMap.get(e.parent_run_id);n&&(this._addChildRun(n,e),n.child_execution_order=Math.max(n.child_execution_order,e.child_execution_order))}this.runMap.set(e.id,e)}async _endTrace(e){const n=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);n?n.child_execution_order=Math.max(n.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id)}_getExecutionOrder(e){const n=e!==void 0&&this.runMap.get(e);return n?n.child_execution_order+1:1}async handleLLMStart(e,n,r,i,s,a,o){var h;const l=this._getExecutionOrder(i),u=Date.now(),c=o?{...s,metadata:o}:s,d={id:r,name:e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{prompts:n},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:c??{},tags:a||[]};this._startTrace(d),await((h=this.onLLMStart)==null?void 0:h.call(this,d))}async handleChatModelStart(e,n,r,i,s,a,o){var h;const l=this._getExecutionOrder(i),u=Date.now(),c=o?{...s,metadata:o}:s,d={id:r,name:e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{messages:n},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:c??{},tags:a||[]};this._startTrace(d),await((h=this.onLLMStart)==null?void 0:h.call(this,d))}async handleLLMEnd(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onLLMEnd)==null?void 0:i.call(this,r)),await this._endTrace(r)}async handleLLMError(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onLLMError)==null?void 0:i.call(this,r)),await this._endTrace(r)}async handleChainStart(e,n,r,i,s,a,o){var d;const l=this._getExecutionOrder(i),u=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:n,execution_order:l,child_execution_order:l,run_type:o??"chain",child_runs:[],extra:a?{metadata:a}:{},tags:s||[]};this._startTrace(c),await((d=this.onChainStart)==null?void 0:d.call(this,c))}async handleChainEnd(e,n,r,i,s){var o;const a=this.runMap.get(n);if(!a)throw new Error("No chain run to end.");a.end_time=Date.now(),a.outputs=ml(e,"output"),a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),(s==null?void 0:s.inputs)!==void 0&&(a.inputs=ml(s.inputs,"input")),await((o=this.onChainEnd)==null?void 0:o.call(this,a)),await this._endTrace(a)}async handleChainError(e,n,r,i,s){var o;const a=this.runMap.get(n);if(!a)throw new Error("No chain run to end.");a.end_time=Date.now(),a.error=e.message,a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),(s==null?void 0:s.inputs)!==void 0&&(a.inputs=ml(s.inputs,"input")),await((o=this.onChainError)==null?void 0:o.call(this,a)),await this._endTrace(a)}async handleToolStart(e,n,r,i,s,a){var c;const o=this._getExecutionOrder(i),l=Date.now(),u={id:r,name:e.id[e.id.length-1],parent_run_id:i,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:n},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:a?{metadata:a}:{},tags:s||[]};this._startTrace(u),await((c=this.onToolStart)==null?void 0:c.call(this,u))}async handleToolEnd(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onToolEnd)==null?void 0:i.call(this,r)),await this._endTrace(r)}async handleToolError(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onToolError)==null?void 0:i.call(this,r)),await this._endTrace(r)}async handleAgentAction(e,n){var s;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const i=r;i.actions=i.actions||[],i.actions.push(e),i.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((s=this.onAgentAction)==null?void 0:s.call(this,r))}async handleAgentEnd(e,n){var i;const r=this.runMap.get(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((i=this.onAgentEnd)==null?void 0:i.call(this,r)))}async handleRetrieverStart(e,n,r,i,s,a){var c;const o=this._getExecutionOrder(i),l=Date.now(),u={id:r,name:e.id[e.id.length-1],parent_run_id:i,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:n},execution_order:o,child_execution_order:o,run_type:"retriever",child_runs:[],extra:a?{metadata:a}:{},tags:s||[]};this._startTrace(u),await((c=this.onRetrieverStart)==null?void 0:c.call(this,u))}async handleRetrieverEnd(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onRetrieverEnd)==null?void 0:i.call(this,r)),await this._endTrace(r)}async handleRetrieverError(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onRetrieverError)==null?void 0:i.call(this,r)),await this._endTrace(r)}async handleText(e,n){var i;const r=this.runMap.get(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((i=this.onText)==null?void 0:i.call(this,r)))}async handleLLMNewToken(e,n,r,i,s,a){var l;const o=this.runMap.get(r);!o||(o==null?void 0:o.run_type)!=="llm"||(o.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:n,chunk:a==null?void 0:a.chunk}}),await((l=this.onLLMNewToken)==null?void 0:l.call(this,o)))}}function Te(t,e){return`${t.open}${e}${t.close}`}function ht(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function Qt(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:$e}=fg;class Uh extends ed{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const n=[];let r=e;for(;r.parent_run_id;){const i=this.runMap.get(r.parent_run_id);if(i)n.push(i),r=i;else break}return n}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((i,s,a)=>{const o=`${i.execution_order}:${i.run_type}:${i.name}`;return s===a.length-1?Te(fg.bold,o):o}).join(" > ");return Te($e.grey,r)}onChainStart(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.green,"[chain/start]")} [${n}] Entering Chain run with input: ${ht(e.inputs,"[inputs]")}`)}onChainEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.cyan,"[chain/end]")} [${n}] [${Qt(e)}] Exiting Chain run with output: ${ht(e.outputs,"[outputs]")}`)}onChainError(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.red,"[chain/error]")} [${n}] [${Qt(e)}] Chain run errored with error: ${ht(e.error,"[error]")}`)}onLLMStart(e){const n=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(i=>i.trim())}:e.inputs;console.log(`${Te($e.green,"[llm/start]")} [${n}] Entering LLM run with input: ${ht(r,"[inputs]")}`)}onLLMEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.cyan,"[llm/end]")} [${n}] [${Qt(e)}] Exiting LLM run with output: ${ht(e.outputs,"[response]")}`)}onLLMError(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.red,"[llm/error]")} [${n}] [${Qt(e)}] LLM run errored with error: ${ht(e.error,"[error]")}`)}onToolStart(e){var r;const n=this.getBreadcrumbs(e);console.log(`${Te($e.green,"[tool/start]")} [${n}] Entering Tool run with input: "${(r=e.inputs.input)==null?void 0:r.trim()}"`)}onToolEnd(e){var r,i;const n=this.getBreadcrumbs(e);console.log(`${Te($e.cyan,"[tool/end]")} [${n}] [${Qt(e)}] Exiting Tool run with output: "${(i=(r=e.outputs)==null?void 0:r.output)==null?void 0:i.trim()}"`)}onToolError(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.red,"[tool/error]")} [${n}] [${Qt(e)}] Tool run errored with error: ${ht(e.error,"[error]")}`)}onRetrieverStart(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.green,"[retriever/start]")} [${n}] Entering Retriever run with input: ${ht(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.cyan,"[retriever/end]")} [${n}] [${Qt(e)}] Exiting Retriever run with output: ${ht(e.outputs,"[outputs]")}`)}onRetrieverError(e){const n=this.getBreadcrumbs(e);console.log(`${Te($e.red,"[retriever/error]")} [${n}] [${Qt(e)}] Retriever run errored with error: ${ht(e.error,"[error]")}`)}onAgentAction(e){const n=e,r=this.getBreadcrumbs(e);console.log(`${Te($e.blue,"[agent/action]")} [${r}] Agent selected action: ${ht(n.actions[n.actions.length-1],"[action]")}`)}}const _b=[400,401,403,404,405,406,407,408],wb=[409];class bb{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const n="default"in Mt?Mt.default:Mt;this.queue=new n({concurrency:this.maxConcurrency})}call(e,...n){return this.queue.add(()=>Ra(()=>e(...n).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt(r){var s;if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const i=(s=r==null?void 0:r.response)==null?void 0:s.status;if(i){if(_b.includes(+i))throw r;if(wb.includes(+i))return}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((i,s)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>fetch(...e).then(n=>n.ok?n:Promise.reject(n)))}}function zh(t){return typeof(t==null?void 0:t._getType)=="function"}function Mh(t){const e={type:t._getType(),data:{content:t.content}};return t!=null&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}var wi={};let It;const kb=()=>typeof window<"u"&&typeof window.document<"u",Sb=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Eb=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),pg=()=>typeof Deno<"u",xb=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!pg(),Pb=()=>It||(kb()?It="browser":xb()?It="node":Sb()?It="webworker":Eb()?It="jsdom":pg()?It="deno":It="other",It);let gl;async function Tb(){if(gl===void 0){const t=Pb(),e=Ob();gl={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:mg,...e}}return gl}function Ab(){const t=Cb()||{},e={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"];for(const[r,i]of Object.entries(t))r.startsWith("LANGCHAIN_")&&typeof i=="string"&&!n.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=i:e[r]=i);return e}function Cb(){try{return typeof process<"u"&&wi?Object.entries(wi).reduce((t,[e,n])=>(t[e]=String(n),t),{}):void 0}catch{return}}function Nn(t){try{return typeof process<"u"?wi==null?void 0:wi[t]:void 0}catch{return}}let yl;function Ob(){if(yl!==void 0)return yl;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const n of t){const r=Nn(n);r!==void 0&&(e[n]=r)}return yl=e,e}async function Bh(t){const e=await Tb(),n=Ab();return t.map(r=>{const i=r.extra??{},s=i.metadata;return r.extra={...i,runtime:{...e,...i==null?void 0:i.runtime},metadata:{...n,...n.revision_id||r.revision_id?{revision_id:r.revision_id??n.revision_id}:{},...s}},r})}const Ib=()=>{const t=Nn("LANGCHAIN_TRACING_SAMPLING_RATE");if(t===void 0)return;const e=parseFloat(t);if(e<0||e>1)throw new Error(`LANGCHAIN_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},Fh=t=>{const n=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return n==="localhost"||n==="127.0.0.1"||n==="::1"},Xt=async(t,e)=>{const n=await t.text();if(!t.ok)throw new Error(`Failed to ${e}: ${t.status} ${t.statusText} ${n}`)};async function Rb(t){const e=[];for await(const n of t)e.push(n);return e}function vl(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}function ne(t){if(!pb(t))throw new Error(`Invalid UUID: ${t}`)}class td{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sampledPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"batchEndpointSupported",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pendingAutoBatchedRuns",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pendingAutoBatchedRunLimit",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50});const n=td.getDefaultClientConfig();this.tracingSampleRate=Ib(),this.apiUrl=vl(e.apiUrl??n.apiUrl)??"",this.apiKey=vl(e.apiKey??n.apiKey),this.webUrl=vl(e.webUrl??n.webUrl),this.validateApiKeyIfHosted(),this.timeout_ms=e.timeout_ms??12e3,this.caller=new bb(e.callerOptions??{}),this.hideInputs=e.hideInputs??n.hideInputs,this.hideOutputs=e.hideOutputs??n.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.pendingAutoBatchedRunLimit=e.pendingAutoBatchedRunLimit??this.pendingAutoBatchedRunLimit}static getDefaultClientConfig(){const e=Nn("LANGCHAIN_API_KEY"),n=Nn("LANGCHAIN_ENDPOINT")??"https://api.smith.langchain.com",r=Nn("LANGCHAIN_HIDE_INPUTS")==="true",i=Nn("LANGCHAIN_HIDE_OUTPUTS")==="true";return{apiUrl:n,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:i}}validateApiKeyIfHosted(){if(!Fh(this.apiUrl)&&!this.apiKey)throw new Error("API key must be provided when using hosted LangSmith API")}getHostUrl(){return this.webUrl?this.webUrl:Fh(this.apiUrl)?(this.webUrl="http://localhost","http://localhost"):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com","https://dev.smith.langchain.com"):(this.webUrl="https://smith.langchain.com","https://smith.langchain.com")}get headers(){const e={"User-Agent":`langsmith-js/${mg}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs?{}:e}processOutputs(e){return this.hideOutputs?{}:e}prepareRunCreateOrUpdateInputs(e){const n={...e};return n.inputs!==void 0&&(n.inputs=this.processInputs(n.inputs)),n.outputs!==void 0&&(n.outputs=this.processOutputs(n.outputs)),n}async _getResponse(e,n){const r=(n==null?void 0:n.toString())??"",i=`${this.apiUrl}${e}?${r}`,s=await this.caller.call(fetch,i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok)throw new Error(`Failed to fetch ${e}: ${s.status} ${s.statusText}`);return s}async _get(e,n){return(await this._getResponse(e,n)).json()}async*_getPaginated(e,n=new URLSearchParams){let r=Number(n.get("offset"))||0;const i=Number(n.get("limit"))||100;for(;;){n.set("offset",String(r)),n.set("limit",String(i));const s=`${this.apiUrl}${e}?${n}`,a=await this.caller.call(fetch,s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!a.ok)throw new Error(`Failed to fetch ${e}: ${a.status} ${a.statusText}`);const o=await a.json();if(o.length===0||(yield o,o.length<i))break;r+=o.length}}async*_getCursorPaginatedList(e,n=null,r="POST",i="runs"){const s=n?{...n}:{};for(;;){const o=await(await this.caller.call(fetch,`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),body:JSON.stringify(s)})).json();if(!o||!o[i])break;yield o[i];const l=o.cursors;if(!l||!l.next)break;s.cursor=l.next}}_filterForSampling(e,n=!1){if(this.tracingSampleRate===void 0)return e;if(n){const r=[];for(const i of e)this.sampledPostUuids.has(i.id)&&(r.push(i),this.sampledPostUuids.delete(i.id));return r}else{const r=[];for(const i of e)Math.random()<this.tracingSampleRate&&(r.push(i),this.sampledPostUuids.add(i.id));return r}}async triggerAutoBatchSend(e){let n=e;n===void 0&&(n=this.pendingAutoBatchedRuns.slice(0,this.pendingAutoBatchedRunLimit),this.pendingAutoBatchedRuns=this.pendingAutoBatchedRuns.slice(this.pendingAutoBatchedRunLimit)),await this.batchIngestRuns({runCreates:n.filter(r=>r.action==="create").map(r=>r.item),runUpdates:n.filter(r=>r.action==="update").map(r=>r.item)})}appendRunCreateToAutoBatchQueue(e){const n=this.autoBatchTimeout;for(clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,this.pendingAutoBatchedRuns.push(e);this.pendingAutoBatchedRuns.length>=this.pendingAutoBatchedRunLimit;){const r=this.pendingAutoBatchedRuns.slice(0,this.pendingAutoBatchedRunLimit);this.pendingAutoBatchedRuns=this.pendingAutoBatchedRuns.slice(this.pendingAutoBatchedRunLimit),this.triggerAutoBatchSend(r)}this.pendingAutoBatchedRuns.length>0&&(n?this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.triggerAutoBatchSend()},this.autoBatchAggregationDelayMs):this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.triggerAutoBatchSend()},this.autoBatchInitialDelayMs))}async batchEndpointIsSupported(){const e=await fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms)});return e.ok?!0:(await e.text(),!1)}async createRun(e){if(!this._filterForSampling([e]).length)return;const n={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const i=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&i.trace_id!==void 0&&i.dotted_order!==void 0){this.appendRunCreateToAutoBatchQueue({action:"create",item:i});return}const s=await Bh([i]),a=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:n,body:JSON.stringify(s[0]),signal:AbortSignal.timeout(this.timeout_ms)});await Xt(a,"create run")}async batchIngestRuns({runCreates:e,runUpdates:n}){if(e===void 0&&n===void 0)return;let r=(e==null?void 0:e.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[],i=(n==null?void 0:n.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[];if(r.length>0&&i.length>0){const l=r.reduce((c,d)=>(d.id&&(c[d.id]=d),c),{}),u=[];for(const c of i)c.id!==void 0&&l[c.id]?l[c.id]={...l[c.id],...c}:u.push(c);r=Object.values(l),i=u}const s={post:this._filterForSampling(r),patch:this._filterForSampling(i,!0)};if(!s.post.length&&!s.patch.length)return;if(r=await Bh(r),this.batchEndpointSupported===void 0&&(this.batchEndpointSupported=await this.batchEndpointIsSupported()),!this.batchEndpointSupported){this.autoBatchTracing=!1;for(const l of s.post)await this.createRun(l);for(const l of s.patch)l.id!==void 0&&await this.updateRun(l.id,l);return}const a={...this.headers,"Content-Type":"application/json",Accept:"application/json"},o=await this.caller.call(fetch,`${this.apiUrl}/runs/batch`,{method:"POST",headers:a,body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)});await Xt(o,"batch create run")}async updateRun(e,n){ne(e),n.inputs&&(n.inputs=this.processInputs(n.inputs)),n.outputs&&(n.outputs=this.processOutputs(n.outputs));const r={...n,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){this.appendRunCreateToAutoBatchQueue({action:"update",item:r});return}const i={...this.headers,"Content-Type":"application/json"},s=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:i,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms)});await Xt(s,"update run")}async readRun(e,{loadChildRuns:n}={loadChildRuns:!1}){ne(e);let r=await this._get(`/runs/${e}`);return n&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:n,projectOpts:r}){if(n!==void 0){let i;n.session_id?i=n.session_id:r!=null&&r.projectName?i=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?i=r==null?void 0:r.projectId:i=(await this.readProject({projectName:Nn("LANGCHAIN_PROJECT")||"default"})).id;const s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${i}/r/${n.id}?poll=true`}else if(e!==void 0){const i=await this.readRun(e);if(!i.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${i.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const n=await Rb(this.listRuns({id:e.child_run_ids})),r={},i={};n.sort((s,a)=>((s==null?void 0:s.dotted_order)??"").localeCompare((a==null?void 0:a.dotted_order)??""));for(const s of n){if(s.parent_run_id===null||s.parent_run_id===void 0)throw new Error(`Child run ${s.id} has no parent`);s.parent_run_id in r||(r[s.parent_run_id]=[]),r[s.parent_run_id].push(s),i[s.id]=s}e.child_runs=r[e.id]||[];for(const s in r)s!==e.id&&(i[s].child_runs=r[s]);return e}async*listRuns({projectId:e,projectName:n,parentRunId:r,traceId:i,referenceExampleId:s,startTime:a,executionOrder:o,runType:l,error:u,id:c,query:d,filter:h,limit:p}){let y=[];if(e&&(y=Array.isArray(e)?e:[e]),n){const _=Array.isArray(n)?n:[n],g=await Promise.all(_.map(f=>this.readProject({projectName:f}).then(m=>m.id)));y.push(...g)}const v={session:y.length?y:null,run_type:l,reference_example:s,query:d,filter:h,execution_order:o,parent_run:r?[r]:null,start_time:a?a.toISOString():null,error:u,id:c,limit:p,trace:i};for await(const _ of this._getCursorPaginatedList("/runs/query",v))yield*_}async shareRun(e,{shareId:n}={}){const r={run_id:e,share_token:n||Nt()};ne(e);const s=await(await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)})).json();if(s===null||!("share_token"in s))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${s.share_token}/r`}async unshareRun(e){ne(e);const n=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await Xt(n,"unshare run")}async readRunSharedLink(e){ne(e);const r=await(await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:n}={}){const r=new URLSearchParams({share_token:e});if(n!==void 0)for(const a of n)r.append("id",a);return ne(e),await(await this.caller.call(fetch,`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)})).json()}async readDatasetSharedSchema(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id),ne(e);const i=await(await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async shareDataset(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id);const r={dataset_id:e};ne(e);const s=await(await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async unshareDataset(e){ne(e);const n=await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await Xt(n,"unshare dataset")}async readSharedDataset(e){return ne(e),await(await this.caller.call(fetch,`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)})).json()}async createProject({projectName:e,description:n=null,metadata:r=null,upsert:i=!1,projectExtra:s=null,referenceDatasetId:a=null}){const o=i?"?upsert=true":"",l=`${this.apiUrl}/sessions${o}`,u=s||{};r&&(u.metadata=r);const c={name:e,extra:u,description:n};a!==null&&(c.reference_dataset_id=a);const d=await this.caller.call(fetch,l,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms)}),h=await d.json();if(!d.ok)throw new Error(`Failed to create session ${e}: ${d.status} ${d.statusText}`);return h}async updateProject(e,{name:n=null,description:r=null,metadata:i=null,projectExtra:s=null,endTime:a=null}){const o=`${this.apiUrl}/sessions/${e}`;let l=s;i&&(l={...l||{},metadata:i});const u={name:n,extra:l,description:r,end_time:a?new Date(a).toISOString():null},c=await this.caller.call(fetch,o,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)}),d=await c.json();if(!c.ok)throw new Error(`Failed to update project ${e}: ${c.status} ${c.statusText}`);return d}async hasProject({projectId:e,projectName:n}){let r="/sessions";const i=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)ne(e),r+=`/${e}`;else if(n!==void 0)i.append("name",n);else throw new Error("Must provide projectName or projectId");const s=await this.caller.call(fetch,`${this.apiUrl}${r}?${i}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});try{const a=await s.json();return s.ok?Array.isArray(a)?a.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:n,includeStats:r}){let i="/sessions";const s=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)ne(e),i+=`/${e}`;else if(n!==void 0)s.append("name",n);else throw new Error("Must provide projectName or projectId");r!==void 0&&s.append("include_stats",r.toString());const a=await this._get(i,s);let o;if(Array.isArray(a)){if(a.length===0)throw new Error(`Project[id=${e}, name=${n}] not found`);o=a[0]}else o=a;return o}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const n of this._getPaginated("/sessions",e))return this._tenantId=n[0].tenant_id,n[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:n,nameContains:r,referenceDatasetId:i,referenceDatasetName:s,referenceFree:a}={}){const o=new URLSearchParams;if(e!==void 0)for(const l of e)o.append("id",l);if(n!==void 0&&o.append("name",n),r!==void 0&&o.append("name_contains",r),i!==void 0)o.append("reference_dataset",i);else if(s!==void 0){const l=await this.readDataset({datasetName:s});o.append("reference_dataset",l.id)}a!==void 0&&o.append("reference_free",a.toString());for await(const l of this._getPaginated("/sessions",o))yield*l}async deleteProject({projectId:e,projectName:n}){let r;if(e===void 0&&n===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:n})).id:r=e,ne(r);const i=await this.caller.call(fetch,`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await Xt(i,`delete session ${r} (${n})`)}async uploadCsv({csvFile:e,fileName:n,inputKeys:r,outputKeys:i,description:s,dataType:a,name:o}){const l=`${this.apiUrl}/datasets/upload`,u=new FormData;u.append("file",e,n),r.forEach(h=>{u.append("input_keys",h)}),i.forEach(h=>{u.append("output_keys",h)}),s&&u.append("description",s),a&&u.append("data_type",a),o&&u.append("name",o);const c=await this.caller.call(fetch,l,{method:"POST",headers:this.headers,body:u,signal:AbortSignal.timeout(this.timeout_ms)});if(!c.ok){const h=await c.json();throw h.detail&&h.detail.includes("already exists")?new Error(`Dataset ${n} already exists`):new Error(`Failed to upload CSV: ${c.status} ${c.statusText}`)}return await c.json()}async createDataset(e,{description:n,dataType:r}={}){const i={name:e,description:n};r&&(i.data_type=r);const s=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok){const o=await s.json();throw o.detail&&o.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${s.status} ${s.statusText}`)}return await s.json()}async readDataset({datasetId:e,datasetName:n}){let r="/datasets";const i=new URLSearchParams({limit:"1"});if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)ne(e),r+=`/${e}`;else if(n!==void 0)i.append("name",n);else throw new Error("Must provide datasetName or datasetId");const s=await this._get(r,i);let a;if(Array.isArray(s)){if(s.length===0)throw new Error(`Dataset[id=${e}, name=${n}] not found`);a=s[0]}else a=s;return a}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:n}){const r="/datasets";if(e===void 0)if(n!==void 0)e=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(o=>JSON.parse(o))}async*listDatasets({limit:e=100,offset:n=0,datasetIds:r,datasetName:i,datasetNameContains:s}={}){const a="/datasets",o=new URLSearchParams({limit:e.toString(),offset:n.toString()});if(r!==void 0)for(const l of r)o.append("id",l);i!==void 0&&o.append("name",i),s!==void 0&&o.append("name_contains",s);for await(const l of this._getPaginated(a,o))yield*l}async deleteDataset({datasetId:e,datasetName:n}){let r="/datasets",i=e;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(n!==void 0&&(i=(await this.readDataset({datasetName:n})).id),i!==void 0)ne(i),r+=`/${i}`;else throw new Error("Must provide datasetName or datasetId");const s=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok)throw new Error(`Failed to delete ${r}: ${s.status} ${s.statusText}`);await s.json()}async createExample(e,n,{datasetId:r,datasetName:i,createdAt:s,exampleId:a}){let o=r;if(o===void 0&&i===void 0)throw new Error("Must provide either datasetName or datasetId");if(o!==void 0&&i!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");o===void 0&&(o=(await this.readDataset({datasetName:i})).id);const l=s||new Date,u={dataset_id:o,inputs:e,outputs:n,created_at:l==null?void 0:l.toISOString(),id:a},c=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)});if(!c.ok)throw new Error(`Failed to create example: ${c.status} ${c.statusText}`);return await c.json()}async createExamples(e){const{inputs:n,outputs:r,sourceRunIds:i,exampleIds:s,datasetId:a,datasetName:o}=e;let l=a;if(l===void 0&&o===void 0)throw new Error("Must provide either datasetName or datasetId");if(l!==void 0&&o!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");l===void 0&&(l=(await this.readDataset({datasetName:o})).id);const u=n.map((h,p)=>({dataset_id:l,inputs:h,outputs:r?r[p]:void 0,id:s?s[p]:void 0,source_run_id:i?i[p]:void 0})),c=await this.caller.call(fetch,`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)});if(!c.ok)throw new Error(`Failed to create examples: ${c.status} ${c.statusText}`);return await c.json()}async createLLMExample(e,n,r){return this.createExample({input:e},{output:n},r)}async createChatExample(e,n,r){const i=e.map(a=>zh(a)?Mh(a):a),s=zh(n)?Mh(n):n;return this.createExample({input:i},{output:s},r)}async readExample(e){ne(e);const n=`/examples/${e}`;return await this._get(n)}async*listExamples({datasetId:e,datasetName:n,exampleIds:r}={}){let i;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)i=e;else if(n!==void 0)i=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide a datasetName or datasetId");const s=new URLSearchParams({dataset:i});if(r!==void 0)for(const a of r)s.append("id",a);for await(const a of this._getPaginated("/examples",s))yield*a}async deleteExample(e){ne(e);const n=`/examples/${e}`,r=await this.caller.call(fetch,this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${n}: ${r.status} ${r.statusText}`);await r.json()}async updateExample(e,n){ne(e);const r=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to update example ${e}: ${r.status} ${r.statusText}`);return await r.json()}async evaluateRun(e,n,{sourceInfo:r,loadChildRuns:i,referenceExample:s}={loadChildRuns:!1}){let a;if(typeof e=="string")a=await this.readRun(e,{loadChildRuns:i});else if(typeof e=="object"&&"id"in e)a=e;else throw new Error(`Invalid run type: ${typeof e}`);a.reference_example_id!==null&&a.reference_example_id!==void 0&&(s=await this.readExample(a.reference_example_id));const o=await n.evaluateRun(a,s);let l=r??{};o.evaluatorInfo&&(l={...l,...o.evaluatorInfo});const u=o.targetRunId??a.id;return await this.createFeedback(u,o.key,{score:o==null?void 0:o.score,value:o==null?void 0:o.value,comment:o==null?void 0:o.comment,correction:o==null?void 0:o.correction,sourceInfo:l,feedbackSourceType:"model",sourceRunId:o==null?void 0:o.sourceRunId})}async createFeedback(e,n,{score:r,value:i,correction:s,comment:a,sourceInfo:o,feedbackSourceType:l="api",sourceRunId:u,feedbackId:c,eager:d=!1}){var _;const h={type:l??"api",metadata:o??{}};u!==void 0&&(h==null?void 0:h.metadata)!==void 0&&!h.metadata.__run&&(h.metadata.__run={run_id:u}),(h==null?void 0:h.metadata)!==void 0&&((_=h.metadata.__run)==null?void 0:_.run_id)!==void 0&&ne(h.metadata.__run.run_id);const p={id:c??Nt(),run_id:e,key:n,score:r,value:i,correction:s,comment:a,feedback_source:h},y=`${this.apiUrl}/feedback`+(d?"/eager":""),v=await this.caller.call(fetch,y,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(p),signal:AbortSignal.timeout(this.timeout_ms)});return await Xt(v,"create feedback"),p}async updateFeedback(e,{score:n,value:r,correction:i,comment:s}){const a={};n!=null&&(a.score=n),r!=null&&(a.value=r),i!=null&&(a.correction=i),s!=null&&(a.comment=s),ne(e);const o=await this.caller.call(fetch,`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)});await Xt(o,"update feedback")}async readFeedback(e){ne(e);const n=`/feedback/${e}`;return await this._get(n)}async deleteFeedback(e){ne(e);const n=`/feedback/${e}`,r=await this.caller.call(fetch,this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${n}: ${r.status} ${r.statusText}`);await r.json()}async*listFeedback({runIds:e,feedbackKeys:n,feedbackSourceTypes:r}={}){const i=new URLSearchParams;if(e&&i.append("run",e.join(",")),n)for(const s of n)i.append("key",s);if(r)for(const s of r)i.append("source",s);for await(const s of this._getPaginated("/feedback",i))yield*s}}const mg="0.0.70";class jb extends ed{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:n,projectName:r,client:i}=e;this.projectName=r??Y("LANGCHAIN_PROJECT")??Y("LANGCHAIN_SESSION"),this.exampleId=n,this.client=i??new td({})}async _convertToCreate(e,n=void 0){return{...e,extra:{...e.extra,runtime:await lb()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:n}}async persistRun(e){}async _persistRunSingle(e){const n=await this._convertToCreate(e,this.exampleId);await this.client.createRun(n)}async _updateRunSingle(e){const n={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs};await this.client.updateRun(e.id,n)}async onRetrieverStart(e){await this._persistRunSingle(e)}async onRetrieverEnd(e){await this._updateRunSingle(e)}async onRetrieverError(e){await this._updateRunSingle(e)}async onLLMStart(e){await this._persistRunSingle(e)}async onLLMEnd(e){await this._updateRunSingle(e)}async onLLMError(e){await this._updateRunSingle(e)}async onChainStart(e){await this._persistRunSingle(e)}async onChainEnd(e){await this._updateRunSingle(e)}async onChainError(e){await this._updateRunSingle(e)}async onToolStart(e){await this._persistRunSingle(e)}async onToolEnd(e){await this._updateRunSingle(e)}async onToolError(e){await this._updateRunSingle(e)}}function gg(t,e="Human",n="AI"){const r=[];for(const i of t){let s;if(i._getType()==="human")s=e;else if(i._getType()==="ai")s=n;else if(i._getType()==="system")s="System";else if(i._getType()==="function")s="Function";else if(i._getType()==="generic")s=i.role;else throw new Error(`Got unsupported message type: ${i}`);const a=i.name?`${i.name}, `:"";r.push(`${s}: ${a}${i.content}`)}return r.join(`
`)}class $b extends ed{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:Y("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=Y("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const n={start_time:Date.now(),name:e},r=await this.persistSession(n);return this.session=r,r}async loadSession(e){const n=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(n)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){var s;const n=this.session??await this.loadDefaultSession(),r=e.serialized;let i;if(e.run_type==="llm"){const a=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(l=>gg(l));i={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:n.id,prompts:a,response:e.outputs}}else if(e.run_type==="chain"){const a=await Promise.all(e.child_runs.map(l=>this.convertV2RunToRun(l)));i={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:n.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:a.filter(l=>l.type==="llm"),child_chain_runs:a.filter(l=>l.type==="chain"),child_tool_runs:a.filter(l=>l.type==="tool")}}else if(e.run_type==="tool"){const a=await Promise.all(e.child_runs.map(l=>this.convertV2RunToRun(l)));i={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:n.id,tool_input:e.inputs.input,output:(s=e.outputs)==null?void 0:s.output,action:JSON.stringify(r),child_llm_runs:a.filter(l=>l.type==="llm"),child_chain_runs:a.filter(l=>l.type==="chain"),child_tool_runs:a.filter(l=>l.type==="tool")}}else throw new Error(`Unknown run type: ${e.run_type}`);return i}async persistRun(e){let n,r;e.run_type!==void 0?r=await this.convertV2RunToRun(e):r=e,r.type==="llm"?n=`${this.endpoint}/llm-runs`:r.type==="chain"?n=`${this.endpoint}/chain-runs`:n=`${this.endpoint}/tool-runs`;const i=await fetch(n,{method:"POST",headers:this.headers,body:JSON.stringify(r)});i.ok||console.error(`Failed to persist run: ${i.status} ${i.statusText}`)}async persistSession(e){const n=`${this.endpoint}/sessions`,r=await fetch(n,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return r.ok?{id:(await r.json()).id,...e}:(console.error(`Failed to persist session: ${r.status} ${r.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const n=await fetch(e,{method:"GET",headers:this.headers});let r;if(!n.ok)return console.error(`Failed to load session: ${n.status} ${n.statusText}`),r={id:1,start_time:Date.now()},this.session=r,r;const i=await n.json();return i.length===0?(r={id:1,start_time:Date.now()},this.session=r,r):([r]=i,this.session=r,r)}}async function Nb(t){const e=new $b;return t?await e.loadSession(t):await e.loadDefaultSession(),e}async function Lb(){return new jb}let _l;function Db(){const t="default"in Mt?Mt.default:Mt;return new t({autoStart:!0,concurrency:1})}async function ye(t,e){e===!0?await t():(typeof _l>"u"&&(_l=Db()),_l.add(t))}function Ub(t){return t?Array.isArray(t)||"name"in t?{callbacks:t}:t:{}}class zb{setHandler(e){return this.setHandlers([e])}}class Eo{constructor(e,n,r,i,s,a,o,l){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:l})}async handleText(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;try{await((r=n.handleText)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleText: ${i}`)}},n.awaitHandlers)))}}class Mb extends Eo{getChild(e){const n=new qe(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch{console.error(`Error in handler ${n.constructor.name}, handleRetriever`)}},n.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleRetrieverError: ${i}`)}},n.awaitHandlers)))}}class Vh extends Eo{async handleLLMNewToken(e,n,r,i,s,a){await Promise.all(this.handlers.map(o=>ye(async()=>{var l;if(!o.ignoreLLM)try{await((l=o.handleLLMNewToken)==null?void 0:l.call(o,e,n??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,a))}catch(u){console.error(`Error in handler ${o.constructor.name}, handleLLMNewToken: ${u}`)}},o.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreLLM)try{await((r=n.handleLLMError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleLLMError: ${i}`)}},n.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreLLM)try{await((r=n.handleLLMEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleLLMEnd: ${i}`)}},n.awaitHandlers)))}}class Bb extends Eo{getChild(e){const n=new qe(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleChainError(e,n,r,i,s){await Promise.all(this.handlers.map(a=>ye(async()=>{var o;if(!a.ignoreChain)try{await((o=a.handleChainError)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags,s))}catch(l){console.error(`Error in handler ${a.constructor.name}, handleChainError: ${l}`)}},a.awaitHandlers)))}async handleChainEnd(e,n,r,i,s){await Promise.all(this.handlers.map(a=>ye(async()=>{var o;if(!a.ignoreChain)try{await((o=a.handleChainEnd)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags,s))}catch(l){console.error(`Error in handler ${a.constructor.name}, handleChainEnd: ${l}`)}},a.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentAction)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleAgentAction: ${i}`)}},n.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleAgentEnd: ${i}`)}},n.awaitHandlers)))}}class Fb extends Eo{getChild(e){const n=new qe(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleToolError(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleToolError: ${i}`)}},n.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(n=>ye(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${n.constructor.name}, handleToolEnd: ${i}`)}},n.awaitHandlers)))}}class qe extends zb{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,n,r=void 0,i=void 0,s=void 0){return Promise.all(n.map(async a=>{const o=Nt();return await Promise.all(this.handlers.map(l=>ye(async()=>{var u;if(!l.ignoreLLM)try{await((u=l.handleLLMStart)==null?void 0:u.call(l,e,[a],o,this._parentRunId,s,this.tags,this.metadata))}catch(c){console.error(`Error in handler ${l.constructor.name}, handleLLMStart: ${c}`)}},l.awaitHandlers))),new Vh(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,n,r=void 0,i=void 0,s=void 0){return Promise.all(n.map(async a=>{const o=Nt();return await Promise.all(this.handlers.map(l=>ye(async()=>{var u,c;if(!l.ignoreLLM)try{if(l.handleChatModelStart)await((u=l.handleChatModelStart)==null?void 0:u.call(l,e,[a],o,this._parentRunId,s,this.tags,this.metadata));else if(l.handleLLMStart){const d=gg(a);await((c=l.handleLLMStart)==null?void 0:c.call(l,e,[d],o,this._parentRunId,s,this.tags,this.metadata))}}catch(d){console.error(`Error in handler ${l.constructor.name}, handleLLMStart: ${d}`)}},l.awaitHandlers))),new Vh(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,n,r=Nt(),i=void 0){return await Promise.all(this.handlers.map(s=>ye(async()=>{var a;if(!s.ignoreChain)try{await((a=s.handleChainStart)==null?void 0:a.call(s,e,n,r,this._parentRunId,this.tags,this.metadata,i))}catch(o){console.error(`Error in handler ${s.constructor.name}, handleChainStart: ${o}`)}},s.awaitHandlers))),new Bb(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,n,r=Nt()){return await Promise.all(this.handlers.map(i=>ye(async()=>{var s;if(!i.ignoreAgent)try{await((s=i.handleToolStart)==null?void 0:s.call(i,e,n,r,this._parentRunId,this.tags,this.metadata))}catch(a){console.error(`Error in handler ${i.constructor.name}, handleToolStart: ${a}`)}},i.awaitHandlers))),new Fb(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,n,r=Nt(),i=void 0){return await Promise.all(this.handlers.map(s=>ye(async()=>{var a;if(!s.ignoreRetriever)try{await((a=s.handleRetrieverStart)==null?void 0:a.call(s,e,n,r,this._parentRunId,this.tags,this.metadata))}catch(o){console.error(`Error in handler ${s.constructor.name}, handleRetrieverStart: ${o}`)}},s.awaitHandlers))),new Mb(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,n=!0){this.handlers.push(e),n&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(n=>n!==e),this.inheritableHandlers=this.inheritableHandlers.filter(n=>n!==e)}setHandlers(e,n=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,n)}addTags(e,n=!0){this.removeTags(e),this.tags.push(...e),n&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(n=>!e.includes(n)),this.inheritableTags=this.inheritableTags.filter(n=>!e.includes(n))}addMetadata(e,n=!0){this.metadata={...this.metadata,...e},n&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const n of Object.keys(e))delete this.metadata[n],delete this.inheritableMetadata[n]}copy(e=[],n=!0){const r=new qe(this._parentRunId);for(const i of this.handlers){const s=this.inheritableHandlers.includes(i);r.addHandler(i,s)}for(const i of this.tags){const s=this.inheritableTags.includes(i);r.addTags([i],s)}for(const i of Object.keys(this.metadata)){const s=Object.keys(this.inheritableMetadata).includes(i);r.addMetadata({[i]:this.metadata[i]},s)}for(const i of e)r.handlers.filter(s=>s.name==="console_callback_handler").some(s=>s.name===i.name)||r.addHandler(i,n);return r}static fromHandlers(e){class n extends ts{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Nt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new n),r}static async configure(e,n,r,i,s,a,o){let l;(e||n)&&(Array.isArray(e)||!e?(l=new qe,l.setHandlers((e==null?void 0:e.map(Hh))??[],!0)):l=e,l=l.copy(Array.isArray(n)?n.map(Hh):n==null?void 0:n.handlers,!1));const u=Y("LANGCHAIN_VERBOSE")||(o==null?void 0:o.verbose),c=Y("LANGCHAIN_TRACING_V2")==="true",d=c||(Y("LANGCHAIN_TRACING")??!1);if(u||d){if(l||(l=new qe),u&&!l.handlers.some(h=>h.name===Uh.prototype.name)){const h=new Uh;l.addHandler(h,!0)}if(d&&!l.handlers.some(h=>h.name==="langchain_tracer"))if(c)l.addHandler(await Lb(),!0);else{const h=Y("LANGCHAIN_PROJECT")&&Y("LANGCHAIN_SESSION");l.addHandler(await Nb(h),!0)}}return(r||i)&&l&&(l.addTags(r??[]),l.addTags(i??[],!1)),(s||a)&&l&&(l.addMetadata(s??{}),l.addMetadata(a??{},!1)),l}}function Hh(t){return"name"in t?t:ts.fromMethods(t)}class Ya extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done&&this.reader.releaseLock(),e}catch(e){throw this.reader.releaseLock(),e}}async return(){this.ensureReader();const e=this.reader.cancel();return this.reader.releaseLock(),await e,{done:!0,value:void 0}}[Symbol.asyncIterator](){return this}static fromReadableStream(e){const n=e.getReader();return new Ya({start(r){return i();function i(){return n.read().then(({done:s,value:a})=>{if(s){r.close();return}return r.enqueue(a),i()})}}})}static fromAsyncGenerator(e){return new Ya({async pull(n){const{value:r,done:i}=await e.next();i?n.close():r&&n.enqueue(r)}})}}async function Vn(t){return qe.configure(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata)}function xe(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}class ve extends bn{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}bind(e){return new ns({bound:this,kwargs:e})}map(){return new nd({bound:this})}withRetry(e){return new Vb({bound:this,kwargs:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withFallbacks(e){return new Zb({runnable:this,fallbacks:e.fallbacks})}_getOptionsList(e,n=0){if(Array.isArray(e)){if(e.length!==n)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${n} inputs`);return e}return Array.from({length:n},()=>e)}async batch(e,n,r){const i=this._getOptionsList(n??{},e.length),s=new ko({maxConcurrency:r==null?void 0:r.maxConcurrency,onFailedAttempt:o=>{throw o}}),a=e.map((o,l)=>s.call(async()=>{try{return await this.invoke(o,i[l])}catch(u){if(r!=null&&r.returnExceptions)return u;throw u}}));return Promise.all(a)}async*_streamIterator(e,n){yield this.invoke(e,n)}async stream(e,n){return Ya.fromAsyncGenerator(this._streamIterator(e,n))}_separateRunnableConfigFromCallOptions(e={}){const n={callbacks:e.callbacks,tags:e.tags,metadata:e.metadata},r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,[n,r]}async _callWithConfig(e,n,r){const i=await Vn(r),s=await(i==null?void 0:i.handleChainStart(this.toJSON(),xe(n,"input"),void 0,r==null?void 0:r.runType));let a;try{a=await e.bind(this)(n,r,s)}catch(o){throw await(s==null?void 0:s.handleChainError(o)),o}return await(s==null?void 0:s.handleChainEnd(xe(a,"output"))),a}async _batchWithConfig(e,n,r,i){const s=this._getOptionsList(r??{},n.length),a=await Promise.all(s.map(Vn)),o=await Promise.all(a.map((u,c)=>u==null?void 0:u.handleChainStart(this.toJSON(),xe(n[c],"input"))));let l;try{l=await e(n,s,o,i)}catch(u){throw await Promise.all(o.map(c=>c==null?void 0:c.handleChainError(u))),u}return await Promise.all(o.map(u=>u==null?void 0:u.handleChainEnd(xe(l,"output")))),l}async*_transformStreamWithConfig(e,n,r){let i,s=!0,a,o=!0;const l=await Vn(r);let u;const c=this.toJSON();async function*d(){for await(const p of e){if(u||(u=await(l==null?void 0:l.handleChainStart(c,{input:""},void 0,r==null?void 0:r.runType))),s)if(i===void 0)i=p;else try{i=i.concat(p)}catch{i=void 0,s=!1}yield p}}const h=d();try{const p=n(h,u,r);for await(const y of p)if(yield y,o)if(a===void 0)a=y;else try{a=a.concat(y)}catch{a=void 0,o=!1}}catch(p){throw await(u==null?void 0:u.handleChainError(p,void 0,void 0,void 0,{inputs:xe(i,"input")})),p}await(u==null?void 0:u.handleChainEnd(a??{},void 0,void 0,void 0,{inputs:xe(i,"input")}))}_patchConfig(e={},n=void 0){return{...e,callbacks:n}}pipe(e){return new un({first:this,last:Mn(e)})}async*transform(e,n){let r;for await(const i of e)r?r=r.concat(i):r=i;yield*this._streamIterator(r,n)}static isRunnable(e){return e.lc_runnable}}class ns extends ve{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs}bind(e){return new ns({bound:this.bound,kwargs:{...this.kwargs,...e}})}async invoke(e,n){return this.bound.invoke(e,{...n,...this.kwargs})}async batch(e,n,r){const i=Array.isArray(n)?n.map(s=>({...s,...this.kwargs})):{...n,...this.kwargs};return this.bound.batch(e,i,r)}async*_streamIterator(e,n){yield*this.bound._streamIterator(e,{...n,...this.kwargs})}async stream(e,n){return this.bound.stream(e,{...n,...this.kwargs})}async*transform(e,n){yield*this.bound.transform(e,n)}static isRunnableBinding(e){return e.bound&&ve.isRunnable(e.bound)}}class nd extends ve{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new nd({bound:this.bound.bind(e)})}async invoke(e,n){return this._callWithConfig(this._invoke,e,n)}async _invoke(e,n,r){return this.bound.batch(e,this._patchConfig(n,r==null?void 0:r.getChild()))}}class Vb extends ns{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,n,r){const i=e>1?`retry:attempt:${e}`:void 0;return this._patchConfig(n,r==null?void 0:r.getChild(i))}async _invoke(e,n,r){return Ra(i=>super.invoke(e,this._patchConfigForRetry(i,n,r)),{onFailedAttempt:this.onFailedAttempt,retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,n){return this._callWithConfig(this._invoke,e,n)}async _batch(e,n,r,i){const s={};try{await Ra(async a=>{const o=e.map((h,p)=>p).filter(h=>s[h.toString()]===void 0||s[h.toString()]instanceof Error),l=o.map(h=>e[h]),u=o.map(h=>this._patchConfigForRetry(a,n==null?void 0:n[h],r==null?void 0:r[h])),c=await super.batch(l,u,{...i,returnExceptions:!0});let d;for(let h=0;h<c.length;h+=1){const p=c[h],y=o[h];p instanceof Error&&d===void 0&&(d=p),s[y.toString()]=p}if(d)throw d;return c},{onFailedAttempt:this.onFailedAttempt,retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(a){if((i==null?void 0:i.returnExceptions)!==!0)throw a}return Object.keys(s).sort((a,o)=>parseInt(a,10)-parseInt(o,10)).map(a=>s[parseInt(a,10)])}async batch(e,n,r){return this._batchWithConfig(this._batch.bind(this),e,n,r)}}class un extends ve{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,n){const r=await Vn(n),i=await(r==null?void 0:r.handleChainStart(this.toJSON(),xe(e,"input")));let s=e,a;try{const o=[this.first,...this.middle];for(let l=0;l<o.length;l+=1)s=await o[l].invoke(s,this._patchConfig(n,i==null?void 0:i.getChild(`seq:step:${l+1}`)));a=await this.last.invoke(s,this._patchConfig(n,i==null?void 0:i.getChild(`seq:step:${this.steps.length}`)))}catch(o){throw await(i==null?void 0:i.handleChainError(o)),o}return await(i==null?void 0:i.handleChainEnd(xe(a,"output"))),a}async batch(e,n,r){const i=this._getOptionsList(n??{},e.length),s=await Promise.all(i.map(Vn)),a=await Promise.all(s.map((u,c)=>u==null?void 0:u.handleChainStart(this.toJSON(),xe(e[c],"input"))));let o=e,l;try{const u=[this.first,...this.middle];for(let c=0;c<u.length;c+=1)o=await u[c].batch(o,a.map((h,p)=>this._patchConfig(i[p],h==null?void 0:h.getChild(`seq:step:${c+1}`))),r);l=await this.last.batch(o,a.map(c=>this._patchConfig(i[this.steps.length-1],c==null?void 0:c.getChild(`seq:step:${this.steps.length}`))),r)}catch(u){throw await Promise.all(a.map(c=>c==null?void 0:c.handleChainError(u))),u}return await Promise.all(a.map((u,c)=>u==null?void 0:u.handleChainEnd(xe(l[c],"output")))),l}async*_streamIterator(e,n){const r=await Vn(n),i=await(r==null?void 0:r.handleChainStart(this.toJSON(),xe(e,"input")));let s=e;const a=[this.first,...this.middle,this.last],o=Math.min(a.length-1,a.length-[...a].reverse().findIndex(c=>{var p;const d=c.transform===ve.prototype.transform,h=ns.isRunnableBinding(c)&&((p=c.bound)==null?void 0:p.transform)===ve.prototype.transform;return d||h})-1);try{const c=a.slice(0,o);for(let d=0;d<c.length;d+=1)s=await c[d].invoke(s,this._patchConfig(n,i==null?void 0:i.getChild(`seq:step:${d+1}`)))}catch(c){throw await(i==null?void 0:i.handleChainError(c)),c}let l=!0,u;try{let c=await a[o]._streamIterator(s,this._patchConfig(n,i==null?void 0:i.getChild(`seq:step:${o+1}`)));const d=a.slice(o+1);for(let h=0;h<d.length;h+=1)c=await d[h].transform(c,this._patchConfig(n,i==null?void 0:i.getChild(`seq:step:${o+h+2}`)));for await(const h of c)if(yield h,l)if(u===void 0)u=h;else try{u=u.concat(h)}catch{u=void 0,l=!1}}catch(c){throw await(i==null?void 0:i.handleChainError(c)),c}await(i==null?void 0:i.handleChainEnd(xe(u,"output")))}pipe(e){return un.isRunnableSequence(e)?new un({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last}):new un({first:this.first,middle:[...this.middle,this.last],last:Mn(e)})}static isRunnableSequence(e){return Array.isArray(e.middle)&&ve.isRunnable(e)}static from([e,...n]){return new un({first:Mn(e),middle:n.slice(0,-1).map(Mn),last:Mn(n[n.length-1])})}}class Hb extends ve{static lc_name(){return"RunnableMap"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[n,r]of Object.entries(e.steps))this.steps[n]=Mn(r)}async invoke(e,n){const r=await Vn(n),i=await(r==null?void 0:r.handleChainStart(this.toJSON(),{input:e})),s={};try{for(const[a,o]of Object.entries(this.steps)){const l=await o.invoke(e,this._patchConfig(n,i==null?void 0:i.getChild()));s[a]=l}}catch(a){throw await(i==null?void 0:i.handleChainError(a)),a}return await(i==null?void 0:i.handleChainEnd(s)),s}}class qb extends ve{static lc_name(){return"RunnableLambda"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.func=e.func}async _invoke(e,n,r){let i=await this.func(e);return i&&ve.isRunnable(i)&&(i=await i.invoke(e,this._patchConfig(n,r==null?void 0:r.getChild()))),i}async invoke(e,n){return this._callWithConfig(this._invoke,e,n)}}class Zb extends ve{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,n){const r=await qe.configure(n==null?void 0:n.callbacks,void 0,n==null?void 0:n.tags,void 0,n==null?void 0:n.metadata),i=await(r==null?void 0:r.handleChainStart(this.toJSON(),xe(e,"input")));let s;for(const a of this.runnables())try{const o=await a.invoke(e,this._patchConfig(n,i==null?void 0:i.getChild()));return await(i==null?void 0:i.handleChainEnd(xe(o,"output"))),o}catch(o){s===void 0&&(s=o)}throw s===void 0?new Error("No error stored at end of fallback."):(await(i==null?void 0:i.handleChainError(s)),s)}async batch(e,n,r){if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const i=this._getOptionsList(n??{},e.length),s=await Promise.all(i.map(l=>qe.configure(l==null?void 0:l.callbacks,void 0,l==null?void 0:l.tags,void 0,l==null?void 0:l.metadata))),a=await Promise.all(s.map((l,u)=>l==null?void 0:l.handleChainStart(this.toJSON(),xe(e[u],"input"))));let o;for(const l of this.runnables())try{const u=await l.batch(e,a.map((c,d)=>this._patchConfig(i[d],c==null?void 0:c.getChild())),r);return await Promise.all(a.map((c,d)=>c==null?void 0:c.handleChainEnd(xe(u[d],"output")))),u}catch(u){o===void 0&&(o=u)}throw o?(await Promise.all(a.map(l=>l==null?void 0:l.handleChainError(o))),o):new Error("No error stored at end of fallbacks.")}}function Mn(t){if(typeof t=="function")return new qb({func:t});if(ve.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[n,r]of Object.entries(t))e[n]=Mn(r);return new Hb({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class Kb extends ve{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"RunnablePassthrough"}async invoke(e,n){return this._callWithConfig(r=>Promise.resolve(r),e,n)}}class yg extends tg{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","base"]}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new Fi(this.value)]}}class Wb extends ve{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=e;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const n=this.partialVariables??{},r={};for(const[s,a]of Object.entries(n))typeof a=="string"?r[s]=a:r[s]=await a();return{...r,...e}}async invoke(e,n){return this._callWithConfig(r=>this.formatPromptValue(r),e,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:n}=await Ct(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>qh);return{PromptTemplate:r}},void 0);return n.deserialize(e)}case void 0:{const{PromptTemplate:n}=await Ct(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>qh);return{PromptTemplate:r}},void 0);return n.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await Ct(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-FbvAxd2r.js");return{FewShotPromptTemplate:r}},[]);return n.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Gb extends Wb{async formatPromptValue(e){const n=await this.format(e);return new yg(n)}}const vg=t=>{const e=t.split(""),n=[],r=(s,a)=>{for(let o=a;o<e.length;o+=1)if(s.includes(e[o]))return o;return-1};let i=0;for(;i<e.length;)if(e[i]==="{"&&i+1<e.length&&e[i+1]==="{")n.push({type:"literal",text:"{"}),i+=2;else if(e[i]==="}"&&i+1<e.length&&e[i+1]==="}")n.push({type:"literal",text:"}"}),i+=2;else if(e[i]==="{"){const s=r("}",i);if(s<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:e.slice(i+1,s).join("")}),i=s+1}else{if(e[i]==="}")throw new Error("Single '}' in template.");{const s=r("{}",i),a=(s<0?e.slice(i):e.slice(i,s)).join("");n.push({type:"literal",text:a}),i=s<0?e.length:s}}return n},Jb=(t,e)=>vg(t).reduce((n,r)=>{if(r.type==="variable"){if(r.name in e)return n+e[r.name];throw new Error(`Missing value for input ${r.name}`)}return n+r.text},""),Du={"f-string":Jb,jinja2:(t,e)=>""},Qb={"f-string":vg,jinja2:t=>[]},_g=(t,e,n)=>Du[e](t,n),Xb=(t,e)=>Qb[e](t),Yb=(t,e,n)=>{if(!(e in Du)){const r=Object.keys(Du);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${r}`)}try{const r=n.reduce((i,s)=>(i[s]="foo",i),{});_g(t,e,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}};class cn extends Gb{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){let n=this.inputVariables;this.partialVariables&&(n=n.concat(Object.keys(this.partialVariables))),Yb(this.template,this.templateFormat,n)}}_getPromptType(){return"prompt"}async format(e){const n=await this.mergePartialAndUserVariables(e);return _g(this.template,this.templateFormat,n)}static fromExamples(e,n,r,i=`

`,s=""){const a=[s,...e,n].join(i);return new cn({inputVariables:r,template:a})}static fromTemplate(e,{templateFormat:n="f-string",...r}={}){if(n==="jinja2")throw new Error("jinja2 templates are not currently supported.");const i=new Set;return Xb(e,n).forEach(s=>{s.type==="variable"&&i.add(s.name)}),new cn({inputVariables:[...i],templateFormat:n,template:e,...r})}async partial(e){const n=this.inputVariables.filter(s=>!(s in e)),r={...this.partialVariables??{},...e},i={...this,inputVariables:n,partialVariables:r};return new cn(i)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new cn({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const qh=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:cn},Symbol.toStringTag,{value:"Module"}));class ek extends tg{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return JSON.stringify(this.messages)}toChatMessages(){return this.messages}}const tk=()=>!1;class nk extends ve{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??tk(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class rk extends nk{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:n,...r}){super({callbacks:e??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new ko(r??{})}async getNumTokens(e){let n=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await zw("modelName"in this?Pu(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return this._encoding&&(n=this._encoding.encode(e).length),n}static _convertInputToPromptValue(e){return typeof e=="string"?new yg(e):Array.isArray(e)?new ek(e.map(Tu)):e}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){const{_type:n,_model:r,...i}=e;if(r&&r!=="base_chat_model")throw new Error(`Cannot load LLM with model ${r}`);const s={openai:(await Ct(async()=>{const{ChatOpenAI:a}=await Promise.resolve().then(()=>ok);return{ChatOpenAI:a}},void 0)).ChatOpenAI}[n];if(s===void 0)throw new Error(`Cannot load LLM with type ${n}`);return new s(i)}}class bi extends rk{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptions(e){const[n,r]=super._separateRunnableConfigFromCallOptions(e);return r!=null&&r.timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout)),[n,r]}async invoke(e,n){const r=bi._convertInputToPromptValue(e);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,n,r){throw new Error("Not implemented.")}async*_streamIterator(e,n){if(this._streamResponseChunks===bi.prototype._streamResponseChunks)yield this.invoke(e,n);else{const i=bi._convertInputToPromptValue(e).toChatMessages(),[s,a]=this._separateRunnableConfigFromCallOptions(n),o=await qe.configure(s.callbacks,this.callbacks,s.tags,this.tags,s.metadata,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a)},u=await(o==null?void 0:o.handleChatModelStart(this.toJSON(),[i],void 0,void 0,l));let c;try{for await(const d of this._streamResponseChunks(i,a,u==null?void 0:u[0]))yield d.message,c?c=c.concat(d):c=d}catch(d){throw await Promise.all((u??[]).map(h=>h==null?void 0:h.handleLLMError(d))),d}await Promise.all((u??[]).map(d=>d==null?void 0:d.handleLLMEnd({generations:[[c]]})))}}async generate(e,n,r){var v;let i;Array.isArray(n)?i={stop:n}:i=n;const s=e.map(_=>_.map(Tu)),[a,o]=this._separateRunnableConfigFromCallOptions(i),l=await qe.configure(a.callbacks??r,this.callbacks,a.tags,this.tags,a.metadata,this.metadata,{verbose:this.verbose}),u={options:o,invocation_params:this==null?void 0:this.invocationParams(i)},c=await(l==null?void 0:l.handleChatModelStart(this.toJSON(),s,void 0,void 0,u)),d=await Promise.allSettled(s.map((_,g)=>this._generate(_,{...o,promptIndex:g},c==null?void 0:c[g]))),h=[],p=[];await Promise.all(d.map(async(_,g)=>{var f,m;if(_.status==="fulfilled"){const w=_.value;return h[g]=w.generations,p[g]=w.llmOutput,(f=c==null?void 0:c[g])==null?void 0:f.handleLLMEnd({generations:[w.generations],llmOutput:w.llmOutput})}else return await((m=c==null?void 0:c[g])==null?void 0:m.handleLLMError(_.reason)),Promise.reject(_.reason)}));const y={generations:h,llmOutput:p.length?(v=this._combineLLMOutput)==null?void 0:v.call(this,...p):void 0};return Object.defineProperty(y,Qw,{value:c?{runIds:c==null?void 0:c.map(_=>_.runId)}:void 0,configurable:!0}),y}invocationParams(e){return{}}_modelType(){return"base_chat_model"}async generatePrompt(e,n,r){const i=e.map(s=>s.toChatMessages());return this.generate(i,n,r)}async call(e,n,r){return(await this.generate([e.map(Tu)],n,r)).generations[0][0].message}async callPrompt(e,n,r){const i=e.toChatMessages();return this.call(i,n,r)}async predictMessages(e,n,r){return this.call(e,n,r)}async predict(e,n,r){const i=new Fi(e);return(await this.call([i],n,r)).content}}function wg(t){let e;return t.constructor.name===ew.name?(e=new Error(t.message),e.name="TimeoutError"):t.constructor.name===tw.name?(e=new Error(t.message),e.name="AbortError"):e=t,e}function ik(t){return t.role!=="system"&&t.role!=="assistant"&&t.role!=="user"&&t.role!=="function"&&console.warn(`Unknown message role: ${t.role}`),t.role}function wl(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"generic":{if(!eg.isInstance(t))throw new Error("Invalid generic chat message");return ik(t)}default:throw new Error(`Unknown message type: ${e}`)}}function sk(t){switch(t.role){case"user":return new Fi(t.content||"");case"assistant":return new Xm(t.content||"",{function_call:t.function_call});case"system":return new Ym(t.content||"");default:return new eg(t.content||"",t.role??"unknown")}}function ak(t,e){const n=t.role??e,r=t.content??"";let i;return t.function_call?i={function_call:t.function_call}:i={},n==="user"?new ja({content:r}):n==="assistant"?new $a({content:r,additional_kwargs:i}):n==="system"?new Na({content:r}):n==="function"?new La({content:r,additional_kwargs:i,name:t.name}):new Da({content:r,role:n})}class bg extends bi{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","promptIndex"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,n){var r,i,s,a,o,l,u,c;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.openAIApiKey)??Y("OPENAI_API_KEY"),this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??Y("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??Y("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e==null?void 0:e.azureOpenAIApiDeploymentName)??Y("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??Y("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??Y("AZURE_OPENAI_BASE_PATH"),this.organization=((r=e==null?void 0:e.configuration)==null?void 0:r.organization)??Y("OPENAI_ORGANIZATION"),this.modelName=(e==null?void 0:e.modelName)??this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.maxTokens=e==null?void 0:e.maxTokens,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=e==null?void 0:e.stop,this.user=e==null?void 0:e.user,this.streaming=(e==null?void 0:e.streaming)??!1,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.openAIApiKey=this.openAIApiKey??""}this.clientConfig={apiKey:this.openAIApiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((i=e==null?void 0:e.configuration)==null?void 0:i.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((s=n==null?void 0:n.baseOptions)==null?void 0:s.headers)??((o=(a=e==null?void 0:e.configuration)==null?void 0:a.baseOptions)==null?void 0:o.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((c=(u=e==null?void 0:e.configuration)==null?void 0:u.baseOptions)==null?void 0:c.params),...n,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stop,user:this.user,stream:this.streaming,functions:(e==null?void 0:e.functions)??(e!=null&&e.tools?e==null?void 0:e.tools.map(nb):void 0),function_call:e==null?void 0:e.function_call,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,n,r){var l;const i=e.map(u=>({role:wl(u),content:u.content,name:u.name,function_call:u.additional_kwargs.function_call})),s={...this.invocationParams(n),messages:i,stream:!0};let a;const o=await this.completionWithRetry(s,n);for await(const u of o){const c=u==null?void 0:u.choices[0];if(!c)continue;const{delta:d}=c,h=ak(d,a);a=d.role??a;const p={prompt:n.promptIndex??0,completion:c.index??0},y=new Qc({message:h,text:h.content,generationInfo:p});yield y,r==null||r.handleLLMNewToken(y.text??"",p,void 0,void 0,void 0,{chunk:y})}if((l=n.signal)!=null&&l.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,n,r){var o,l;const i={},s=this.invocationParams(n),a=e.map(u=>({role:wl(u),content:u.content,name:u.name,function_call:u.additional_kwargs.function_call}));if(s.stream){const u=await this._streamResponseChunks(e,n,r),c={};for await(const h of u){const p=((o=h.generationInfo)==null?void 0:o.completion)??0;c[p]===void 0?c[p]=h:c[p]=c[p].concat(h)}return{generations:Object.entries(c).sort(([h],[p])=>parseInt(h,10)-parseInt(p,10)).map(([h,p])=>p)}}else{const u=await this.completionWithRetry({...s,stream:!1,messages:a},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}),{completion_tokens:c,prompt_tokens:d,total_tokens:h}=(u==null?void 0:u.usage)??{};c&&(i.completionTokens=(i.completionTokens??0)+c),d&&(i.promptTokens=(i.promptTokens??0)+d),h&&(i.totalTokens=(i.totalTokens??0)+h);const p=[];for(const y of(u==null?void 0:u.choices)??[]){const _={text:((l=y.message)==null?void 0:l.content)??"",message:sk(y.message??{role:"assistant"})};y.finish_reason&&(_.generationInfo={finish_reason:y.finish_reason}),p.push(_)}return{generations:p,llmOutput:{tokenUsage:i}}}}async getNumTokensFromMessages(e){let n=0,r=0,i=0;Pu(this.modelName)==="gpt-3.5-turbo"?(r=4,i=-1):Pu(this.modelName).startsWith("gpt-4")&&(r=3,i=1);const s=await Promise.all(e.map(async a=>{const o=await this.getNumTokens(a.content),l=await this.getNumTokens(wl(a)),u=a.name!==void 0?i+await this.getNumTokens(a.name):0,c=o+r+l+u;return n+=c,c}));return n+=3,{totalCount:n,countPerMessage:s}}async completionWithRetry(e,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,r)}catch(i){throw wg(i)}})}_getClientOptions(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},i=dg(r),s={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};s.baseURL||delete s.baseURL,this.client=new pe(s)}const n={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}}const ok=Object.freeze(Object.defineProperty({__proto__:null,ChatOpenAI:bg},Symbol.toStringTag,{value:"Module"}));class Zh{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent?e.pageContent.toString():this.pageContent,this.metadata=e.metadata??{}}}class lk extends ve{parseResultWithPrompt(e,n,r){return this.parseResult(e,r)}async invoke(e,n){return typeof e=="string"?this._callWithConfig(async r=>this.parseResult([{text:r}]),e,{...n,runType:"parser"}):this._callWithConfig(async r=>this.parseResult([{message:r,text:r.content}]),e,{...n,runType:"parser"})}}class uk extends lk{parseResult(e,n){return this.parse(e[0].text,n)}async parseWithPrompt(e,n,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class ck extends uk{async*_transform(e){for await(const n of e)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:n.content}])}async*transform(e,n){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...n,runType:"parser"})}}class Kh extends ck{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","output_parser"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"StrOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}function dk(t){return t.map(e=>e.pageContent).join(`

`)}async function hk(){const e=new URLSearchParams(window.location.search).get("idToken");console.log(e);const n={Authorization:e?`Bearer ${e}`:""},r=await fetch("https://otn6zi7itj.execute-api.us-east-2.amazonaws.com/Stage1/get-secrets",{method:"GET",headers:n});if(!r.ok)throw new Error("Network response was not ok");return await r.json()}class fk extends ve{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e==null?void 0:e.callbacks,this.tags=(e==null?void 0:e.tags)??[],this.metadata=(e==null?void 0:e.metadata)??{},this.verbose=(e==null?void 0:e.verbose)??!1}_getRelevantDocuments(e,n){throw new Error("Not implemented!")}async invoke(e,n){return this.getRelevantDocuments(e,n)}async getRelevantDocuments(e,n){const r=Ub(n),i=await qe.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),s=await(i==null?void 0:i.handleRetrieverStart(this.toJSON(),e));try{const a=await this._getRelevantDocuments(e,s);return await(s==null?void 0:s.handleRetrieverEnd(a)),a}catch(a){throw await(s==null?void 0:s.handleRetrieverError(a)),a}}}class bl extends fk{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain","retrievers","base"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,e.searchType==="mmr"&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,n){if(this.searchType==="mmr"){if(typeof this.vectorStore.maxMarginalRelevanceSearch!="function")throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},n==null?void 0:n.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,n==null?void 0:n.getChild("vectorstore"))}async addDocuments(e,n){return this.vectorStore.addDocuments(e,n)}}class pk extends bn{constructor(e,n){super(n),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,n=4,r=void 0,i=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),n,r)).map(a=>a[0])}async similaritySearchWithScore(e,n=4,r=void 0,i=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),n,r)}static fromTexts(e,n,r,i){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,n,r){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,n,r,i,s,a){if(typeof e=="number")return new bl({vectorStore:this,k:e,filter:n,tags:[...i??[],this._vectorstoreType()],metadata:s,verbose:a,callbacks:r});{const o={vectorStore:this,k:e==null?void 0:e.k,filter:e==null?void 0:e.filter,tags:[...(e==null?void 0:e.tags)??[],this._vectorstoreType()],metadata:e==null?void 0:e.metadata,verbose:e==null?void 0:e.verbose,callbacks:e==null?void 0:e.callbacks,searchType:e==null?void 0:e.searchType};return(e==null?void 0:e.searchType)==="mmr"?new bl({...o,searchKwargs:e.searchKwargs}):new bl({...o})}}}class rd extends pk{_vectorstoreType(){return"supabase"}constructor(e,n){super(e,n),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queryName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"upsertBatchSize",{enumerable:!0,configurable:!0,writable:!0,value:500}),this.client=n.client,this.tableName=n.tableName||"documents",this.queryName=n.queryName||"match_documents",this.filter=n.filter,this.upsertBatchSize=n.upsertBatchSize??this.upsertBatchSize}async addDocuments(e,n){const r=e.map(({pageContent:i})=>i);return this.addVectors(await this.embeddings.embedDocuments(r),e,n)}async addVectors(e,n,r){const i=e.map((a,o)=>({content:n[o].pageContent,embedding:a,metadata:n[o].metadata}));let s=[];for(let a=0;a<i.length;a+=this.upsertBatchSize){const o=i.slice(a,a+this.upsertBatchSize).map((u,c)=>r!=null&&r.ids?{id:r.ids[a+c],...u}:u),l=await this.client.from(this.tableName).upsert(o).select();if(l.error)throw new Error(`Error inserting: ${l.error.message} ${l.status} ${l.statusText}`);l.data&&(s=s.concat(l.data.map(u=>u.id)))}return s}async delete(e){const{ids:n}=e;for(const r of n)await this.client.from(this.tableName).delete().eq("id",r)}async similaritySearchVectorWithScore(e,n,r){if(r&&this.filter)throw new Error("cannot provide both `filter` and `this.filter`");const i=r??this.filter??{},s={query_embedding:e};let a;if(typeof i=="function")a=d=>i(d).limit(n);else if(typeof i=="object")s.filter=i,s.match_count=n,a=d=>d;else throw new Error("invalid filter type");const o=this.client.rpc(this.queryName,s),{data:l,error:u}=await a(o);if(u)throw new Error(`Error searching for documents: ${u.code} ${u.message} ${u.details}`);return l.map(d=>[new Zh({metadata:d.metadata,pageContent:d.content}),d.similarity])}static async fromTexts(e,n,r,i){const s=[];for(let a=0;a<e.length;a+=1){const o=Array.isArray(n)?n[a]:n,l=new Zh({pageContent:e[a],metadata:o});s.push(l)}return rd.fromDocuments(s,r,i)}static async fromDocuments(e,n,r){const i=new this(n,r);return await i.addDocuments(e),i}static async fromExistingIndex(e,n){return new this(e,n)}}const mk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ct(async()=>{const{default:r}=await Promise.resolve().then(()=>Fr);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class id extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class gk extends id{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class yk extends id{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class vk extends id{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Uu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Uu||(Uu={}));var _k=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};class wk{constructor(e,{headers:n={},customFetch:r,region:i=Uu.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=mk(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return _k(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=n;let o={},{region:l}=n;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:u}).catch(y=>{throw new gk(y)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new yk(c);if(!c.ok)throw new vk(c);let h=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield c.json():h==="application/octet-stream"?p=yield c.blob():h==="text/event-stream"?p=c:h==="multipart/form-data"?p=yield c.formData():p=yield c.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var et={},sd={},xo={},rs={},Po={},To={},bk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ur=bk();const kk=Ur.fetch,kg=Ur.fetch.bind(Ur),Sg=Ur.Headers,Sk=Ur.Request,Ek=Ur.Response,Fr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Sg,Request:Sk,Response:Ek,default:kg,fetch:kk},Symbol.toStringTag,{value:"Module"})),xk=Kg(Fr);var ad={};Object.defineProperty(ad,"__esModule",{value:!0});class Pk extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}ad.default=Pk;var Eg=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(To,"__esModule",{value:!0});const Tk=Eg(xk),Ak=Eg(ad);let Ck=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Tk.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let u=null,c=null,d=null,h=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const g=await s.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=g:c=JSON.parse(g))}const v=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),_=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");v&&_&&_.length>1&&(d=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,h=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const v=await s.text();try{u=JSON.parse(v),Array.isArray(u)&&s.status===404&&(c=[],u=null,h=200,p="OK")}catch{s.status===404&&v===""?(h=204,p="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,h=200,p="OK"),u&&this.shouldThrowOnError)throw new Ak.default(u)}return{error:u,data:c,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}};To.default=Ck;var Ok=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Po,"__esModule",{value:!0});const Ik=Ok(To);let Rk=class extends Ik.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Po.default=Rk;var jk=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rs,"__esModule",{value:!0});const $k=jk(Po);let Nk=class extends $k.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${a}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};rs.default=Nk;var Lk=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xo,"__esModule",{value:!0});const ei=Lk(rs);let Dk=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=n,this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let s=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new ei.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new ei.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new ei.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new ei.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ei.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};xo.default=Dk;var Ao={},Co={};Object.defineProperty(Co,"__esModule",{value:!0});Co.version=void 0;Co.version="0.0.0-automated";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.DEFAULT_HEADERS=void 0;const Uk=Co;Ao.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Uk.version}`};var xg=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(sd,"__esModule",{value:!0});const zk=xg(xo),Mk=xg(rs),Bk=Ao;let Fk=class Pg{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Bk.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new zk.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Pg(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;r||i?(a=r?"HEAD":"GET",Object.entries(n).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{o.searchParams.append(c,d)})):(a="POST",l=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new Mk.default({method:a,url:o,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};sd.default=Fk;var is=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(et,"__esModule",{value:!0});et.PostgrestBuilder=et.PostgrestTransformBuilder=et.PostgrestFilterBuilder=et.PostgrestQueryBuilder=et.PostgrestClient=void 0;const Tg=is(sd);et.PostgrestClient=Tg.default;const Ag=is(xo);et.PostgrestQueryBuilder=Ag.default;const Cg=is(rs);et.PostgrestFilterBuilder=Cg.default;const Og=is(Po);et.PostgrestTransformBuilder=Og.default;const Ig=is(To);et.PostgrestBuilder=Ig.default;var Vk=et.default={PostgrestClient:Tg.default,PostgrestQueryBuilder:Ag.default,PostgrestFilterBuilder:Cg.default,PostgrestTransformBuilder:Og.default,PostgrestBuilder:Ig.default};const{PostgrestClient:Hk,PostgrestQueryBuilder:ZE,PostgrestFilterBuilder:KE,PostgrestTransformBuilder:WE,PostgrestBuilder:GE}=Vk,qk="2.10.2",Zk={"X-Client-Info":`realtime-js/${qk}`},Kk="1.0.0",Rg=1e4,Wk=1e3;var Pr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Pr||(Pr={}));var Be;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Be||(Be={}));var yt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(yt||(yt={}));var zu;(function(t){t.websocket="websocket"})(zu||(zu={}));var Ln;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ln||(Ln={}));class Gk{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),s=n.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+i));a=a+i;const l=r.decode(e.slice(a,a+s));a=a+s;const u=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class jg{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var K;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(K||(K={}));const Wh=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,a)=>(s[a]=Jk(a,t,e,i),s),{})},Jk=(t,e,n,r)=>{const i=e.find(o=>o.name===t),s=i==null?void 0:i.type,a=n[t];return s&&!r.includes(s)?$g(s,a):Mu(a)},$g=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return eS(e,n)}switch(t){case K.bool:return Qk(e);case K.float4:case K.float8:case K.int2:case K.int4:case K.int8:case K.numeric:case K.oid:return Xk(e);case K.json:case K.jsonb:return Yk(e);case K.timestamp:return tS(e);case K.abstime:case K.date:case K.daterange:case K.int4range:case K.int8range:case K.money:case K.reltime:case K.text:case K.time:case K.timestamptz:case K.timetz:case K.tsrange:case K.tstzrange:return Mu(e);default:return Mu(e)}},Mu=t=>t,Qk=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Xk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Yk=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},eS=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const a=t.slice(1,n);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>$g(e,o))}return t},tS=t=>typeof t=="string"?t.replace(" ","T"):t,Ng=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class kl{constructor(e,n,r={},i=Rg){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Gh;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Gh||(Gh={}));class ki{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ki.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=ki.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ki.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const s=this.cloneDeep(e),a=this.transformState(n),o={},l={};return this.map(s,(u,c)=>{a[u]||(l[u]=c)}),this.map(a,(u,c)=>{const d=s[u];if(d){const h=c.map(_=>_.presence_ref),p=d.map(_=>_.presence_ref),y=c.filter(_=>p.indexOf(_.presence_ref)<0),v=d.filter(_=>h.indexOf(_.presence_ref)<0);y.length>0&&(o[u]=y),v.length>0&&(l[u]=v)}else o[u]=c}),this.syncDiff(s,{joins:o,leaves:l},r,i)}static syncDiff(e,n,r,i){const{joins:s,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var u;const c=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),c.length>0){const d=e[o].map(p=>p.presence_ref),h=c.filter(p=>d.indexOf(p.presence_ref)<0);e[o].unshift(...h)}r(o,c,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const c=l.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[o]=u,i(o,u,l),u.length===0&&delete e[o]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jh;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Jh||(Jh={}));var Qh;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes"})(Qh||(Qh={}));var Xh;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Xh||(Xh={}));class od{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Be.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new kl(this,yt.join,this.params,this.timeout),this.rejoinTimer=new jg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Be.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Be.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this._on(yt.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new ki(this),this.broadcastEndpointURL=Ng(this.socket.endPoint)+"/api/broadcast"}subscribe(e,n=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const l={},u={broadcast:s,presence:a,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:c})=>{var d;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,p=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,y=[];for(let v=0;v<p;v++){const _=h[v],{filter:{event:g,schema:f,table:m,filter:w}}=_,E=c&&c[v];if(E&&E.event===g&&E.schema===f&&E.table===m&&E.filter===w)y.push(Object.assign(Object.assign({},_),{id:E.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=l.body)===null||i===void 0?void 0:i.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Be.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(yt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new kl(this,yt.leave,{},e);i.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),a}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new kl(this,e,n,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:c}=yt;if(r&&[o,l,u,c].indexOf(a)>=0&&r!==this._joinRef())return;let h=this._onMessage(a,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var y,v,_;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((_=(v=p.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(p=>p.callback(h,r)):(s=this.bindings[a])===null||s===void 0||s.filter(p=>{var y,v,_,g,f,m;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const w=p.id,E=(y=p.filter)===null||y===void 0?void 0:y.event;return w&&((v=n.ids)===null||v===void 0?void 0:v.includes(w))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((_=n.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const w=(f=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return w==="*"||w===((m=n==null?void 0:n.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:v,table:_,commit_timestamp:g,type:f,errors:m}=y;h=Object.assign(Object.assign({},{schema:v,table:_,commit_timestamp:g,eventType:f,new:{},old:{},errors:m}),this._getPayloadRecords(y))}p.callback(h,r)})}_isClosed(){return this.state===Be.closed}_isJoined(){return this.state===Be.joined}_isJoining(){return this.state===Be.joining}_isLeaving(){return this.state===Be.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&od.isEqual(i.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(yt.close,{},e)}_onError(e){this._on(yt.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Be.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Wh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Wh(e.columns,e.old_record)),n}}const nS=()=>{},rS=typeof WebSocket<"u";class iS{constructor(e,n){var r;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Zk,this.params={},this.timeout=Rg,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=nS,this.conn=null,this.sendBuffer=[],this.serializer=new Gk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>Ct(async()=>{const{default:l}=await Promise.resolve().then(()=>Fr);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${zu.websocket}`,this.httpEndpoint=Ng(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const i=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;i&&(this.accessToken=i,this.apiKey=i),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,a)=>a(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new jg(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(rS){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new sS(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ct(async()=>{const{default:e}=await import("./browser-CvV7OTYY.js").then(n=>n.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Pr.connecting:return Ln.Connecting;case Pr.open:return Ln.Open;case Pr.closing:return Ln.Closing;default:return Ln.Closed}}isConnected(){return this.connectionState()===Ln.Open}channel(e,n={config:{}}){const r=new od(`realtime:${e}`,n,this);return this.channels.push(r),r}push(e){const{topic:n,event:r,payload:i,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(yt.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Kk}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:i,payload:s,ref:a}=n;(a&&a===this.pendingHeartbeatRef||i===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(yt.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Wk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class sS{constructor(e,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Pr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class ld extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Se(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class aS extends ld{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Yh extends ld{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var oS=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const Lg=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ct(async()=>{const{default:r}=await Promise.resolve().then(()=>Fr);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},lS=()=>oS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ct(()=>Promise.resolve().then(()=>Fr),void 0)).Response:Response});var Vr=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const Sl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),uS=(t,e)=>Vr(void 0,void 0,void 0,function*(){const n=yield lS();t instanceof n?t.json().then(r=>{e(new aS(Sl(r),t.status||500))}).catch(r=>{e(new Yh(Sl(r),r))}):e(new Yh(Sl(t),t))}),cS=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};function Oo(t,e,n,r,i,s){return Vr(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(n,cS(e,r,i,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>uS(l,o))})})}function Bu(t,e,n,r){return Vr(this,void 0,void 0,function*(){return Oo(t,"GET",e,n,r)})}function nn(t,e,n,r,i){return Vr(this,void 0,void 0,function*(){return Oo(t,"POST",e,r,i,n)})}function dS(t,e,n,r,i){return Vr(this,void 0,void 0,function*(){return Oo(t,"PUT",e,r,i,n)})}function Dg(t,e,n,r,i){return Vr(this,void 0,void 0,function*(){return Oo(t,"DELETE",e,r,i,n)})}var Je=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const hS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ef={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class fS{constructor(e,n={},r,i){this.url=e,this.headers=n,this.bucketId=r,this.fetch=Lg(i)}uploadOrUpdate(e,n,r,i){return Je(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},ef),i),o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",a.cacheControl)):(s=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType);const l=this._removeEmptyFolders(n),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),d=yield c.json();return c.ok?{data:{path:l,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(s){if(Se(s))return{data:null,error:s};throw s}})}upload(e,n,r){return Je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return Je(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",n);try{let l;const u=Object.assign({upsert:ef.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:c}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(Se(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return Je(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const s=yield nn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new ld("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}update(e,n,r){return Je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Je(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Se(i))return{data:null,error:i};throw i}})}copy(e,n,r){return Je(this,void 0,void 0,function*(){try{return{data:{path:(yield nn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Se(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return Je(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield nn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(Se(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return Je(this,void 0,void 0,function*(){try{const i=yield nn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(Se(i))return{data:null,error:i};throw i}})}download(e,n){return Je(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Bu(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Se(o))return{data:null,error:o};throw o}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&i.push(s);const o=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}remove(e){return Je(this,void 0,void 0,function*(){try{return{data:yield Dg(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}list(e,n,r){return Je(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},hS),n),{prefix:e||""});return{data:yield nn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(Se(i))return{data:null,error:i};throw i}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const pS="2.6.0",mS={"X-Client-Info":`storage-js/${pS}`};var nr=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};class gS{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},mS),n),this.fetch=Lg(r)}listBuckets(){return nr(this,void 0,void 0,function*(){try{return{data:yield Bu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Se(e))return{data:null,error:e};throw e}})}getBucket(e){return nr(this,void 0,void 0,function*(){try{return{data:yield Bu(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return nr(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return nr(this,void 0,void 0,function*(){try{return{data:yield dS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}emptyBucket(e){return nr(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}deleteBucket(e){return nr(this,void 0,void 0,function*(){try{return{data:yield Dg(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}}class yS extends gS{constructor(e,n={},r){super(e,n,r)}from(e){return new fS(this.url,this.headers,e,this.fetch)}}const vS="2.36.0";let ui="";typeof Deno<"u"?ui="deno":typeof document<"u"?ui="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ui="react-native":ui="node";const _S={"X-Client-Info":`supabase-js-${ui}/${vS}`};var wS=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const bS=t=>{let e;return t?e=t:typeof fetch>"u"?e=kg:e=fetch,(...n)=>e(...n)},kS=()=>typeof Headers>"u"?Sg:Headers,SS=(t,e,n)=>{const r=bS(n),i=kS();return(s,a)=>wS(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:t;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},a),{headers:u}))})};function ES(t){return t.replace(/\/$/,"")}function xS(t,e){const{db:n,auth:r,realtime:i,global:s}=t,{db:a,auth:o,realtime:l,global:u}=e;return{db:Object.assign(Object.assign({},a),n),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},u),s)}}const Ug="2.64.4",PS="http://localhost:9999",TS="supabase.auth.token",AS={"X-Client-Info":`gotrue-js/${Ug}`},tf=10,Fu="X-Supabase-Api-Version",zg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function CS(t){return Math.round(Date.now()/1e3)+t}function OS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const pt=()=>typeof document<"u",Cn={tested:!1,writable:!1},Si=()=>{if(!pt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Cn.tested)return Cn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Cn.tested=!0,Cn.writable=!0}catch{Cn.tested=!0,Cn.writable=!1}return Cn.writable};function El(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const Mg=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ct(async()=>{const{default:r}=await Promise.resolve().then(()=>Fr);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},IS=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Bg=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Cs=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},xl=async(t,e)=>{await t.removeItem(e)};function RS(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",r,i,s,a,o,l,u,c=0;for(t=t.replace("-","+").replace("_","/");c<t.length;)a=e.indexOf(t.charAt(c++)),o=e.indexOf(t.charAt(c++)),l=e.indexOf(t.charAt(c++)),u=e.indexOf(t.charAt(c++)),r=a<<2|o>>4,i=(o&15)<<4|l>>2,s=(l&3)<<6|u,n=n+String.fromCharCode(r),l!=64&&i!=0&&(n=n+String.fromCharCode(i)),u!=64&&s!=0&&(n=n+String.fromCharCode(s));return n}class Io{constructor(){this.promise=new Io.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Io.promiseConstructor=Promise;function nf(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=t.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=n[1];return JSON.parse(RS(r))}async function jS(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function $S(t,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await t(s);if(!e(s,null,a)){r(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function NS(t){return("0"+t.toString(16)).substr(-2)}function LS(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,NS).join("")}async function DS(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}function US(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function zS(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await DS(t);return US(n)}async function rr(t,e,n=!1){const r=LS();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await Bg(t,`${e}-code-verifier`,i);const s=await zS(r);return[s,r===s?"plain":"s256"]}const MS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function BS(t){const e=t.headers.get(Fu);if(!e||!e.match(MS))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class ud extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function D(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class FS extends ud{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function VS(t){return D(t)&&t.name==="AuthApiError"}class Fg extends ud{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Yn extends ud{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class On extends Yn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Pl extends Yn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Os extends Yn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Is extends Yn{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rf extends Yn{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vu extends Yn{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Tl(t){return D(t)&&t.name==="AuthRetryableFetchError"}class sf extends Yn{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}var HS=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const jn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),qS=[502,503,504];async function af(t){var e;if(!IS(t))throw new Vu(jn(t),0);if(qS.includes(t.status))throw new Vu(jn(t),t.status);let n;try{n=await t.json()}catch(s){throw new Fg(jn(s),s)}let r;const i=BS(t);if(i&&i.getTime()>=zg["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new sf(jn(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new sf(jn(n),t.status,n.weak_password.reasons);throw new FS(jn(n),t.status||500,r)}const ZS=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function B(t,e,n,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[Fu]||(s[Fu]=zg["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const a=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await KS(t,e,n+o,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function KS(t,e,n,r,i,s){const a=ZS(e,r,i,s);let o;try{o=await t(n,Object.assign({},a))}catch(l){throw console.error(l),new Vu(jn(l),0)}if(o.ok||await af(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await af(l)}}function Yt(t){var e;let n=null;QS(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=CS(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function of(t){const e=Yt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function an(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function WS(t){return{data:t,error:null}}function GS(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=t,a=HS(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function JS(t){return t}function QS(t){return t.access_token&&t.refresh_token&&t.expires_in}var XS=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class YS{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=Mg(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await B(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await B(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:an})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=XS(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await B(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:GS,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(D(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await B(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:an})}catch(n){if(D(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await B(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:JS});if(c.error)throw c.error;const d=await c.json(),h=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(y.split(";")[1].split("=")[1]);u[`${_}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(D(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await B(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:an})}catch(n){if(D(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await B(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:an})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){try{return await B(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:an})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:n,error:r}=await B(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(D(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await B(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}}}const eE={getItem:t=>Si()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Si()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Si()&&globalThis.localStorage.removeItem(t)}};function lf(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function tE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ir={debug:!!(globalThis&&Si()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Vg extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class nE extends Vg{}async function rE(t,e,n){ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ir.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new nE(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ir.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}tE();const iE={url:PS,storageKey:TS,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:AS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},ti=30*1e3,uf=3;async function cf(t,e,n){return await n()}class Zi{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Zi.nextInstanceID,Zi.nextInstanceID+=1,this.instanceID>0&&pt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},iE),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new YS({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Mg(i.fetch),this.lock=i.lock||cf,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:pt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=rE:this.lock=cf,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Si()?this.storage=eE:(this.memoryStorage={},this.storage=lf(this.memoryStorage)):(this.memoryStorage={},this.storage=lf(this.memoryStorage)),pt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ug}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=pt()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:r}=await this._getSessionFromURL(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),(r==null?void 0:r.message)==="Identity is already linked"||(r==null?void 0:r.message)==="Identity is already linked to another user"?{error:r}:(await this._removeSession(),{error:r});const{session:i,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",s),await this._saveSession(i),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return D(e)?{error:e}:{error:new Fg("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const s=await B(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Yt}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(D(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,i;try{let s;if("email"in e){const{email:c,password:d,options:h}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await rr(this.storage,this.storageKey)),s=await B(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:y},xform:Yt})}else if("phone"in e){const{phone:c,password:d,options:h}=e;s=await B(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Yt})}else throw new Os("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(D(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:a,options:o}=e;n=await B(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:of})}else if("phone"in e){const{phone:s,password:a,options:o}=e;n=await B(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:of})}else throw new Os("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Pl}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(D(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await Cs(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/"),{data:s,error:a}=await B(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Yt});return await xl(this.storage,`${this.storageKey}-code-verifier`),a?{data:{user:null,session:null,redirectType:null},error:a}:!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Pl}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:s,nonce:a}=e,o=await B(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Yt}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Pl}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(n){if(D(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,s,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await rr(this.storage,this.storageKey));const{error:d}=await B(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:c}=await B(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Os("You must provide either an email or phone number.")}catch(o){if(D(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var n,r;try{let i,s;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await B(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Yt});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(D(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await rr(this.storage,this.storageKey)),await B(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:WS})}catch(s){if(D(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new On;const{error:i}=await B(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(D(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:a}=await B(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:a,error:o}=await B(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Os("You must provide either an email or phone number and a type")}catch(n){if(D(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Cs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await B(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:an}):await this._useSession(async n=>{var r,i,s;const{data:a,error:o}=n;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new On}:await B(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:an})})}catch(n){if(D(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new On;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await rr(this.storage,this.storageKey));const{data:u,error:c}=await B(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:an});if(c)throw c;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(D(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return nf(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new On;const n=Date.now()/1e3;let r=n,i=!0,s=null;const a=nf(e.access_token);if(a.exp&&(r=a.exp,i=r<=n),i){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(D(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:a,error:o}=n;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new On;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(D(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!pt())throw new Is("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Is("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new rf("Not a valid PKCE flow url.");const n=El(window.location.href);if(e){if(!n.code)throw new rf("No code detected.");const{data:f,error:m}=await this._exchangeCodeForSession(n.code);if(m)throw m;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:f.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new Is(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=n;if(!s||!o||!a||!u)throw new Is("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(o);let h=c+d;l&&(h=parseInt(l));const p=h-c;p*1e3<=ti&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const y=h-d;c-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,c):c-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",y,h,c);const{data:v,error:_}=await this._getUser(s);if(_)throw _;const g={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:h,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:n.type},error:null}}catch(n){if(D(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=El(window.location.href);return!!(pt()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=El(window.location.href),n=await Cs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{error:s};const a=(r=i.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(VS(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await xl(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=OS(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await rr(this.storage,this.storageKey,!0));try{return await B(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(D(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var a,o,l,u,c;const{data:d,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await B(this.fetch,"GET",p,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return pt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(D(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)throw a;return await B(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(D(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await $S(async i=>(i>0&&await jS(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await B(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Yt})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Tl(s)&&Date.now()+a-r<ti})}catch(r){if(this._debug(n,"error",r),D(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),pt()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Cs(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const i=Math.round(Date.now()/1e3),s=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<i+tf;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${tf}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),Tl(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new On;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Io;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new On;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),D(s)){const a={session:null,error:s};return Tl(s)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,n)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Bg(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await xl(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&pt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ti);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/ti);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ti}ms, refresh threshold is ${uf} ticks`),i<=uf&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Vg)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,a]=await rr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await B(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(D(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)return{data:null,error:a};const{data:o,error:l}=await B(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(!((i=o==null?void 0:o.totp)===null||i===void 0)&&i.qr_code&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(n){if(D(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{data:null,error:s};const{data:a,error:o}=await B(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(n){if(D(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await B(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(D(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:r,totp:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}}Zi.nextInstanceID=0;class sE extends Zi{constructor(e){super(e)}}var aE=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const oE={headers:_S},lE={schema:"public"},uE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},cE={};class dE{constructor(e,n,r){var i,s,a,o,l,u,c,d;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const h=ES(e);this.realtimeUrl=`${h}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${h}/auth/v1`,this.storageUrl=`${h}/storage/v1`,this.functionsUrl=`${h}/functions/v1`;const p=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,y={db:lE,realtime:cE,auth:Object.assign(Object.assign({},uE),{storageKey:p}),global:oE},v=xS(r??{},y);this.storageKey=(s=(i=v.auth)===null||i===void 0?void 0:i.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=(a=v.global)===null||a===void 0?void 0:a.headers)!==null&&o!==void 0?o:{},this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,(u=v.global)===null||u===void 0?void 0:u.fetch),this.fetch=SS(n,this._getAccessToken.bind(this),(c=v.global)===null||c===void 0?void 0:c.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},v.realtime)),this.rest=new Hk(`${h}/rest/v1`,{headers:this.headers,schema:(d=v.db)===null||d===void 0?void 0:d.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new wk(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new yS(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return aE(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,storageKey:s,flowType:a,debug:o},l,u){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sE({url:this.authUrl,headers:Object.assign(Object.assign({},c),l),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,flowType:a,debug:o,fetch:u})}_initRealtimeClient(e){return new iS(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const hE=(t,e,n)=>new dE(t,e,n),fE=(t,e)=>t.reduce((n,r,i)=>{const s=Math.floor(i/e),a=n[s]||[];return n[s]=a.concat([r]),n},[]);class pE{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new ko(e??{})}}class mE extends pE{constructor(e,n){var u,c;const r={maxConcurrency:2,...e};super(r),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let i=(r==null?void 0:r.openAIApiKey)??Y("OPENAI_API_KEY");const s=(r==null?void 0:r.azureOpenAIApiKey)??Y("AZURE_OPENAI_API_KEY");if(!s&&!i)throw new Error("OpenAI or Azure OpenAI API key not found");const a=(r==null?void 0:r.azureOpenAIApiInstanceName)??Y("AZURE_OPENAI_API_INSTANCE_NAME"),o=((r==null?void 0:r.azureOpenAIApiEmbeddingsDeploymentName)||(r==null?void 0:r.azureOpenAIApiDeploymentName))??(Y("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||Y("AZURE_OPENAI_API_DEPLOYMENT_NAME")),l=(r==null?void 0:r.azureOpenAIApiVersion)??Y("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=(r==null?void 0:r.azureOpenAIBasePath)??Y("AZURE_OPENAI_BASE_PATH"),this.modelName=(r==null?void 0:r.modelName)??this.modelName,this.batchSize=(r==null?void 0:r.batchSize)??(s?1:this.batchSize),this.stripNewLines=(r==null?void 0:r.stripNewLines)??this.stripNewLines,this.timeout=r==null?void 0:r.timeout,this.azureOpenAIApiVersion=l,this.azureOpenAIApiKey=s,this.azureOpenAIApiInstanceName=a,this.azureOpenAIApiDeploymentName=o,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");i=i??""}this.clientConfig={apiKey:i,baseURL:n==null?void 0:n.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:(u=n==null?void 0:n.baseOptions)==null?void 0:u.headers,defaultQuery:(c=n==null?void 0:n.baseOptions)==null?void 0:c.params,...n}}async embedDocuments(e){const n=fE(this.stripNewLines?e.map(a=>a.replace(/\n/g," ")):e,this.batchSize),r=n.map(a=>this.embeddingWithRetry({model:this.modelName,input:a})),i=await Promise.all(r),s=[];for(let a=0;a<i.length;a+=1){const o=n[a],{data:l}=i[a];for(let u=0;u<o.length;u+=1)s.push(l[u].embedding)}return s}async embedQuery(e){const{data:n}=await this.embeddingWithRetry({model:this.modelName,input:this.stripNewLines?e.replace(/\n/g," "):e});return n[0].embedding}async embeddingWithRetry(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},i=dg(r),s={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};s.baseURL||delete s.baseURL,this.client=new pe(s)}const n={};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,n)}catch(r){throw wg(r)}})}}let Rs,Al,Cl,df;hk().then(t=>{const e=JSON.parse(t.body);console.log(e),Rs=e.REACT_APP_OPENAI_API_KEY,Al=e.REACT_APP_SUPABASE_URL_LC_CHATBOT,Cl=e.REACT_APP_SUPABASE_API_KEY,console.log(Rs),console.log(Al),console.log(Cl);const n=hE(Al,Cl),r=new mE({openAIApiKey:Rs}),s=new rd(r,{client:n,tableName:"documents",queryName:"match_documents"}).asRetriever();document.addEventListener("submit",f=>{f.preventDefault(),df()});const a=new bg({openAIApiKey:Rs}),l=cn.fromTemplate(`Given some conversation history (if any) and a question, convert the question to a standalone question. 
conversation history: {conv_history}
question: {question} 
standalone question:`),c=cn.fromTemplate(`You are a helpful and enthusiastic support bot who can answer a given question about ecofind based on the context provided and the conversation history. Try to find the answer in the context. If the answer is not given in the context, find the answer in the conversation history if possible. If you really don't know the answer, say "I'm sorry, I don't know the answer to that." And direct the questioner to email help@ecofind.com. Don't try to make up an answer. Always speak as if you were chatting to a friend.
context: {context}
conversation history: {conv_history}
question: {question}
answer: `),d=l.pipe(a).pipe(new Kh),h=un.from([f=>f.standalone_question,s,dk]),p=c.pipe(a).pipe(new Kh),y=un.from([{standalone_question:d,original_input:new Kb},{context:h,question:({original_input:f})=>f.question,conv_history:({original_input:f})=>f.conv_history},p]),v=[];df=async function(){const f=document.getElementById("user-input"),m=document.getElementById("chatbot-conversation-container"),w=f.value;f.value="";const E=document.createElement("div");E.classList.add("speech","speech-human"),m.appendChild(E),E.textContent=w,m.scrollTop=m.scrollHeight;const O=await y.invoke({question:w,conv_history:g_(v)});v.push(w),v.push(O);const C=document.createElement("div");C.classList.add("speech","speech-ai"),m.appendChild(C),C.textContent=O,m.scrollTop=m.scrollHeight};const _=document.getElementById("root");Ol.createRoot(_).render(ft.createElement(m_,null))});export{Gb as B,cn as P,Yb as c,eo as g,_g as r};
